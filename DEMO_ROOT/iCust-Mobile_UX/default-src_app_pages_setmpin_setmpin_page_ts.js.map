{"version":3,"file":"default-src_app_pages_setmpin_setmpin_page_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAA2C;AACO;AAC+B;AACtB;AACV;AACS;AACY;IAOzD,WAAW,SAAX,WAAW;IAqBtB,YAAoB,MAAc,EAAU,QAAkB,EAAU,GAAe,EAAU,EAAe,EACvG,SAA0B,EAAU,MAAoB;QAD7C,WAAM,GAAN,MAAM,CAAQ;QAAU,aAAQ,GAAR,QAAQ,CAAU;QAAU,QAAG,GAAH,GAAG,CAAY;QAAU,OAAE,GAAF,EAAE,CAAa;QACvG,cAAS,GAAT,SAAS,CAAiB;QAAU,WAAM,GAAN,MAAM,CAAc;QArBjE,cAAS,GAAY,KAAK,CAAC;QAE3B,YAAO,GAAG,IAAI,uDAAW,EAAE,CAAC;QAE5B,SAAI,GAAG,IAAI,uDAAW,EAAE,CAAC;QACzB,YAAO,GAAC,IAAI,WAAW,EAAE,CAAC;QAE1B,WAAM,GAAG;YACP,gBAAgB,EAAE,IAAI;YACtB,MAAM,EAAE,CAAC;YACT,eAAe,EAAE,KAAK;YACtB,gBAAgB,EAAE,KAAK;YACvB,WAAW,EAAE,EAAE;YACf,WAAW,EAAE;gBACX,OAAO,EAAE,MAAM;gBACf,QAAQ,EAAE,MAAM;aACjB;SACF;IAIoE,CAAC;IAEtE,QAAQ;QACN,IAAI,CAAC,gBAAgB,GAAG,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;QACjE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;YAC5B,WAAW,EAAE,CAAC,EAAE,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACxC,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC,+DAAmB,CAAC,CAAC;YACjC,QAAQ,EAAE,CAAC,EAAE,EAAE,CAAC,+DAAmB,CAAC,CAAC;SACtC,CAAC,CAAC;IACL,CAAC;IACD,IAAI;QACF,gDAAgD;QAChD,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACvB,CAAC;IACD,UAAU;QACR,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;IAC3C,CAAC;IACK,SAAS,CAAC,OAAO;;YACrB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBACxC,OAAO,EAAE,GAAG,OAAO,EAAE;gBACrB,QAAQ,EAAE,IAAI;gBACd,QAAQ,EAAE,QAAQ;aACnB,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAEK,YAAY,CAAC,GAAG;;YACpB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnG,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;gBACnC,OAAO;aACR;YACD,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAC1C,IAAI,CAAC,SAAS,CAAC,oCAAoC,CAAC,CAAC;gBACrD,OAAO;aACR;YAED,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;YAEjD,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC;YACjD,IAAI,CAAC,OAAO,CAAC,IAAI,GAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;YAClC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAEjC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YACjB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAChC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAE7B,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAC1C,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,CAAC;gBACrC,OAAO;aACR;YAED,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;gBACvD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAClB,IAAI,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,IAAI,CAAC;gBAClB,IAAI,IAAI,IAAI,IAAI,EAAE;oBAChB,IAAI,CAAC,SAAS,CAAC,0CAA0C,CAAC,CAAC;oBAC3D,yCAAyC;oBACzC,qEAAqE;oBACrE,IAAI;iBACL;qBAAM;oBACL,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;iBAC3C;YACH,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE;gBACT,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,CAAC,KAAK,CAAC;gBACjC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YAC5C,CAAC,CAAC;QACJ,CAAC;KAAA;IAEO,YAAY,CAAC,OAAe,EAAE,QAAgB;QACpD,IAAI,CAAC,GAAG;aACP,YAAY,CAAC,OAAO,CAAC;aACrB,SAAS,CACR,CAAC,IAAI,EAAE,EAAE;YACP,OAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACjD,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;gBACnB,YAAY,CAAC,OAAO,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;gBAC3C,MAAM,gBAAgB,GAAqB;oBACzC,WAAW,EAAE;wBACX,eAAe,EAAE,eAAe;wBAChC,mBAAmB,EAAC,yCAAyC;wBAC7D,YAAY,EAAC,SAAS;qBACvB;iBACF,CAAC;gBACF,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAC;gBACxC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC;gBAC9C,6CAA6C;aAE9C;QACH,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;YACR,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;YAChC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACzB,CAAC,CACF,CAAC;IACJ,CAAC;;;;;;;;;;AArHU,WAAW;IALvB,wDAAS,CAAC;QACT,QAAQ,EAAE,aAAa;QACvB,oEAAkC;;KAEnC,CAAC;GACW,WAAW;AAAA;AAwHjB,MAAM,WAAW","sources":["./src/app/pages/setmpin/setmpin.page.ts"],"sourcesContent":["import { Location } from '@angular/common';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { NavigationExtras, Router } from '@angular/router';\r\nimport { ToastController } from '@ionic/angular';\r\nimport { ApiService } from 'src/app/services/api.service';\r\nimport { DeviceAccess } from 'src/app/services/device-access.service';\r\n\r\n@Component({\r\n  selector: 'app-setmpin',\r\n  templateUrl: './setmpin.page.html',\r\n  styleUrls: ['./setmpin.page.scss'],\r\n})\r\nexport class SetmpinPage implements OnInit {\r\n  isLoading: boolean = false;\r\n  customerPhonenum: string;\r\n  newMpin = new FormControl();\r\n  mpinForm: FormGroup;\r\n  mpin = new FormControl();\r\n  mpinobj=new mpinObjects();\r\n\r\n  config = {\r\n    allowNumbersOnly: true,\r\n    length: 4,\r\n    isPasswordInput: false,\r\n    disableAutoFocus: false,\r\n    placeholder: '',\r\n    inputStyles: {\r\n      'width': '40px',\r\n      'height': '40px'\r\n    }\r\n  }\r\n\r\n\r\n  constructor(private router: Router, private location: Location, private api: ApiService, private fb: FormBuilder,\r\n    public toastCtrl: ToastController, private device: DeviceAccess) { }\r\n\r\n  ngOnInit() {\r\n    this.customerPhonenum = localStorage.getItem('customerPhonenum');\r\n    this.mpinForm = this.fb.group({\r\n      phoneNumber: ['', [Validators.required]],\r\n      mpin: ['', [Validators.required]],\r\n      deviceId: ['', [Validators.required]],\r\n    });\r\n  }\r\n  back() {\r\n    // this.router.navigateByUrl('/securitycenter');\r\n    this.location.back();\r\n  }\r\n  forgotmpin() {\r\n    this.router.navigateByUrl('/forgotmpin');\r\n  }\r\n  async openToast(message) {\r\n    const toast = await this.toastCtrl.create({\r\n      message: `${message}`,\r\n      duration: 2500,\r\n      position: 'bottom',\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  async generateMpin(val) {\r\n    if (!this.newMpin.value || this.newMpin.value < 4 || !this.mpin.value || this.mpin.value.length < 4) {\r\n      this.openToast('Enter valid mPin');\r\n      return;\r\n    }\r\n    if (this.newMpin.value !== this.mpin.value) {\r\n      this.openToast('New and current mPin did not match');\r\n      return;\r\n    }\r\n\r\n    const deviceId = await this.device.getDeviceId();\r\n    \r\n    this.mpinobj.phoneNumber = this.customerPhonenum;\r\n    this.mpinobj.mpin=this.mpin.value;\r\n    this.mpinobj.deviceId = deviceId;\r\n    \r\n    console.log(val);\r\n    console.log(this.newMpin.value);\r\n    console.log(this.mpin.value);\r\n    \r\n    if (this.newMpin.value !== this.mpin.value) {\r\n      this.openToast('mPin did not match');\r\n      return;\r\n    }\r\n    \r\n    this.api.authenticateMpin(this.mpinobj).subscribe(resp => {\r\n      console.log(resp);\r\n      resp = resp?.body;\r\n      if (resp != null) {\r\n        this.openToast('Current mPin can not be same as previous');\r\n        // if (resp?.custStatus !== 'APPROVED') {\r\n        //   this.openToast('Customer Id or Account Status is not approved');\r\n        // }\r\n      } else {\r\n        this.validateMpin(this.mpinobj, deviceId);\r\n      }\r\n    }, (err) => {\r\n      console.log('Error: ', err.error)\r\n      this.validateMpin(this.mpinobj, deviceId);\r\n    })\r\n  }\r\n\r\n  private validateMpin(mpinobj: object, deviceId: string) {\r\n    this.api\r\n    .validateMpin(mpinobj)\r\n    .subscribe(\r\n      (data) => {\r\n        console.log('validate password-- ', data.status);\r\n        if (data.mpin) {\r\n          console.log(\"data\")\r\n          localStorage.setItem('deviceId', deviceId);\r\n          const navigationExtras: NavigationExtras = {\r\n            queryParams: {\r\n              'screenDetails': 'mPIN Changed!',\r\n              'screenDescription':'Your mPIN has been changed successfully',\r\n              'screenName':'setmpin'\r\n            },\r\n          };\r\n          this.api.sendNavParam(navigationExtras);\r\n          this.router.navigateByUrl('/success-message');\r\n          // this.router.navigate(['success-message']);\r\n         \r\n        } \r\n      },\r\n      (error) => {\r\n        console.log('Error :: ', error);\r\n        this.isLoading = false;\r\n      }\r\n    );\r\n  }\r\n\r\n}\r\nexport class mpinObjects {\r\n  phoneNumber: any;\r\n  mpin:any;\r\n  deviceId:any;\r\n}"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}