!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[242],{17988:function(t,e,n){n.d(e,{G:function(){return i},T:function(){return a}});var o=n(37716),i=function(){function t(t,e,n){this.el=t,this.vcr=e,this.renderer=n,this.dtOptions={}}return t.prototype.ngOnInit=function(){var t=this;this.dtTrigger?this.dtTrigger.subscribe(function(e){t.displayTable(e)}):this.displayTable(null)},t.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},t.prototype.displayTable=function(t){var e=this;t&&(this.dtOptions=t),this.dtInstance=new Promise(function(t,n){Promise.resolve(e.dtOptions).then(function(o){0===Object.keys(o).length&&0===$("tbody tr",e.el.nativeElement).length?n("Both the table and dtOptions cannot be empty"):setTimeout(function(){var n={rowCallback:function(t,n,i){if(o.columns){var r=o.columns;e.applyNgPipeTransform(t,r),e.applyNgRefTemplate(t,r,n)}o.rowCallback&&o.rowCallback(t,n,i)}};n=Object.assign({},o,n),e.dt=$(e.el.nativeElement).DataTable(n),t(e.dt)})})})},t.prototype.applyNgPipeTransform=function(t,e){e.filter(function(t){return t.ngPipeInstance&&!t.ngTemplateRef}).forEach(function(n){var o=n.ngPipeInstance,i=e.findIndex(function(t){return t.data===n.data}),r=t.childNodes.item(i),a=$(r).text(),c=o.transform(a);$(r).text(c)})},t.prototype.applyNgRefTemplate=function(t,e,n){var o=this;e.filter(function(t){return t.ngTemplateRef&&!t.ngPipeInstance}).forEach(function(i){var r=i.ngTemplateRef,a=r.ref,c=r.context,s=e.findIndex(function(t){return t.data===i.data}),l=t.childNodes.item(s);$(l).html("");var d=Object.assign({},c,null==c?void 0:c.userData,{adtData:n}),u=o.vcr.createEmbeddedView(a,d);o.renderer.appendChild(l,u.rootNodes[0])})},t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(o.s_b),o.Y36(o.Qsj))},t.\u0275dir=o.lG2({type:t,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),t}(),r=n(38583),a=function(){function t(){}return t.forRoot=function(){return{ngModule:t}},t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez]]}),t}()},65242:function(e,o,i){i.r(o),i.d(o,{AuditLogsModule:function(){return w}});var r=i(38583),a=i(39895),c=i(4108),s=i.n(c),l=(i(46481),i(16137),i(35383)),d=i(3118),u=i(37716),p=i(94761),g=i(91841),f=i(60965),h=i(77382),m=i(17988),b=["format"];function v(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"div",7),u.TgZ(1,"label",8),u._uU(2,"Export As"),u.qZA(),u.TgZ(3,"select",9,10),u.TgZ(5,"option",11),u._uU(6,"Excel"),u.qZA(),u.TgZ(7,"option",12),u._uU(8,"PDF"),u.qZA(),u.qZA(),u.TgZ(9,"button",13),u.NdJ("click",function(t){return u.CHM(n),u.oxw().modo(t)}),u._uU(10,"Download"),u.qZA(),u.qZA()}}function Z(t,e){if(1&t&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u._uU(6),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.TgZ(9,"td"),u._uU(10),u.qZA(),u.TgZ(11,"td"),u._uU(12),u.ALo(13,"date"),u.qZA(),u.qZA()),2&t){var n=e.$implicit;u.xp6(2),u.Oqu(n.log),u.xp6(2),u.Oqu(n.creatorId),u.xp6(2),u.Oqu(n.actionPerformBy),u.xp6(2),u.Oqu(n.record),u.xp6(2),u.Oqu(n.action),u.xp6(2),u.Oqu(u.xi3(13,6,n.creatorDtStamp,"medium"))}}function A(t,e){if(1&t&&(u.TgZ(0,"tbody"),u.YNc(1,Z,14,9,"tr",14),u.qZA()),2&t){var n=u.oxw();u.xp6(1),u.Q6J("ngForOf",n.auditlogdata)}}function y(t,e){1&t&&(u.TgZ(0,"tbody"),u.TgZ(1,"tr"),u.TgZ(2,"td",15),u._uU(3,"No data!"),u.qZA(),u.qZA(),u.qZA())}function T(t,e){1&t&&(u.ynx(0),u.TgZ(1,"div",16),u.TgZ(2,"span",17),u._uU(3,"Please wait... "),u._UZ(4,"span",18),u.qZA(),u.qZA(),u.BQk())}var x,q=[{path:"",component:(x=function(){function e(n,o,i,a,c){t(this,e),this.api=n,this.http=o,this.excelService=i,this.cdr=a,this.roleService=c,this.isLoading=!1,this.isSelected=!0,this.dtOptions={},this.pipe=new r.uU("en-US"),this.roleCodes=new l.yv,this.API_URL=d.$.baseURL}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.dtOptions={pagingType:"full_numbers",pageLength:5,serverSide:!0,processing:!0,columnDefs:[{type:"date",targets:[5]}],order:[[5,"desc"]],lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]],ajax:function(e,n){e.minNumber=e.start+1,e.maxNumber=e.start+e.length,console.log(e.minNumber,e.maxNumber);var o=Math.floor(e.minNumber/e.length);t.http.get("".concat(t.API_URL,"/auditLogs/getAllAuditLogs?pageNo=").concat(o,"&pageSize=").concat(e.length)).subscribe(function(e){console.log(e),t.totalPages=e.totalNoOfPages,t.totalRecords=e.totalRecords,t.auditlogdata=e.result,t.isLoading=!1,t.cdr.markForCheck(),n({recordsTotal:e.totalRecords,recordsFiltered:e.totalRecords,data:[]})})}},this.roleService.fetchScreenPermissions("Audit Logs"),this.roleService.screenLabelList.subscribe(function(e){return t.roleCodes=e}),console.log(this.roleCodes)}},{key:"modo",value:function(t){console.log(t),"PDF"==this.format.nativeElement.value&&this.downloadLog(this.totalRecords,this.totalPages),"Excel"===this.format.nativeElement.value&&this.exportAsXLSX()}},{key:"exportAsXLSX",value:function(){var t=this;console.log(this.auditlogdata),this.http.get("".concat(this.API_URL,"/auditLogs/getAllAuditLogs?pageNo=0&pageSize=").concat(this.totalRecords)).subscribe(function(e){t.arrayData=e.result,t.arrayData.forEach(function(e){e.timeForExport=t.pipe.transform(e.timeForExport,"dd-MMM-yy"),e.updatedAt=t.pipe.transform(e.updatedAt,"dd-MMM-yy"),e.creatorDtStamp=t.pipe.transform(e.creatorDtStamp,"dd-MMM-yy"),e.verifierDtStamp=t.pipe.transform(e.verifierDtStamp,"dd-MMM-yy")}),t.excelService.exportAsExcelFile(t.arrayData,"Audit_Report")})}},{key:"downloadLog",value:function(t,e){var n=this;this.http.get("".concat(this.API_URL,"/auditLogs/getAllAuditLogs?pageNo=0&pageSize=").concat(t)).subscribe(function(t){n.convert(t.result)})}},{key:"convert",value:function(t){var e=new(s()),n=[];t.forEach(function(t){var e=new Date(t.creatorDtStamp).toLocaleDateString("en-us");console.log(e),n.push([t.log,t.creatorId,t.actionPerformBy,t.record,t.action,e])}),e.autoTable({head:[["Screen","creatorId","ActionPerformBy","Record","Action","Time"]],body:n}),e.save("AuditLog.pdf")}}]),e}(),x.\u0275fac=function(t){return new(t||x)(u.Y36(p.sM),u.Y36(g.eN),u.Y36(f.b),u.Y36(u.sBO),u.Y36(h.N))},x.\u0275cmp=u.Xpm({type:x,selectors:[["npr-audit-logs"]],viewQuery:function(t,e){var n;1&t&&u.Gf(b,5),2&t&&u.iGM(n=u.CRH())&&(e.format=n.first)},decls:25,vars:5,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],["class","col-2",4,"ngIf"],[1,"dbCardStyle","table-responsive"],["id","auditLogsTable","datatable","",1,"table","tableStyle","tableStyleSelect","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions"],[4,"ngIf"],[1,"col-2"],["for","roleName",1,"formLbl"],["aria-label","Default select example",1,"form-select"],["format",""],["selected","","value","Excel"],["value","PDF"],[1,"downloadForAuditLog",3,"click"],[4,"ngFor","ngForOf"],["colspan","3",1,"no-data-available"],[1,"loading-page-center"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(t,e){1&t&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"h2",2),u._uU(3,"Audit Logs"),u.qZA(),u.qZA(),u.YNc(4,v,11,0,"div",3),u._UZ(5,"br"),u.TgZ(6,"div",4),u.TgZ(7,"table",5),u.TgZ(8,"thead"),u.TgZ(9,"tr"),u.TgZ(10,"th"),u._uU(11,"Screen"),u.qZA(),u.TgZ(12,"th"),u._uU(13,"Creator"),u.qZA(),u.TgZ(14,"th"),u._uU(15,"Action Perform By"),u.qZA(),u.TgZ(16,"th"),u._uU(17,"Record"),u.qZA(),u.TgZ(18,"th"),u._uU(19,"Action"),u.qZA(),u.TgZ(20,"th"),u._uU(21,"Date"),u.qZA(),u.qZA(),u.qZA(),u.YNc(22,A,2,1,"tbody",6),u.YNc(23,y,4,0,"tbody",6),u.qZA(),u.YNc(24,T,5,0,"ng-container",6),u.qZA(),u.qZA()),2&t&&(u.xp6(4),u.Q6J("ngIf",!e.isLoading),u.xp6(3),u.Q6J("dtOptions",e.dtOptions),u.xp6(15),u.Q6J("ngIf",0!=(null==e.auditlogdata?null:e.auditlogdata.length)),u.xp6(1),u.Q6J("ngIf",0==(null==e.auditlogdata?null:e.auditlogdata.length)),u.xp6(1),u.Q6J("ngIf",e.isLoading))},directives:[r.O5,m.G,r.sg],pipes:[r.uU],styles:[".downloadForAuditLog[_ngcontent-%COMP%]{display:inline-block;position:relative;left:250px;bottom:33px;background-color:#d61c4e;color:#f0f8ff;font-family:var(--medium);width:60%;border:0;border-radius:5px}"]}),x)}],L=function(){var e=n(function e(){t(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.Bz.forChild(q)],a.Bz]}),e}(),w=function(){var e=n(function e(){t(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.ez,L,m.T]]}),e}()}}])}();