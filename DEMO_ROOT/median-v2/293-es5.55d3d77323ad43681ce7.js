!function(){"use strict";function e(e,o){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,o){if(!e)return;if("string"==typeof e)return t(e,o);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,o)}(e))||o&&e&&"number"==typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw n}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[293],{31443:function(e,t,a){a.d(t,{k:function(){return l}});var i,n=a(37716),s=a(80463),l=((i=function(){function e(t){o(this,e),this.iziToast=t}return r(e,[{key:"successMessage",value:function(e,t){this.iziToast.success({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}},{key:"errorMessage",value:function(e,t){this.iziToast.error({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}},{key:"infoMessage",value:function(e,t){this.iziToast.info({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}}]),e}()).\u0275fac=function(e){return new(e||i)(n.LFG(s.I))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},10293:function(t,a,i){i.r(a),i.d(a,{ExcelMappingModule:function(){return be}});var n=i(38583),s=i(39895),l=i(50215),u=i(91841),c=i(3679),d=i(79765),p=i(35383),g=i(88259),m=i.n(g),h=i(37716),f=i(94761),v=i(31443),Z=i(77382);function y(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"label",15),h._uU(2,"Currency"),h.TgZ(3,"span",8),h._uU(4,"*"),h.qZA(),h.qZA(),h._UZ(5,"input",16),h.qZA()),2&e){var o=h.oxw();h.xp6(5),h.Q6J("readonly",!o.editFlag1)}}function x(e,t){if(1&e&&(h.TgZ(0,"option",20),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o),h.xp6(1),h.Oqu(o)}}function A(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",6),h.TgZ(1,"label",15),h._uU(2,"Currency"),h.TgZ(3,"span",8),h._uU(4,"*"),h.qZA(),h.qZA(),h.TgZ(5,"select",17),h.NdJ("change",function(e){return h.CHM(o),h.oxw().getCurrencyData(e,"currency")}),h.TgZ(6,"option",18),h._uU(7,"--Please select--"),h.qZA(),h.YNc(8,x,2,2,"option",19),h.qZA(),h.qZA()}if(2&e){var a=h.oxw();h.xp6(5),h.uIk("disabled",a.showCurrencyDropdown?null:""),h.xp6(3),h.Q6J("ngForOf",a.ccyData)}}function T(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"label",21),h._uU(2,"Sheet Number"),h.TgZ(3,"span",8),h._uU(4,"*"),h.qZA(),h.qZA(),h._UZ(5,"input",22),h.qZA()),2&e){var o=h.oxw();h.xp6(5),h.Q6J("readonly",!o.editFlag1)}}function S(e,t){if(1&e&&(h.TgZ(0,"option",20),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o),h.xp6(1),h.Oqu(o)}}function b(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",6),h.TgZ(1,"label",21),h._uU(2,"Sheet Number"),h.TgZ(3,"span",8),h._uU(4,"*"),h.qZA(),h.qZA(),h.TgZ(5,"select",23),h.NdJ("change",function(e){return h.CHM(o),h.oxw().getsheetNumData(e,"sheetNumber")}),h.TgZ(6,"option",18),h._uU(7,"--Please select--"),h.qZA(),h.YNc(8,S,2,2,"option",19),h.qZA(),h.qZA()}if(2&e){var a=h.oxw();h.xp6(8),h.Q6J("ngForOf",a.sheetData)}}var q=function(){return["/excel-mapping"]};function C(e,t){1&e&&(h.TgZ(0,"div",24),h.TgZ(1,"div",25),h.TgZ(2,"a",26),h._uU(3,"Exit"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(2),h.Q6J("routerLink",h.DdM(1,q)))}function F(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"label",27),h._uU(2,"Data Starting Row"),h.qZA(),h._UZ(3,"input",28),h.qZA()),2&e){var o=h.oxw();h.xp6(3),h.Q6J("readonly",!o.editFlag)}}function w(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"div",29),h._UZ(2,"input",30),h.TgZ(3,"label",31),h._uU(4,"Is Header Present"),h.qZA(),h.qZA(),h.qZA()),2&e){var o=h.oxw();h.xp6(2),h.Q6J("readonly",!o.editFlag)}}function N(e,t){if(1&e&&(h.TgZ(0,"option",55),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o.value),h.xp6(1),h.Oqu(o.type)}}function D(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"a",56),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(),t=e.index,a=e.$implicit;return h.oxw(2).removeSubArray(t,a)}),h.TgZ(1,"span"),h._UZ(2,"img",57),h.qZA(),h.qZA()}}function U(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"tr",40),h.TgZ(1,"td"),h._UZ(2,"input",41),h.qZA(),h.TgZ(3,"td"),h.TgZ(4,"select",42),h.NdJ("change",function(){var e=h.CHM(o).index;return h.oxw(2).checkTypeStatus(e)}),h.TgZ(5,"option",18),h._uU(6,"--Please select--"),h.qZA(),h.YNc(7,N,2,2,"option",43),h.qZA(),h.qZA(),h.TgZ(8,"td"),h.TgZ(9,"div",44),h.TgZ(10,"div",29),h._UZ(11,"input",45),h.TgZ(12,"label",46),h.TgZ(13,"span",47),h._uU(14,"Is Mandatory?"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(15,"td"),h._UZ(16,"input",48),h.qZA(),h.TgZ(17,"td"),h._UZ(18,"input",49),h.qZA(),h.TgZ(19,"td"),h._UZ(20,"input",50),h.qZA(),h.TgZ(21,"td"),h._UZ(22,"input",51),h.qZA(),h.TgZ(23,"td"),h._UZ(24,"input",52),h.qZA(),h.TgZ(25,"td"),h._UZ(26,"input",53),h.qZA(),h.TgZ(27,"td"),h.YNc(28,D,3,0,"a",54),h.qZA(),h.qZA()}if(2&e){var a=t.index,r=h.oxw(2);h.Q6J("formGroupName",a),h.xp6(2),h.Q6J("readonly",!r.editFlag),h.xp6(2),h.uIk("disabled",r.editFlag?null:""),h.xp6(3),h.Q6J("ngForOf",r.dataTypes),h.xp6(4),h.MGl("id","mandatoryCheck_",a,""),h.xp6(1),h.MGl("for","mandatoryCheck_",a,""),h.xp6(4),h.MGl("id","headerName_",a,""),h.xp6(2),h.MGl("id","dateFormat_",a,""),h.xp6(2),h.MGl("id","mappingColumn_",a,""),h.xp6(2),h.MGl("id","delimeter_",a,""),h.xp6(2),h.MGl("id","defaultValue_",a,""),h.xp6(2),h.MGl("id","repeatedTillNextValue_",a,""),h.xp6(2),h.Q6J("ngIf",r.editFlag)}}function k(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"a",58),h.TgZ(1,"span",59),h.NdJ("click",function(){return h.CHM(o),h.oxw(2).addSubArray()}),h._UZ(2,"img",60),h.qZA(),h.qZA()}}function M(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"button",66),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(3);return e.updateMappingData(e.addForm.value,e.updateMappingForm.value)}),h._uU(1,"Save"),h.qZA()}if(2&e){var a=h.oxw(3);h.Q6J("disabled",a.dataSaved)("disabled",!a.updateMappingForm.dirty&&!a.addForm.dirty)}}function _(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",63),h.TgZ(1,"button",67),h.NdJ("click",function(){return h.CHM(o),h.oxw(3).enableEditFlag()}),h._uU(2),h.qZA(),h.qZA()}if(2&e){var a=h.oxw(3);h.xp6(2),h.Oqu(a.roleCodes.edit.labelDescription)}}function R(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",63),h.TgZ(1,"button",68),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(3);return e.onClickOfAuth(e.addForm.value,e.updateMappingForm.value)}),h._uU(2),h.qZA(),h.qZA()}if(2&e){var a=h.oxw(3);h.xp6(2),h.Oqu(a.roleCodes.auth.labelDescription)}}function O(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",63),h.TgZ(1,"button",69),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(3);return e.onClickOfClose(e.addForm.value,e.updateMappingForm.value)}),h._uU(2),h.qZA(),h.qZA()}if(2&e){var a=h.oxw(3);h.xp6(2),h.Oqu(a.roleCodes.close.labelDescription)}}function I(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",63),h.TgZ(1,"button",69),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(3);return e.onClickDelete(e.addForm.value,e.updateMappingForm.value)}),h._uU(2),h.qZA(),h.qZA()}if(2&e){var a=h.oxw(3);h.xp6(2),h.Oqu(a.roleCodes.delete.labelDescription)}}function B(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",63),h.TgZ(1,"button",70),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(3);return e.onClickOfReopen(e.addForm.value,e.updateMappingForm.value)}),h._uU(2),h.qZA(),h.qZA()}if(2&e){var a=h.oxw(3);h.xp6(2),h.Oqu(a.roleCodes.reopen.labelDescription)}}function E(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"button",67),h.NdJ("click",function(){h.CHM(o);var e=h.oxw(4);return e.finalSubmit(e.updateMappingForm.value,e.addForm.value)}),h._uU(1,"Save"),h.qZA()}}function J(e,t){if(1&e&&(h.TgZ(0,"div",63),h.YNc(1,E,2,0,"button",71),h.qZA()),2&e){var o=h.oxw(3);h.xp6(1),h.Q6J("ngIf",!o.editFlag&&!o.copyData)}}function Y(e,t){if(1&e&&(h.TgZ(0,"div",61),h.TgZ(1,"div",62),h.TgZ(2,"div",63),h.YNc(3,M,2,2,"button",64),h.qZA(),h.YNc(4,_,3,1,"div",65),h.YNc(5,R,3,1,"div",65),h.YNc(6,O,3,1,"div",65),h.YNc(7,I,3,1,"div",65),h.YNc(8,B,3,1,"div",65),h.YNc(9,J,2,1,"div",65),h.TgZ(10,"div",63),h.TgZ(11,"a",26),h._uU(12,"Exit"),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var o=h.oxw(2);h.xp6(3),h.Q6J("ngIf",o.editFlag&&o.copyData),h.xp6(1),h.Q6J("ngIf",o.newDataResponse&&!o.editFlag&&"OPEN"==o.recordStatus&&o.roleCodes.edit&&o.copyData),h.xp6(1),h.Q6J("ngIf",o.newDataResponse&&!o.editFlag&&"UNAUTHORIZED"==o.authStatus&&o.roleCodes.auth&&o.copyData),h.xp6(1),h.Q6J("ngIf","OPEN"==o.recordStatus&&!o.editFlag&&o.copyData&&"YES"==o.firstTimeAuth),h.xp6(1),h.Q6J("ngIf","NO"==o.firstTimeAuth&&("OPEN"==o.recordStatus||"O"==o.recordStatus)&&!o.editFlag&&o.copyData),h.xp6(1),h.Q6J("ngIf","CLOSED"==o.recordStatus&&!o.editFlag&&o.copyData),h.xp6(1),h.Q6J("ngIf",o.newDataResponse&&o.editFlag),h.xp6(2),h.Q6J("routerLink",h.DdM(8,q))}}function Q(e,t){if(1&e&&(h.TgZ(0,"div",3),h.TgZ(1,"div",72),h.TgZ(2,"div",73),h.TgZ(3,"div",74),h.TgZ(4,"div",75),h.TgZ(5,"div",63),h.TgZ(6,"div",76),h._UZ(7,"i",77),h.qZA(),h.qZA(),h.TgZ(8,"div",78),h.TgZ(9,"div",79),h.TgZ(10,"h2"),h._uU(11,"Maker"),h.qZA(),h.TgZ(12,"p"),h._uU(13),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(14,"div",73),h.TgZ(15,"div",74),h.TgZ(16,"div",75),h.TgZ(17,"div",63),h.TgZ(18,"div",80),h._UZ(19,"img",81),h.qZA(),h.qZA(),h.TgZ(20,"div",78),h.TgZ(21,"div",79),h.TgZ(22,"h2"),h._uU(23,"Maker Time Stamp"),h.qZA(),h.TgZ(24,"p"),h._uU(25),h.ALo(26,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"div",73),h.TgZ(28,"div",74),h.TgZ(29,"div",75),h.TgZ(30,"div",63),h.TgZ(31,"div",82),h._UZ(32,"i",83),h.qZA(),h.qZA(),h.TgZ(33,"div",78),h.TgZ(34,"div",79),h.TgZ(35,"h2"),h._uU(36,"Record Status"),h.qZA(),h.TgZ(37,"p"),h._uU(38),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(39,"div",73),h.TgZ(40,"div",74),h.TgZ(41,"div",75),h.TgZ(42,"div",63),h.TgZ(43,"div",84),h._UZ(44,"i",85),h.qZA(),h.qZA(),h.TgZ(45,"div",78),h.TgZ(46,"div",79),h.TgZ(47,"h2"),h._uU(48,"Checker"),h.qZA(),h.TgZ(49,"p"),h._uU(50),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(51,"div",73),h.TgZ(52,"div",74),h.TgZ(53,"div",75),h.TgZ(54,"div",63),h.TgZ(55,"div",86),h._UZ(56,"img",87),h.qZA(),h.qZA(),h.TgZ(57,"div",78),h.TgZ(58,"div",79),h.TgZ(59,"h2"),h._uU(60,"Checker Time Stamp"),h.qZA(),h.TgZ(61,"p"),h._uU(62),h.ALo(63,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(64,"div",73),h.TgZ(65,"div",74),h.TgZ(66,"div",75),h.TgZ(67,"div",63),h.TgZ(68,"div",88),h._UZ(69,"i",89),h.qZA(),h.qZA(),h.TgZ(70,"div",78),h.TgZ(71,"div",79),h.TgZ(72,"h2"),h._uU(73,"First Time Authorization"),h.qZA(),h.TgZ(74,"p"),h._uU(75),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(76,"div",73),h.TgZ(77,"div",74),h.TgZ(78,"div",75),h.TgZ(79,"div",63),h.TgZ(80,"div",90),h._UZ(81,"img",91),h.qZA(),h.qZA(),h.TgZ(82,"div",78),h.TgZ(83,"div",79),h.TgZ(84,"h2"),h._uU(85,"Authorization Status"),h.qZA(),h.TgZ(86,"p"),h._uU(87),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(88,"div",73),h.TgZ(89,"div",74),h.TgZ(90,"div",75),h.TgZ(91,"div",63),h.TgZ(92,"div",90),h._UZ(93,"img",92),h.qZA(),h.qZA(),h.TgZ(94,"div",78),h.TgZ(95,"div",79),h.TgZ(96,"h2"),h._uU(97,"Modification Number"),h.qZA(),h.TgZ(98,"p"),h._uU(99),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var o=h.oxw(2);h.xp6(13),h.Oqu(o.modifiedBy),h.xp6(12),h.Oqu(h.xi3(26,8,o.modifiedTime,"MM/dd/yyyy, h:mm a")),h.xp6(13),h.Oqu(o.recordStatus),h.xp6(12),h.Oqu(o.authorizedBy),h.xp6(12),h.Oqu(h.xi3(63,11,o.authorizedTime,"MM/dd/yyyy, h:mm a")),h.xp6(13),h.Oqu(o.firstTimeAuth),h.xp6(12),h.Oqu(o.authStatus),h.xp6(12),h.Oqu(o.version)}}function L(e,t){if(1&e&&(h.TgZ(0,"div",3),h.TgZ(1,"form",32),h.TgZ(2,"div",33),h.TgZ(3,"fieldset",34),h.TgZ(4,"table",35),h.TgZ(5,"thead"),h.TgZ(6,"tr"),h.TgZ(7,"th"),h._uU(8,"Name"),h.qZA(),h.TgZ(9,"th"),h._uU(10,"data type"),h.qZA(),h.TgZ(11,"th"),h._uU(12,"mandatory"),h.qZA(),h.TgZ(13,"th"),h._uU(14,"header name"),h.qZA(),h.TgZ(15,"th"),h._uU(16,"date format"),h.qZA(),h.TgZ(17,"th"),h._uU(18,"mapping column"),h.qZA(),h.TgZ(19,"th"),h._uU(20,"delimeter"),h.qZA(),h.TgZ(21,"th"),h._uU(22,"default value"),h.qZA(),h.TgZ(23,"th"),h._uU(24,"repeated till next value"),h.qZA(),h.TgZ(25,"th"),h._uU(26,"delete"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"tbody",36),h.YNc(28,U,29,13,"tr",37),h.TgZ(29,"tr"),h.TgZ(30,"td"),h.YNc(31,k,3,0,"a",38),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.YNc(32,Y,13,9,"div",39),h.YNc(33,Q,100,14,"div",14),h.qZA(),h.qZA()),2&e){var o=h.oxw();h.xp6(1),h.Q6J("formGroup",o.addForm),h.xp6(2),h.Q6J("disabled",!o.editFlag),h.xp6(25),h.Q6J("ngForOf",o.addForm.get("excelMappingDetails").controls),h.xp6(3),h.Q6J("ngIf",o.editFlag),h.xp6(1),h.Q6J("ngIf",o.newDataResponse),h.xp6(1),h.Q6J("ngIf",o.newDataResponse)}}var P,z=((P=function(){function e(t,a,r,i,n,s,l){o(this,e),this.apiService=t,this.cdr=a,this.fb=r,this.toastService=i,this.router=n,this.roleService=s,this.canDeactivateGuard=l,this.roleCodes=new p.yv,this.editFlag=!1,this.editFlag1=!1,this.showCurrencyDropdown=!0,this.showFieldCurrency=!1,this.showFieldsheetNum=!1,this.showFetch=!0,this.extSysCode=null,this.excelprocess=null,this.submitted=!1,this.tempStore=[],this.disablefetchbtn=!1,this.formTouched=!0,this.dataSaved=!1,this.copyData=!0,this.dataTypes=[{id:3,type:"Clob",value:"clob_901",isActive:!1},{id:1,type:"Date",value:"date_751",isActive:!0},{id:2,type:"Number",value:"number_600",isActive:!1},{id:4,type:"Varchar",value:"varchar_0",isActive:!1}],this.showDialog=!1,this.subject=new d.xQ}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.currentUser=localStorage.getItem("userFromLogin"),this.getExtCodeforDropdown(),setTimeout(function(){e.newRolePermissions()},2e3),this.roleService.screenLabelList.subscribe(function(t){return e.roleCodes=t}),setTimeout(function(){console.log(e.roleCodes)},3e3),console.log("role codes",this.roleCodes),this.updateMappingForm=this.fb.group({processName:[""],extSysCode:[""],extSys:[""],userId:[this.currentUser],sheetNumber:[""],headerRepeated:[!1],startingRow:[""],currency:[""]}),this.addForm=this.fb.group({excelMappingDetails:this.fb.array([this.getSubArray()])}),this.gettingSummaryData()}},{key:"newRolePermissions",value:function(){this.roleService.fetchScreenPermissions("Template Mapping")}},{key:"canExit",value:function(){var e=this,t=!1;return this.updateMappingForm.touched&&1==this.formTouched?m().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){return!0===o.isConfirmed?(t=!0,e.cdr.markForCheck(),t):(t=!1,e.cdr.markForCheck(),t)}):(t=!0,new Promise(function(o,a){!0===t&&(t=!0,e.cdr.markForCheck(),o(!0))}))}},{key:"getSubArray",value:function(){return this.fb.group({columnnName:["",[c.kI.required]],dataType:[null,[c.kI.required]],mandatory:[!1],headerName:["",[c.kI.required]],dateFormat:[{value:"",disabled:!0}],delimeter:[""],defaultValue:[""],repeatedTillNextValue:[""],tableMappingColumn:[""],mappingMasterId:[""],mappingDetailId:[""],excelMappingColumn:["",[c.kI.required,c.kI.minLength(1),c.kI.maxLength(3),c.kI.pattern("^[a-zA-Z -#,@,%']+")]]})}},{key:"gettingSummaryData",value:function(){var e=this;this.apiService.getexcelSummaryData().subscribe(function(t){e.summryResponse=t,console.log("this.summryResponse",e.summryResponse);var o=localStorage.getItem("summryResponse");e.summryResponse=JSON.parse(o)}),this.summryResponse&&(this.getExtSysNameByExtSysCode(this.summryResponse.extSysCode),this.extSysCode=this.summryResponse.extSysCode,this.processNAme=this.summryResponse.processName,this.extSys=this.summryResponse.extSys,this.currency=this.summryResponse.currency,this.sheetNumber=this.summryResponse.sheetNumber,this.updateMappingForm.controls.extSysCode.setValue(this.extSysCode),this.updateMappingForm.controls.processName.setValue(this.processNAme),this.apiService.getTemplateMappingDataforEdit(this.extSys,this.processNAme,this.currency,this.sheetNumber).subscribe(function(t){console.log("This. is new Resp",t),e.newDataResponse=t,localStorage.setItem("newDataResponse",JSON.stringify(e.newDataResponse)),console.log(e.newDataResponse,"After"),e.showFieldCurrency=!0,e.showFieldsheetNum=!0,e.updateMappingForm.controls.currency.setValue(e.newDataResponse.currency),e.updateMappingForm.controls.sheetNumber.setValue(e.newDataResponse.sheetNumber);var o=e.newDataResponse.headerRepeated;e.updateMappingForm.controls.startingRow.setValue(e.newDataResponse.startingRow),e.updateMappingForm.controls.headerRepeated.setValue(o),e.showCurrencyDropdown=!1,e.auditLog(),e.patchData(e.newDataResponse.excelMappingDetails.sort(function(e,t){return e.excelMappingColumn>t.excelMappingColumn?1:-1}))}),setTimeout(function(){e.getProcess(e.extSysCode)},100))}},{key:"getAllMappingData",value:function(e,t,o,a){var r=this;console.log("Checking ?",e,t,o,a),this.apiService.fetchAllName(e,t,o).subscribe(function(e){r.fileNames=e}),this.apiService.getAllMappingByExtSysAndProcessCode(e,t,o,a).subscribe(function(e){r.mappingResponse=e,localStorage.setItem("mappingResponse",JSON.stringify(r.mappingResponse));var t=localStorage.getItem("mappingResponse");if(r.mappingResponse=JSON.parse(t),console.log("this.mappingResponse",r.mappingResponse),null==r.mappingResponse)m().fire({title:"Excel mapping is not available with this sheet number!",text:"Please enter the correct sheet number",icon:"warning"});else{m().fire({title:"Data Fetched Successfully!",icon:"success"});var o=r.mappingResponse[0].headerRepeated;r.updateMappingForm.controls.startingRow.setValue(r.mappingResponse[0].startingRow),r.updateMappingForm.controls.headerRepeated.setValue(o),r.showCurrencyDropdown=!1,r.auditLog(),r.patchData(r.mappingResponse),r.cdr.markForCheck(),r.cdr.markForCheck()}})}},{key:"getCurrencyData",value:function(e,t){console.log(e.target.value,t),this.updateMappingForm.controls.sheetNumber.setValue(this.sheetNumber),this.showFieldsheetNum=!0}},{key:"getsheetNumData",value:function(e,t){console.log("event",e.target.value,t)}},{key:"getExtCodeforDropdown",value:function(){var e=this;this.apiService.getAllExtsysNameOnAuthStatus().subscribe(function(t){e.externalSysData=t,e.extSysData=t.sort()})}},{key:"getProcess",value:function(e){console.log(this.externalSysData.map[e].extSysName),this.externalSystsemCodes=this.externalSysData.map[e].extSysName,this.updateMappingForm.value.extSys=this.externalSysData.map[e].extSysName,this.updateMappingForm.get("processName").setValue(this.externalSysData.map[e].processCode),this.processName=this.externalSysData.map[e].processCode,this.getExtSysNameByExtSysCode(e)}},{key:"getExtSysNameByExtSysCode",value:function(e){var t=this;this.apiService.getExtSysNameByExtSysCode(e).subscribe(function(e){t.extNameValue=e}),console.log(this.extNameValue)}},{key:"getProcessName",value:function(e,t,o){var a=this;this.apiService.getCurrencyOnExtNameAndProcssCode(e,t,o).subscribe(function(e){a.ccyData=e,console.log("Currency",a.ccyData),0!=a.ccyData.length||m().fire({title:"No Currency Found For the Process code!",icon:"warning"})})}},{key:"patchData",value:function(e){console.log(e);var t=this.addForm.controls.excelMappingDetails;t.controls=[];for(var o=0;o<e.length;o++)t.push(this.getSubArray()),console.log("Inside for loop");console.log(t),console.log(this.addForm),this.addForm.patchValue({excelMappingDetails:e}),console.log(this.addForm)}},{key:"addSubArray",value:function(){this.addForm.controls.excelMappingDetails.push(this.getSubArray())}},{key:"getSubArrayFormGroup",value:function(e){return this.addForm.controls.excelMappingDetails.get([e]).value}},{key:"f",get:function(){return this.addForm.controls}},{key:"t",get:function(){return this.f.excelMappingDetails}},{key:"auditLog",value:function(){var e,t,o,a,r,i,n,s;console.log(this.newDataResponse),this.authStatus=null===(e=this.newDataResponse)||void 0===e?void 0:e.authStatus,this.recordStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.recordStatus,this.modifiedBy=null===(o=this.newDataResponse)||void 0===o?void 0:o.inputBy,this.modifiedTime=null===(a=this.newDataResponse)||void 0===a?void 0:a.inputDtStamp,this.authorizedBy=null===(r=this.newDataResponse)||void 0===r?void 0:r.authorizedBy,this.authorizedTime=null===(i=this.newDataResponse)||void 0===i?void 0:i.authorizedDtStamp,this.version=null===(n=this.newDataResponse)||void 0===n?void 0:n.version,this.firstTimeAuth=null===(s=this.newDataResponse)||void 0===s?void 0:s.firstTimeAuth,console.log("AuditLog",this.authStatus,this.recordStatus,this.modifiedBy,this.authorizedBy),"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),"Y"===this.firstTimeAuth&&(this.firstTimeAuth="YES"),"N"===this.firstTimeAuth&&(this.firstTimeAuth="NO")}},{key:"checkTypeStatus",value:function(e){var t=this.addForm.controls.excelMappingDetails.get([e]);"Date"==t.value.dataType?(this.is_edit=!1,t.get("dateFormat").enable()):t.get("dateFormat").disable()}},{key:"mandatoryCheck",value:function(e,t){var o=e.currentTarget.checked;this.addForm.get("excelMappingDetails").at(t).get("mandatory").setValue(o),console.log("value",o,t)}},{key:"enableEditFlag",value:function(){this.editFlag=!0,this.editFlag1=!1,this.showCurrencyDropdown=!0;for(var e=this.addForm.controls.excelMappingDetails,t=0;t<this.addForm.get("excelMappingDetails").controls.length;t++){var o=e.get([t]);"date_751"==o.value.dataType?(console.log("Inside If"),this.is_edit=!1,o.get("dateFormat").enable()):(console.log("Inside else"),o.get("dateFormat").disable())}}},{key:"clickFunction",value:function(e){console.log("i",e)}},{key:"copyMaping",value:function(e){this.mappingResponse="",this.editFlag=!0,this.copyData=!1,this.processResp=[],this.excelprocess="",e.excelMappingDetails.forEach(function(e){e.id=null}),console.log(e.excelMappingDetails)}},{key:"updateMappingData",value:function(e,t){var o=this;if(console.log(this.extNameValue),this.submitted=!0,this.progress=!0,e.excelMappingDetails[0].inputBy,this.currentUser,this.addForm.invalid)m().fire({text:"Numeric values not allowed in mapping column!",icon:"warning"});else{t.extSys=this.extNameValue;var a=Object.assign(Object.assign({},t),e);console.log(a),this.apiService.excelMappingAuditLog(a,"update").subscribe(function(e){o.newDataResponse=e,console.log(o.newDataResponse),o.newDataResponse?(o.editFlag=!1,o.showCurrencyDropdown=!1,o.dataSaved=!0,m().fire({text:"Record is Updated!",icon:"success"}),o.auditLog(),o.formTouched=!o.updateMappingForm.touched,o.cdr.markForCheck()):m().fire({text:"Failed to update ",icon:"error"})})}}},{key:"onClickOfAuth",value:function(e,t){var o=this;this.currentUser=localStorage.getItem("userFromLogin"),console.log("this.currentUser",this.currentUser,e,t),console.log(this.newDataResponse),this.modifiedBy===this.currentUser?m().fire({title:"Maker Cannot Authorized the Record!",icon:"error"}):m().fire({text:"You are trying to Authorize the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){!0===e.isConfirmed&&(o.newDataResponse.userId=o.currentUser,o.apiService.excelMappingAuditLog(o.newDataResponse,"authorize").subscribe(function(e){var t,a,r,i,n,s,l,u;o.newDataResponse=e,o.newDataResponse&&(o.authStatus=null===(t=o.newDataResponse)||void 0===t?void 0:t.authStatus,o.recordStatus=null===(a=o.newDataResponse)||void 0===a?void 0:a.recordStatus,o.modifiedTime=null===(r=o.newDataResponse)||void 0===r?void 0:r.inputDtStamp,o.authorizedBy=null===(i=o.newDataResponse)||void 0===i?void 0:i.authorizedBy,o.authorizedTime=null===(n=o.newDataResponse)||void 0===n?void 0:n.authorizedDtStamp,o.version=null===(s=o.newDataResponse)||void 0===s?void 0:s.version,o.firstTimeAuth=null===(l=o.newDataResponse)||void 0===l?void 0:l.firstTimeAuth,o.modifiedBy=null===(u=o.newDataResponse)||void 0===u?void 0:u.inputBy,"U"===o.authStatus&&(o.authStatus="UNAUTHORIZED"),"A"===o.authStatus&&(o.authStatus="AUTHORIZED"),"C"===o.recordStatus&&(o.recordStatus="CLOSED"),"O"===o.recordStatus&&(o.recordStatus="OPEN"),"Y"===o.firstTimeAuth&&(o.firstTimeAuth="YES"),"N"===o.firstTimeAuth&&(o.firstTimeAuth="NO"),m().fire({title:"Record is Authorized",icon:"success"}))}))})}},{key:"onClickDelete",value:function(e,t){var o=this;console.log(this.newDataResponse),m().fire({text:"You are trying to delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){!0===e.isConfirmed&&o.apiService.deleteTemplateMapping(o.extSys,o.processNAme,o.currency,o.sheetNumber).subscribe(function(e){1==e?m().fire({title:"Record is Closed",icon:"success"}).then(function(e){o.router.navigateByUrl("/excel-mapping")}):m().fire({title:"Failed to Delete the Recored!",icon:"error"})})})}},{key:"onClickOfClose",value:function(e,t){var o=this;console.log(this.newDataResponse),m().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){!0===e.isConfirmed&&o.apiService.excelMappingAuditLog(o.newDataResponse,"close").subscribe(function(e){var t,a,r,i,n,s,l;console.log(e),o.newDataResponse=e,o.newDataResponse?(o.authStatus=null===(t=o.newDataResponse)||void 0===t?void 0:t.authStatus,o.recordStatus=null===(a=o.newDataResponse)||void 0===a?void 0:a.recordStatus,o.modifiedBy=null===(r=o.newDataResponse)||void 0===r?void 0:r.inputBy,o.modifiedTime=null===(i=o.newDataResponse)||void 0===i?void 0:i.inputDtStamp,o.authorizedBy=null===(n=o.newDataResponse)||void 0===n?void 0:n.authorizedBy,o.authorizedTime=null===(s=o.newDataResponse)||void 0===s?void 0:s.authorizedTime,o.version=null===(l=o.newDataResponse)||void 0===l?void 0:l.version,"U"===o.authStatus&&(o.authStatus="UNAUTHORIZED"),"A"===o.authStatus&&(o.authStatus="AUTHORIZED"),"C"===o.recordStatus&&(o.recordStatus="CLOSED"),"O"===o.recordStatus&&(o.recordStatus="OPEN"),m().fire({title:"Record is Closed",icon:"success"}),o.auditLog()):m().fire({title:"Failed to Close the Recored!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"onClickOfReopen",value:function(e,t){var o=this;this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.currentUser=this.newDataResponse.inputBy,m().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){console.log("this is reopen ",e),!0===e.isConfirmed&&o.apiService.excelMappingAuditLog(o.newDataResponse,"reopen").subscribe(function(e){var t,a,r,i,n,s,l;console.log(e),o.newDataResponse=e,o.newDataResponse?(o.authStatus=null===(t=o.newDataResponse)||void 0===t?void 0:t.authStatus,o.recordStatus=null===(a=o.newDataResponse)||void 0===a?void 0:a.recordStatus,o.modifiedBy=null===(r=o.newDataResponse)||void 0===r?void 0:r.inputBy,o.modifiedTime=null===(i=o.newDataResponse)||void 0===i?void 0:i.inputDtStamp,o.authorizedBy=null===(n=o.newDataResponse)||void 0===n?void 0:n.authorizedBy,o.authorizedTime=null===(s=o.newDataResponse)||void 0===s?void 0:s.authorizedTime,o.version=null===(l=o.newDataResponse)||void 0===l?void 0:l.version,"U"===o.authStatus&&(o.authStatus="UNAUTHORIZED"),"A"===o.authStatus&&(o.authStatus="AUTHORIZED"),"C"===o.recordStatus&&(o.recordStatus="CLOSED"),"O"===o.recordStatus&&(o.recordStatus="OPEN"),m().fire({title:"Record is Reopened",icon:"success"}),o.auditLog()):m().fire({title:"Failed to Reopen the Record!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"removeSubArray",value:function(e,t){console.log(e,"Deleted"),this.getRowIdx(e)}},{key:"getRowIdx",value:function(e){var t=this,o=this.addForm.controls.excelMappingDetails,a=o.get([e]);this.apiService.deleteMappingRow(a.value.mappingDetailId).subscribe(function(e){e||m().fire({title:"Failed to Delete the Record!",icon:"error"}),t.cdr.markForCheck()}),o.removeAt(e)}},{key:"finalSubmit",value:function(e,t){var o=this;console.log(this.externalSystsemCodes),e.extSys=this.externalSystsemCodes,console.log("Form",e,t),this.submitted=!0,this.extCodeValue=e.extSysCode,this.proCodeValue=e.processName,this.isCheckedValue=e.headerRepeated,this.startingValue=e.startingRow,this.currencyValue=e.currency,this.sheetNumberValue=e.sheetNumber,this.apiService.columnData(t,this.extCodeValue,this.proCodeValue,this.isCheckedValue,this.startingValue,this.extCodeValue,this.currencyValue,this.currentUser,this.sheetNumberValue).subscribe(function(e){if(o.newDataResponse=e,console.log("this.mappingResponse",o.newDataResponse),o.newDataResponse)return o.is_edit=!0,o.auditLog(),m().fire({title:"Mapped Successfully!",icon:"success"}),o.updateMappingForm.reset(),void o.addForm.reset();m().fire({title:"Failed ExternalSystem And ProcessCode Already Mapped.",icon:"error"}),o.updateMappingForm.reset(),o.addForm.reset()})}}]),e}()).\u0275fac=function(e){return new(e||P)(h.Y36(f.sM),h.Y36(h.sBO),h.Y36(c.qu),h.Y36(v.k),h.Y36(s.F0),h.Y36(Z.N),h.Y36(l.I))},P.\u0275cmp=h.Xpm({type:P,selectors:[["npr-excel-mapping-edit"]],decls:27,vars:11,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],["action","",1,"formStyle",3,"formGroup"],[1,"row","gy-4","align-items-end"],[1,"col-lg-2"],["for","extSysCode",1,"formLbl"],[1,"colorRed"],["id","extSysCode","type","text","required","","formControlName","extSysCode","placeholder","External System","value","",1,"form-control",3,"readonly"],["for","processName",1,"formLbl"],["id","processName","type","text","required","","formControlName","processName","placeholder","Process Code","value","",1,"form-control",3,"readonly"],["class","col-lg-2",4,"ngIf"],["class","row gy-4  col-lg-4 ",4,"ngIf"],["class","dbCardStyle",4,"ngIf"],["for","currency",1,"formLbl"],["id","currency","type","text","required","","formControlName","currency","placeholder","Currency ","value","",1,"form-control",3,"readonly"],["formControlName","currency","required","","aria-label","Default select example",1,"form-select",3,"change"],["hidden","","value","","disabled","","selected",""],["class","form-class",3,"value",4,"ngFor","ngForOf"],[1,"form-class",3,"value"],["for","sheetNumber",1,"formLbl"],["id","sheetNumber","type","text","required","","formControlName","sheetNumber","placeholder","Sheet Number","value","",1,"form-control",3,"readonly"],["formControlName","sheetNumber","required","","aria-label","Default select example",1,"form-select",3,"change"],[1,"row","gy-4","col-lg-4"],[1,"col-lg-4"],["href","javascript:void(0)",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["for","startingRow",1,"formLbl"],["id","startingRow","type","text","required","","formControlName","startingRow","placeholder","Data Starting Row","value","",1,"form-control",3,"readonly"],[1,"checkStyle"],["type","checkbox","id","headerRepeated","formControlName","headerRepeated",3,"readonly"],["for","headerRepeated"],["action","","novalidate","",1,"formStyle",3,"formGroup"],[1,"table-responsive"],[3,"disabled"],["id","dbTable1",1,"table","tableStyle1","responsive","nowrap","vAlignMdl"],["formArrayName","excelMappingDetails"],[3,"formGroupName",4,"ngFor","ngForOf"],["href","javascript:void(0)","class","addIcon primarybg",4,"ngIf"],["class","col-lg-12",4,"ngIf"],[3,"formGroupName"],["id","sourceCode","type","text","formControlName","columnnName","placeholder","Name","value","",1,"form-control1",3,"readonly"],["formControlName","dataType","placeholder","Choose DataType","aria-label","Default select example",1,"form-select1",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"checkboxdiv"],["type","checkbox","formControlName","mandatory",3,"id"],[3,"for"],[2,"display","none"],["type","text","formControlName","headerName","placeholder","Header Name","value","",1,"form-control1",3,"id"],["type","text","formControlName","dateFormat","placeholder","Date Format","value","",1,"form-control1",3,"id"],["type","text","formControlName","excelMappingColumn","placeholder","Mapping Column","value","",1,"form-control1",3,"id"],["type","text","formControlName","delimeter","placeholder","Delimeter","value","",1,"form-control1",3,"id"],["type","text","formControlName","defaultValue","placeholder","Default Value","value","",1,"form-control1",3,"id"],["type","text","formControlName","repeatedTillNextValue","placeholder","Repeated Till Next Value","value","",1,"form-control1",3,"id"],["href","javascript:void(0)","class","deleteIcon2",3,"click",4,"ngIf"],[3,"value"],["href","javascript:void(0)",1,"deleteIcon2",3,"click"],["src","assets/images/delete-icon.svg","alt","..."],["href","javascript:void(0)",1,"addIcon","primarybg"],[3,"click"],["src","assets/images/plus-icon.svg","alt","..."],[1,"col-lg-12"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],[1,"col-auto"],["class","btn smBtn minWdSmBtn btnPrimary",3,"disabled","click",4,"ngIf"],["class","col-auto",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnAuth",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["color","warn",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["class","btn smBtn minWdSmBtn btnUpdate","color","primary",3,"click",4,"ngIf"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/modification.svg","alt","...",1,"modImage"]],template:function(e,t){1&e&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"h2",2),h._uU(3,"Update/Copy Mapping"),h.qZA(),h.qZA(),h.TgZ(4,"div",3),h.TgZ(5,"form",4),h.TgZ(6,"div",5),h.TgZ(7,"div",6),h.TgZ(8,"label",7),h._uU(9,"External System"),h.TgZ(10,"span",8),h._uU(11,"*"),h.qZA(),h.qZA(),h._UZ(12,"input",9),h.qZA(),h.TgZ(13,"div",6),h.TgZ(14,"label",10),h._uU(15,"Process Code"),h.TgZ(16,"span",8),h._uU(17,"*"),h.qZA(),h.qZA(),h._UZ(18,"input",11),h.qZA(),h.YNc(19,y,6,1,"div",12),h.YNc(20,A,9,2,"div",12),h.YNc(21,T,6,1,"div",12),h.YNc(22,b,9,1,"div",12),h.YNc(23,C,4,2,"div",13),h.YNc(24,F,4,1,"div",12),h.YNc(25,w,5,1,"div",12),h.qZA(),h.qZA(),h.qZA(),h.YNc(26,L,34,6,"div",14),h.qZA()),2&e&&(h.xp6(5),h.Q6J("formGroup",t.updateMappingForm),h.xp6(7),h.Q6J("readonly",!t.editFlag1),h.xp6(6),h.Q6J("readonly",!t.editFlag1),h.xp6(1),h.Q6J("ngIf",t.showFieldCurrency),h.xp6(1),h.Q6J("ngIf",!t.showFieldCurrency),h.xp6(1),h.Q6J("ngIf",t.showFieldsheetNum),h.xp6(1),h.Q6J("ngIf",!t.showFieldsheetNum),h.xp6(1),h.Q6J("ngIf",t.showFetch),h.xp6(1),h.Q6J("ngIf",t.newDataResponse),h.xp6(1),h.Q6J("ngIf",t.newDataResponse),h.xp6(1),h.Q6J("ngIf",t.newDataResponse))},directives:[c._Y,c.JL,c.sg,c.Fj,c.Q7,c.JJ,c.u,n.O5,c.EJ,c.YN,c.Kr,n.sg,s.yS,c.Wl,c.CE,c.x0],pipes:[n.uU],styles:[".form-class[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#797979;background-color:#fff;background-clip:padding-box;border-bottom:1px solid #ebebeb;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;-webkit-appearance:none;-moz-appearance:none;appearance:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}table.tableStyle1[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:10px;text-transform:uppercase;border-bottom:1px solid #F5F5F5}.form-control1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:13px;font-weight:400;line-height:1.5;color:#212529;height:45px;background-color:#f8f9fa;background-clip:padding-box;border:1px solid #efefef;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control1[_ngcontent-%COMP%]:disabled, .form-control1[readonly][_ngcontent-%COMP%]{opacity:1}.form-select1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;-moz-padding-start:calc(.75rem - 3px);font-size:13px;height:45px;font-weight:400;line-height:1.5;color:#212529;background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;background-color:#f8f9fa;border:1px solid #efefef;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-appearance:none;-moz-appearance:none;appearance:none}.checkboxdiv[_ngcontent-%COMP%]{padding-left:25px;padding-bottom:15px;cursor:pointer}"]}),P),V=i(24376);function H(e,t){if(1&e&&(h.TgZ(0,"ng-option",40),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o),h.xp6(1),h.Oqu(o)}}function G(e,t){if(1&e&&(h.TgZ(0,"option",40),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o),h.xp6(1),h.Oqu(o)}}function j(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"select",41),h.NdJ("change",function(){h.CHM(o);var e=h.oxw();return e.getProcessName(e.excelMappingForm.get("processName").value,e.excelMappingForm.get("extSysCode").value)}),h.TgZ(1,"option",14),h._uU(2,"--Please select--"),h.qZA(),h.YNc(3,G,2,2,"option",15),h.qZA()}if(2&e){var a=h.oxw();h.uIk("disabled",a.editFlag?"":null),h.xp6(3),h.Q6J("ngForOf",a.processName)}}function W(e,t){if(1&e&&h._UZ(0,"input",42),2&e){var o=h.oxw();h.Q6J("readonly",o.editFlag)}}function $(e,t){if(1&e&&(h.TgZ(0,"option",40),h._uU(1),h.qZA()),2&e){var o=t.$implicit;h.Q6J("value",o.type),h.xp6(1),h.Oqu(o.type)}}function X(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"a",56),h.TgZ(1,"span",57),h.NdJ("click",function(){h.CHM(o);var e=h.oxw().index;return h.oxw().removeSubArray(e)}),h._UZ(2,"img",58),h.qZA(),h.qZA()}}function K(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"tr"),h.ynx(1,43),h.TgZ(2,"td"),h._UZ(3,"input",44),h.qZA(),h.TgZ(4,"td"),h.TgZ(5,"select",45),h.NdJ("change",function(){var e=h.CHM(o).index,t=h.oxw();return t.checkTypeStatus(e,t.addForm.value)}),h.TgZ(6,"option",14),h._uU(7,"--Please select--"),h.qZA(),h.YNc(8,$,2,2,"option",15),h.qZA(),h.qZA(),h.TgZ(9,"td"),h.TgZ(10,"div",46),h.TgZ(11,"div",25),h._UZ(12,"input",47),h._UZ(13,"label",48),h.qZA(),h.qZA(),h.qZA(),h.TgZ(14,"td"),h._UZ(15,"input",49),h.qZA(),h.TgZ(16,"td"),h._UZ(17,"input",50),h.qZA(),h.TgZ(18,"td"),h._UZ(19,"input",51),h.qZA(),h.TgZ(20,"td"),h._UZ(21,"input",52),h.qZA(),h.TgZ(22,"td"),h._UZ(23,"input",53),h.qZA(),h.TgZ(24,"td"),h._UZ(25,"input",54),h.qZA(),h.TgZ(26,"td"),h.YNc(27,X,3,0,"a",55),h.qZA(),h.BQk(),h.qZA()}if(2&e){var a=t.index,r=h.oxw();h.xp6(1),h.Q6J("formGroupName",a),h.xp6(2),h.Q6J("readonly",r.editFlag),h.xp6(2),h.uIk("disabled",r.editFlag?"":null),h.xp6(3),h.Q6J("ngForOf",r.dataTypes),h.xp6(4),h.MGl("id","mandatoryCheck_",a,""),h.xp6(1),h.MGl("for","mandatoryCheck_",a,""),h.xp6(2),h.MGl("id","headerName_",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.MGl("id","dateFormat_",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.MGl("id","excelMappingColumn",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.MGl("id","delimeter_",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.MGl("id","defaultValue_",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.MGl("id","repeatedTillNextValue_",a,""),h.Q6J("readonly",r.editFlag),h.xp6(2),h.Q6J("ngIf",!r.editFlag)}}function ee(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"a",59),h.NdJ("click",function(){return h.CHM(o),h.oxw().addSubArray()}),h.TgZ(1,"span"),h._UZ(2,"img",60),h.qZA(),h.qZA()}}function te(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",61),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.updateMappingData(e.addForm.value,e.excelMappingForm.value)}),h._uU(2,"Save "),h.qZA(),h.qZA()}if(2&e){var a=h.oxw();h.xp6(1),h.Q6J("disabled",a.dataSaved)}}function oe(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",62),h.NdJ("click",function(){return h.CHM(o),h.oxw().enableEditFlag()}),h._uU(2,"Edit"),h.qZA(),h.qZA()}}function ae(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",63),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.onClickOfAuth(e.addForm.value,e.excelMappingForm.value)}),h._uU(2,"Auth"),h.qZA(),h.qZA()}}function re(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",64),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.onClickOfDelete(e.addForm.value,e.excelMappingForm.value)}),h._uU(2,"Delete"),h.qZA(),h.qZA()}}function ie(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",62),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.onClickOfClose(e.addForm.value,e.excelMappingForm.value)}),h._uU(2,"Close"),h.qZA(),h.qZA()}}function ne(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",65),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.onClickOfReopen(e.addForm.value,e.excelMappingForm.value)}),h._uU(2,"Reopen"),h.qZA(),h.qZA()}}function se(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"div",5),h.TgZ(1,"button",61),h.NdJ("click",function(){h.CHM(o);var e=h.oxw();return e.finalSubmit(e.excelMappingForm.value,e.addForm.value)}),h._uU(2,"Save"),h.qZA(),h.qZA()}if(2&e){var a=h.oxw();h.xp6(1),h.Q6J("disabled",a.excelMappingForm.invalid||a.addForm.controls.excelMappingDetails.invalid),h.uIk("disabled",a.editFlag)}}function le(e,t){if(1&e&&(h.TgZ(0,"div",3),h.TgZ(1,"div",66),h.TgZ(2,"div",67),h.TgZ(3,"div",68),h.TgZ(4,"div",69),h.TgZ(5,"div",5),h.TgZ(6,"div",70),h._UZ(7,"i",71),h.qZA(),h.qZA(),h.TgZ(8,"div",72),h.TgZ(9,"div",73),h.TgZ(10,"h2"),h._uU(11,"Maker"),h.qZA(),h.TgZ(12,"p"),h._uU(13),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(14,"div",67),h.TgZ(15,"div",68),h.TgZ(16,"div",69),h.TgZ(17,"div",5),h.TgZ(18,"div",74),h._UZ(19,"img",75),h.qZA(),h.qZA(),h.TgZ(20,"div",72),h.TgZ(21,"div",73),h.TgZ(22,"h2"),h._uU(23,"Maker Time Stamp"),h.qZA(),h.TgZ(24,"p"),h._uU(25),h.ALo(26,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(27,"div",67),h.TgZ(28,"div",68),h.TgZ(29,"div",69),h.TgZ(30,"div",5),h.TgZ(31,"div",76),h._UZ(32,"i",77),h.qZA(),h.qZA(),h.TgZ(33,"div",72),h.TgZ(34,"div",73),h.TgZ(35,"h2"),h._uU(36,"Record Status"),h.qZA(),h.TgZ(37,"p"),h._uU(38),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(39,"div",67),h.TgZ(40,"div",68),h.TgZ(41,"div",69),h.TgZ(42,"div",5),h.TgZ(43,"div",78),h._UZ(44,"i",79),h.qZA(),h.qZA(),h.TgZ(45,"div",72),h.TgZ(46,"div",73),h.TgZ(47,"h2"),h._uU(48,"Checker"),h.qZA(),h.TgZ(49,"p"),h._uU(50),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(51,"div",67),h.TgZ(52,"div",68),h.TgZ(53,"div",69),h.TgZ(54,"div",5),h.TgZ(55,"div",80),h._UZ(56,"img",81),h.qZA(),h.qZA(),h.TgZ(57,"div",72),h.TgZ(58,"div",73),h.TgZ(59,"h2"),h._uU(60,"Checker Time Stamp"),h.qZA(),h.TgZ(61,"p"),h._uU(62),h.ALo(63,"date"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(64,"div",67),h.TgZ(65,"div",68),h.TgZ(66,"div",69),h.TgZ(67,"div",5),h.TgZ(68,"div",82),h._UZ(69,"i",83),h.qZA(),h.qZA(),h.TgZ(70,"div",72),h.TgZ(71,"div",73),h.TgZ(72,"h2"),h._uU(73,"First Time Authorization"),h.qZA(),h.TgZ(74,"p"),h._uU(75),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(76,"div",67),h.TgZ(77,"div",68),h.TgZ(78,"div",69),h.TgZ(79,"div",5),h.TgZ(80,"div",84),h._UZ(81,"img",85),h.qZA(),h.qZA(),h.TgZ(82,"div",72),h.TgZ(83,"div",73),h.TgZ(84,"h2"),h._uU(85,"Authorization Status"),h.qZA(),h.TgZ(86,"p"),h._uU(87),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(88,"div",67),h.TgZ(89,"div",68),h.TgZ(90,"div",69),h.TgZ(91,"div",5),h.TgZ(92,"div",84),h._UZ(93,"img",86),h.qZA(),h.qZA(),h.TgZ(94,"div",72),h.TgZ(95,"div",73),h.TgZ(96,"h2"),h._uU(97,"Modification Number"),h.qZA(),h.TgZ(98,"p"),h._uU(99),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&e){var o=h.oxw();h.xp6(13),h.Oqu(o.dataFromresponse.inputBy),h.xp6(12),h.Oqu(h.xi3(26,8,o.dataFromresponse.inputDtStamp,"MM/dd/yyyy, h:mm a")),h.xp6(13),h.Oqu(o.dataFromresponse.recordStatus),h.xp6(12),h.Oqu(o.dataFromresponse.authorizedBy),h.xp6(12),h.Oqu(h.xi3(63,11,o.dataFromresponse.authorizedDtStamp,"MM/dd/yyyy, h:mm a")),h.xp6(13),h.Oqu(o.dataFromresponse.firstTimeAuth),h.xp6(12),h.Oqu(o.dataFromresponse.authStatus),h.xp6(12),h.Oqu(o.dataFromresponse.version)}}var ue=function(){return["/excel-mapping/excel-mapping-edit"]},ce=function(){return["/dashbaord"]},de=function(){return["/excel-mapping"]},pe=function(){var e=function(){function e(t,a,r,i,n,s){o(this,e),this.apiService=t,this.fb=a,this.toastService=r,this.router=i,this.cdr=n,this.canDeactivateGuard=s,this.extSysCode=null,this.excelprocess=null,this.submitted=!1,this.editFlag=!1,this.dataTypes=[{id:3,type:"Clob",isActive:!1},{id:1,type:"Date",isActive:!0},{id:2,type:"Number",isActive:!1},{id:4,type:"VarChar",isActive:!1}],this.dataSaved=!1,this.showUpdate=!1,this.formTouched=!0,this.showDialog=!1,this.subject=new d.xQ,this.checkMandatory=!1,this.isDateValid=!1,this.processNameField="text"}return r(e,[{key:"ngOnInit",value:function(){this.currentUser=localStorage.getItem("userFromLogin"),this.excelMappingForm=this.fb.group({processName:[""],extSysCode:[""],extSys:[""],userId:[this.currentUser],sheetNumber:[""],headerRepeated:[!1],startingRow:[""],currency:[""]}),this.addForm=this.fb.group({excelMappingDetails:this.fb.array([this.getSubArray()])}),this.getAllExtsysNameAndProcessCodeOnAuthStatus(),console.log(this.currentUser)}},{key:"auditLog",value:function(){"U"===this.dataFromresponse.authStatus&&(this.dataFromresponse.authStatus="UNAUTHORIZED"),"A"===this.dataFromresponse.authStatus&&(this.dataFromresponse.authStatus="AUTHORIZED"),"C"===this.dataFromresponse.recordStatus&&(this.dataFromresponse.recordStatus="CLOSED"),"O"===this.dataFromresponse.recordStatus&&(this.dataFromresponse.recordStatus="OPEN"),"N"===this.dataFromresponse.firstTimeAuth&&(this.dataFromresponse.firstTimeAuth="NO"),"Y"===this.dataFromresponse.firstTimeAuth&&(this.dataFromresponse.firstTimeAuth="YES")}},{key:"getSubArray",value:function(){return this.fb.group({columnnName:["",[c.kI.required]],dataType:[null,[c.kI.required]],mandatory:[!1],headerName:["",[c.kI.required]],dateFormat:[{value:"",disabled:!0}],delimeter:[""],defaultValue:[""],repeatedTillNextValue:[""],tableMappingColumn:[""],mappingMasterId:[""],excelMappingColumn:["",[c.kI.required,c.kI.minLength(1),c.kI.maxLength(3),c.kI.pattern("^[a-zA-Z -#,@,%']+")]]})}},{key:"mandatoryRequired",value:function(e,t){console.log(e),console.log(t),1==e&&(console.log("Inside True"),this.checkMandatory=!1),0==e&&console.log("Inside False")}},{key:"getAllExternalSystem",value:function(){var e=this;this.apiService.getAllExtCode().subscribe(function(t){e.extSysData=t})}},{key:"getAllExtsysNameAndProcessCodeOnAuthStatus",value:function(){var e=this;this.apiService.getAllExtsysNameOnAuthStatus().subscribe(function(t){e.externalSysData=t,e.extSysData=t.sort()})}},{key:"getExtSysNameByExtSysCode",value:function(e){var t=this;this.apiService.getExtSysNameByExtSysCode(e).subscribe(function(e){t.extNameValue=e}),console.log(this.extNameValue)}},{key:"getProcess",value:function(e){var t=this;this.excelMappingForm.get("processName").setValue(""),this.processNameField="text",this.processName=[],this.apiService.getProcessNameByExtSysCode(e).subscribe(function(o){t.processResp=o,t.processName=t.processResp,1===t.processName.length&&null!=t.processName&&(t.processNameField="text",t.excelMappingForm.get("processName").setValue(t.processName[0]),t.excelMappingForm.value.extSys=""),t.processName.length>1&&(t.processNameField="select"),t.getExtSysNameByExtSysCode(e)})}},{key:"getProcessName",value:function(e,t){this.extSysCode=t,this.excelprocess=e}},{key:"mandatoryCheck",value:function(e,t){var o=e.currentTarget.checked;this.addForm.get("excelMappingDetails").at(t).get("mandatory").setValue(o),console.log("value",o,t)}},{key:"addSubArray",value:function(){var e=this.addForm.controls.excelMappingDetails;console.log("const control",e),e.push(this.getSubArray())}},{key:"patchData",value:function(e){console.log("formdata");for(var t=this.addForm.controls.excelMappingDetails,o=0;o<e.length;o++)t.push(this.getSubArray());this.addForm.patchValue({excelMappingDetails:e})}},{key:"removeSubArray",value:function(e){this.addForm.controls.excelMappingDetails.removeAt(e)}},{key:"clearAllSubArray",value:function(){for(var e=this.addForm.controls.excelMappingDetails;e.length;)e.removeAt(e.length-1);e.clearValidators()}},{key:"f",get:function(){return this.addForm.controls}},{key:"t",get:function(){return this.f.excelMappingDetails}},{key:"checkTypeStatus",value:function(e,t){var o=this.addForm.controls.excelMappingDetails.get([e]);console.log(o.value.dataType),"Date"==o.value.dataType?(console.log("Dates"),this.is_edit=!1,o.get("dateFormat").clearValidators(),o.get("dateFormat").setValidators([c.kI.required]),o.get("dateFormat").updateValueAndValidity(),o.get("dateFormat").enable()):o.get("dateFormat").disable()}},{key:"clickFunction",value:function(e){console.log("i",e)}},{key:"finalSubmit",value:function(e,t){var o=this;console.log(t);for(var a=0,r=0;r<t.excelMappingDetails.length;r++)console.log(t.excelMappingDetails[r].mandatory),1==t.excelMappingDetails[r].mandatory&&(console.log("Inside If"),a+=1),console.log(a);if(a<2)console.log("More than 2 rows"),m().fire({text:"Add atleast two mininum rows with mandatory condition",icon:"info"});else{e.extSys=this.extNameValue,this.submitted=!0,t.excelMappingDetails[0].modifiedBy=this.currentUser;var i=Object.assign(Object.assign({},e),t);this.apiService.createTemplateMap(i).subscribe(function(e){if(o.dataFromresponse=e,console.log("this.dataFromresponse",o.dataFromresponse),o.dataFromresponse)return o.is_edit=!0,console.log("sucess"),o.auditLog(),m().fire({title:"Mapped Successfully!",icon:"success"}),void(o.editFlag=!0);m().fire({title:"Mapping Failed!",icon:"error"})},function(e){m().fire({text:e.error.message,icon:"error"})})}}},{key:"enableEditFlag",value:function(){this.editFlag=!1,this.showUpdate=!0}},{key:"canExit",value:function(){var e=this,t=!1;return this.excelMappingForm.touched&&1==this.formTouched?m().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){return!0===o.isConfirmed?(t=!0,e.cdr.markForCheck(),t):(t=!1,e.cdr.markForCheck(),t)}):(t=!0,new Promise(function(o,a){!0===t&&(t=!0,e.cdr.markForCheck(),o(!0))}))}},{key:"onClickOfReopen",value:function(e,t){var o=this;this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.currentUser=this.dataFromresponse.inputBy,m().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){console.log("this is reopen ",e),!0===e.isConfirmed&&o.apiService.excelMappingAuditLog(o.dataFromresponse,"reopen").subscribe(function(e){var t,a,r,i,n,s,l;console.log(e),o.dataFromresponse=e,o.dataFromresponse?(o.authStatus=null===(t=o.dataFromresponse)||void 0===t?void 0:t.authStatus,o.recordStatus=null===(a=o.dataFromresponse)||void 0===a?void 0:a.recordStatus,o.modifiedBy=null===(r=o.dataFromresponse)||void 0===r?void 0:r.inputBy,o.modifiedTime=null===(i=o.dataFromresponse)||void 0===i?void 0:i.inputDtStamp,o.authorizedBy=null===(n=o.dataFromresponse)||void 0===n?void 0:n.authorizedBy,o.authorizedTime=null===(s=o.dataFromresponse)||void 0===s?void 0:s.authorizedTime,o.version=null===(l=o.dataFromresponse)||void 0===l?void 0:l.version,"U"===o.authStatus&&(o.authStatus="UNAUTHORIZED"),"A"===o.authStatus&&(o.authStatus="AUTHORIZED"),"C"===o.recordStatus&&(o.recordStatus="CLOSED"),"O"===o.recordStatus&&(o.recordStatus="OPEN"),m().fire({title:"Record is Reopened",icon:"success"}),o.auditLog()):m().fire({title:"Failed to Reopen the Record!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"onClickOfDelete",value:function(e,t){var o=this;console.log(this.dataFromresponse),m().fire({text:"You are trying to delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){!0===e.isConfirmed&&o.apiService.deleteTemplateMapping(o.dataFromresponse.extSys,o.dataFromresponse.processName,o.dataFromresponse.currency,o.dataFromresponse.sheetNumber).subscribe(function(e){1==e?m().fire({title:"Record is Closed",icon:"success"}).then(function(e){o.router.navigateByUrl("/excel-mapping")}):m().fire({title:"Failed to Delete the Recored!",icon:"error"})})})}},{key:"onClickOfClose",value:function(e,t){var o=this;console.log(this.dataFromresponse),m().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(e){!0===e.isConfirmed&&o.apiService.excelMappingAuditLog(o.dataFromresponse,"close").subscribe(function(e){var t,a,r,i,n,s,l;console.log(e),o.dataFromresponse=e,o.dataFromresponse?(o.authStatus=null===(t=o.dataFromresponse)||void 0===t?void 0:t.authStatus,o.recordStatus=null===(a=o.dataFromresponse)||void 0===a?void 0:a.recordStatus,o.modifiedBy=null===(r=o.dataFromresponse)||void 0===r?void 0:r.inputBy,o.modifiedTime=null===(i=o.dataFromresponse)||void 0===i?void 0:i.inputDtStamp,o.authorizedBy=null===(n=o.dataFromresponse)||void 0===n?void 0:n.authorizedBy,o.authorizedTime=null===(s=o.dataFromresponse)||void 0===s?void 0:s.authorizedTime,o.version=null===(l=o.dataFromresponse)||void 0===l?void 0:l.version,"U"===o.authStatus&&(o.authStatus="UNAUTHORIZED"),"A"===o.authStatus&&(o.authStatus="AUTHORIZED"),"C"===o.recordStatus&&(o.recordStatus="CLOSED"),"O"===o.recordStatus&&(o.recordStatus="OPEN"),m().fire({title:"Record is Closed",icon:"success"}),o.auditLog()):m().fire({title:"Failed to Close the Recored!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"updateMappingData",value:function(e,t){var o=this;this.submitted=!0,this.progress=!0;e.excelMappingDetails[0].modifiedBy;this.currentUser,e.excelMappingDetails[0].excelMappingColumn=e.excelMappingDetails[0].mappingColumn;var a=Object.assign(Object.assign({},t),e);this.addForm.invalid?m().fire({text:"Numeric values not allowed in mapping column!",icon:"warning"}):this.apiService.createTemplateMap(a).subscribe(function(e){o.dataFromresponse=e,console.log(o.dataFromresponse),o.dataFromresponse?(o.editFlag=!1,o.dataSaved=!0,m().fire({text:"Record is Updated!",icon:"success"}),o.formTouched=!o.excelMappingForm.touched,o.cdr.markForCheck()):m().fire({text:"Failed to update ",icon:"error"})})}},{key:"onClickOfAuth",value:function(e,t){var o;this.currentUser=localStorage.getItem("userFromLogin"),console.log("this.currentUser",this.currentUser,e,t),this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.modifiedBy=null===(o=this.dataFromresponse[0])||void 0===o?void 0:o.modifiedBy,this.modifiedBy===this.currentUser&&m().fire({title:"Maker Cannot Authorized the Record!",icon:"error"})}},{key:"letterOnly",value:function(e){var t=e.keyCode;return t>64&&t<91||t>96&&t<123||8==t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(f.sM),h.Y36(c.qu),h.Y36(v.k),h.Y36(s.F0),h.Y36(h.sBO),h.Y36(l.I))},e.\u0275cmp=h.Xpm({type:e,selectors:[["npr-excel-mapping-new"]],decls:99,vars:26,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],[1,"col-auto"],["href","excel-mapping-new.html","routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLink"],["href","javascript:void(0)","routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["action","",1,"formStyle",3,"formGroup"],[1,"row","gy-4","align-items-end"],[1,"col-lg-4"],["for","extSystem",1,"formLbl"],[1,"colorRed"],["id","outlineNgSelect","formControlName","extSysCode","required","","aria-label","Default select example",1,"form-select",2,"width","200px",3,"change"],["hidden","","value","","disabled","","selected",""],["class","form-class",3,"value",4,"ngFor","ngForOf"],["for","processName",1,"formLbl"],["class","form-select","formControlName","processName","required","","aria-label","Default select example",3,"change",4,"ngIf"],["type","text","formControlName","processName","required","","class","form-control","placeholder","Process Code","value","",3,"readonly",4,"ngIf"],["for","startingRow",1,"formLbl"],["id","startingRow","type","number","formControlName","startingRow","required","","placeholder","Data Starting Row","value","",1,"form-control",3,"readonly"],["for","currency",1,"formLbl"],["id","currency","type","text","formControlName","currency","name","currency","required","","placeholder","Currency","value","","minlength","1","maxlength","3","onkeydown","/[A-Z]/i.test(event.key)","oninput","this.value = this.value.toUpperCase()",1,"form-control",3,"readonly","keypress"],["for","sheetNumber",1,"formLbl"],["id","sheetNumber","type","number","formControlName","sheetNumber","placeholder","Sheet Number","value","",1,"form-control",3,"readonly"],[1,"checkStyle"],["type","checkbox","id","fcyRate","formControlName","headerRepeated"],["for","fcyRate"],["action","","novalidate","",1,"formStyle",3,"formGroup"],[1,"titleStyle","mt-2","mb-4"],[1,"pageTitle","darkgreyClr"],[1,"table-responsive"],["id","dbTable1",1,"table","tableStyle1","responsive","nowrap","vAlignMdl"],["formArrayName","excelMappingDetails"],[4,"ngFor","ngForOf"],["class","addIcon primarybg",3,"click",4,"ngIf"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],["class","col-auto",4,"ngIf"],["routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["class","dbCardStyle",4,"ngIf"],[1,"form-class",3,"value"],["formControlName","processName","required","","aria-label","Default select example",1,"form-select",3,"change"],["type","text","formControlName","processName","required","","placeholder","Process Code","value","",1,"form-control",3,"readonly"],[3,"formGroupName"],["id","sourceCode","type","text","formControlName","columnnName","placeholder","Name","value","",1,"form-control",3,"readonly"],["formControlName","dataType","placeholder","Choose DataType","aria-label","Default select example",1,"form-select",3,"change"],[1,"checkboxdiv"],["type","checkbox","formControlName","mandatory",3,"id"],[3,"for"],["type","text","formControlName","headerName","placeholder","Header Name","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","dateFormat","placeholder","Date Format","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","excelMappingColumn","placeholder","Mapping Column","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","delimeter","placeholder","Delimeter","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","defaultValue","placeholder","Default Value","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","repeatedTillNextValue","placeholder","Repeated Till Next Value","value","",1,"form-control",3,"id","readonly"],["class","deleteIcon2",4,"ngIf"],[1,"deleteIcon2"],[3,"click"],["src","assets/images/delete-icon.svg","alt","..."],[1,"addIcon","primarybg",3,"click"],["src","assets/images/plus-icon.svg","alt","..."],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnAuth",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["cclass","btn smBtn minWdSmBtn btnPrimary","color","primary",3,"click"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/first-auth-icon.svg","alt","..."]],template:function(e,t){1&e&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"h2",2),h._uU(3,"Template Mapping"),h.qZA(),h.qZA(),h.TgZ(4,"div",3),h.TgZ(5,"div",4),h.TgZ(6,"div",5),h.TgZ(7,"a",6),h._uU(8,"Update Mapping"),h.qZA(),h.qZA(),h.TgZ(9,"div",5),h.TgZ(10,"a",7),h._uU(11,"Exit"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(12,"form",8),h.TgZ(13,"div",9),h.TgZ(14,"div",10),h.TgZ(15,"label",11),h._uU(16,"External System Code"),h.TgZ(17,"span",12),h._uU(18,"*"),h.qZA(),h.qZA(),h.TgZ(19,"ng-select",13),h.NdJ("change",function(){return t.getProcess(t.excelMappingForm.get("extSysCode").value)}),h.TgZ(20,"ng-option",14),h._uU(21,"Please select External System"),h.qZA(),h.YNc(22,H,2,2,"ng-option",15),h.qZA(),h.qZA(),h.TgZ(23,"div",10),h.TgZ(24,"label",16),h._uU(25,"Process Code"),h.TgZ(26,"span",12),h._uU(27,"*"),h.qZA(),h.qZA(),h.YNc(28,j,4,2,"select",17),h.YNc(29,W,1,1,"input",18),h.qZA(),h.TgZ(30,"div",10),h.TgZ(31,"label",19),h._uU(32,"Data Starting Row"),h.TgZ(33,"span",12),h._uU(34,"*"),h.qZA(),h.qZA(),h._UZ(35,"input",20),h.qZA(),h.TgZ(36,"div",10),h.TgZ(37,"label",21),h._uU(38,"Currency"),h.TgZ(39,"span",12),h._uU(40,"*"),h.qZA(),h.qZA(),h.TgZ(41,"input",22),h.NdJ("keypress",function(e){return t.letterOnly(e)}),h.qZA(),h.qZA(),h.TgZ(42,"div",10),h.TgZ(43,"label",23),h._uU(44,"Sheet Number"),h.TgZ(45,"span",12),h._uU(46,"*"),h.qZA(),h.qZA(),h._UZ(47,"input",24),h.qZA(),h.TgZ(48,"div",10),h.TgZ(49,"div",25),h._UZ(50,"input",26),h.TgZ(51,"label",27),h._uU(52,"Is Header Present"),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(53,"div",3),h.TgZ(54,"form",28),h.TgZ(55,"div",29),h.TgZ(56,"h2",30),h._uU(57,"Select Minimum two mandatory row"),h.qZA(),h.qZA(),h.TgZ(58,"div",31),h.TgZ(59,"table",32),h.TgZ(60,"thead"),h.TgZ(61,"tr"),h.TgZ(62,"th"),h._uU(63,"Name"),h.qZA(),h.TgZ(64,"th"),h._uU(65,"data type"),h.qZA(),h.TgZ(66,"th"),h._uU(67,"mandatory"),h.qZA(),h.TgZ(68,"th"),h._uU(69,"header name"),h.qZA(),h.TgZ(70,"th"),h._uU(71,"date format"),h.qZA(),h.TgZ(72,"th"),h._uU(73,"mapping column"),h.qZA(),h.TgZ(74,"th"),h._uU(75,"delimeter"),h.qZA(),h.TgZ(76,"th"),h._uU(77,"default value"),h.qZA(),h.TgZ(78,"th"),h._uU(79,"repeated till next value"),h.qZA(),h.TgZ(80,"th"),h._uU(81,"delete"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(82,"tbody",33),h.YNc(83,K,28,19,"tr",34),h.TgZ(84,"tr"),h.TgZ(85,"td"),h.YNc(86,ee,3,0,"a",35),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.TgZ(87,"div",36),h.YNc(88,te,3,1,"div",37),h.YNc(89,oe,3,0,"div",37),h.YNc(90,ae,3,0,"div",37),h.YNc(91,re,3,0,"div",37),h.YNc(92,ie,3,0,"div",37),h.YNc(93,ne,3,0,"div",37),h.YNc(94,se,3,2,"div",37),h.TgZ(95,"div",5),h.TgZ(96,"a",38),h._uU(97,"Exit"),h.qZA(),h.qZA(),h.qZA(),h.YNc(98,le,100,14,"div",39),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.xp6(7),h.Q6J("routerLink",h.DdM(23,ue)),h.xp6(3),h.Q6J("routerLink",h.DdM(24,ce)),h.xp6(2),h.Q6J("formGroup",t.excelMappingForm),h.xp6(7),h.uIk("disabled",t.editFlag?"":null),h.xp6(3),h.Q6J("ngForOf",t.extSysData),h.xp6(6),h.Q6J("ngIf","select"===t.processNameField),h.xp6(1),h.Q6J("ngIf","text"===t.processNameField),h.xp6(6),h.Q6J("readonly",t.editFlag),h.xp6(6),h.Q6J("readonly",t.editFlag),h.xp6(6),h.Q6J("readonly",t.editFlag),h.xp6(3),h.uIk("disabled",!!t.editFlag||null),h.xp6(4),h.Q6J("formGroup",t.addForm),h.xp6(29),h.Q6J("ngForOf",t.addForm.get("excelMappingDetails").controls),h.xp6(3),h.Q6J("ngIf",!t.editFlag),h.xp6(2),h.Q6J("ngIf",t.showUpdate),h.xp6(1),h.Q6J("ngIf",t.dataFromresponse&&!t.showUpdate),h.xp6(1),h.Q6J("ngIf",t.dataFromresponse&&("U"==t.dataFromresponse.authStatus||"UNAUTHORIZED"==t.dataFromresponse.authStatus)&&!t.showUpdate),h.xp6(1),h.Q6J("ngIf",t.dataFromresponse&&("N"==t.dataFromresponse.firstTimeAuth||"NO"==t.dataFromresponse.firstTimeAuth)&&("O"==t.dataFromresponse.recordStatus||"OPEN"==t.dataFromresponse.recordStatus)&&!t.showUpdate),h.xp6(1),h.Q6J("ngIf",t.dataFromresponse&&("O"==t.dataFromresponse.recordStatus||"OPEN"==t.dataFromresponse.recordStatus)&&("Y"==t.dataFromresponse.firstTimeAuth||"YES"==t.dataFromresponse.firstTimeAuth)&&!t.showUpdate),h.xp6(1),h.Q6J("ngIf",t.dataFromresponse&&("C"==t.dataFromresponse.recordStatus||"CLOSED"==t.dataFromresponse.recordStatus)&&("Y"==t.dataFromresponse.firstTimeAuth||"YES"==t.dataFromresponse.firstTimeAuth)&&!t.showUpdate),h.xp6(1),h.Q6J("ngIf",!t.dataFromresponse),h.xp6(2),h.Q6J("routerLink",h.DdM(25,de)),h.xp6(2),h.Q6J("ngIf",t.dataFromresponse))},directives:[s.yS,s.Od,c._Y,c.JL,c.sg,V.w9,c.JJ,c.u,c.Q7,V.jq,n.sg,n.O5,c.wV,c.Fj,c.wO,c.nD,c.Wl,c.CE,c.EJ,c.YN,c.Kr,c.x0],pipes:[n.uU],styles:[".form-class[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#797979;background-color:#fff;background-clip:padding-box;border-bottom:1px solid #ebebeb;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;-webkit-appearance:none;-moz-appearance:none;appearance:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}table.tableStyle1[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:10px;text-transform:uppercase;border-bottom:1px solid #F5F5F5}.form-control1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:10px;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control1[_ngcontent-%COMP%]:disabled, .form-control1[readonly][_ngcontent-%COMP%]{background-color:#fff;opacity:1}.checkboxdiv[_ngcontent-%COMP%]{padding-left:25px;padding-bottom:15px;cursor:pointer}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;pointer-events:all!important}.madatoryLabel[_ngcontent-%COMP%]{display:none}"]}),e}(),ge=i(17988),me=function(){return["/excel-mapping/excel-mapping-new"]};function he(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"a",12),h._uU(2),h.qZA(),h.qZA()),2&e){var o=h.oxw();h.xp6(1),h.Q6J("routerLink",h.DdM(2,me)),h.xp6(1),h.Oqu(o.roleCodes.new.labelDescription)}}function fe(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"button",19),h.NdJ("click",function(){h.CHM(o);var e=h.oxw().$implicit;return h.oxw().close(e)}),h._UZ(1,"img",20),h.qZA()}}function ve(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"button",21),h.NdJ("click",function(){h.CHM(o);var e=h.oxw().$implicit;return h.oxw().open(e)}),h._UZ(1,"img",22),h.qZA()}}function Ze(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"button",23),h.NdJ("click",function(){h.CHM(o);var e=h.oxw().$implicit;return h.oxw().delete(e)}),h._UZ(1,"img",24),h.qZA()}}function ye(e,t){if(1&e){var o=h.EpF();h.TgZ(0,"tr"),h.TgZ(1,"td"),h.TgZ(2,"a",13),h.NdJ("click",function(){var e=h.CHM(o).$implicit;return h.oxw().setDataFromSummaryToUpdateExcelMapping(e)}),h._uU(3),h.qZA(),h.qZA(),h.TgZ(4,"td"),h._uU(5),h.qZA(),h.TgZ(6,"td"),h._uU(7),h.qZA(),h.TgZ(8,"td"),h._uU(9),h.qZA(),h.TgZ(10,"td"),h._uU(11),h.qZA(),h.TgZ(12,"td"),h._uU(13),h.qZA(),h.TgZ(14,"td"),h._uU(15),h.qZA(),h.TgZ(16,"td"),h._uU(17),h.ALo(18,"date"),h.qZA(),h.TgZ(19,"td"),h.TgZ(20,"button",14),h.NdJ("click",function(){var e=h.CHM(o).$implicit;return h.oxw().auth(e)}),h._UZ(21,"img",15),h.qZA(),h.YNc(22,fe,2,0,"button",16),h.YNc(23,ve,2,0,"button",17),h.YNc(24,Ze,2,0,"button",18),h.qZA(),h.qZA()}if(2&e){var a=t.$implicit;h.xp6(3),h.Oqu(a.processName),h.xp6(2),h.Oqu(a.extSysCode),h.xp6(2),h.Oqu(a.extSys),h.xp6(2),h.Oqu(a.currency),h.xp6(2),h.Oqu(a.sheetNumber),h.xp6(2),h.Oqu(a.authStatus),h.xp6(2),h.Oqu(a.recordStatus),h.xp6(2),h.Oqu(h.xi3(18,12,a.inputDtStamp,"medium")),h.xp6(3),h.Q6J("disabled",!("U"==a.authStatus||"UNAUTHORIZED"==a.authStatus||"Unauthorized"==a.authStatus)),h.xp6(2),h.Q6J("ngIf","O"==a.recordStatus||"Open"==a.recordStatus||"OPEN"==a.recordStatus),h.xp6(1),h.Q6J("ngIf","C"==a.recordStatus||"CLOSED"==a.recordStatus||"Close"==a.recordStatus),h.xp6(1),h.Q6J("ngIf","N"==a.firstTimeAuth||"NO"==a.firstTimeAuth)}}function xe(e,t){1&e&&(h.ynx(0),h.TgZ(1,"div",25),h.TgZ(2,"span",26),h._uU(3,"Please wait... "),h._UZ(4,"span",27),h.qZA(),h.qZA(),h.BQk())}var Ae=function(){return["/dashboard"]},Te=[{path:"",component:function(){var t=function(){function t(e,a,r,i){o(this,t),this.apiService=e,this.roleService=a,this.toastService=r,this.router=i,this.dtOptions={},this.dtTrigger=new d.xQ,this.isLoading=!1,this.roleCodes=new p.yv,this.statusArr=["Authorized","Unauthorized","Open","Close"]}return r(t,[{key:"ngOnInit",value:function(){var e=this;this.dtOptions={pagingType:"full_numbers",pageLength:5,columnDefs:[{type:"date",targets:[7]}],order:[[7,"desc"]],processing:!0,lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]]},this.currentUser=localStorage.getItem("userFromLogin"),this.getexcelMappingSummary(),this.roleService.fetchScreenPermissions("Template Mapping"),this.roleService.screenLabelList.subscribe(function(t){return e.roleCodes=t}),console.log(this.roleCodes)}},{key:"auditLog",value:function(){("U"==this.excelMappingSummary.authStatus||"Unauthorized"==this.excelMappingSummary.authStatus)&&(this.excelMappingSummary.authStatus="UNAUTHORIZED"),("A"==this.excelMappingSummary.authStatus||"Authorized"==this.excelMappingSummary.authStatus)&&(this.excelMappingSummary.authStatus="AUTHORIZED"),"O"==this.excelMappingSummary.recordStatus&&(this.excelMappingSummary.recordStatus="OPEN"),"C"==this.excelMappingSummary.recordStatus&&(this.excelMappingSummary.recordStatus="CLOSED"),"N"==this.excelMappingSummary.verifiedOnce&&(console.log("NO"),this.excelMappingSummary.verifiedOnce="NO"),"Y"==this.excelMappingSummary.verifiedOnce&&(this.excelMappingSummary.verifiedOnce="YES")}},{key:"getexcelMappingSummary",value:function(){var t=this;this.isLoading=!0,this.apiService.getMappingSummary().subscribe(function(o){console.log(o),t.mappingResponse=o;var a,r=e(o.result);try{var i=function(){var e=a.value;e.authStatus=t.statusArr.find(function(t){return t.startsWith(e.authStatus)}),e.recordStatus=t.statusArr.find(function(t){return t.startsWith(e.recordStatus)})};for(r.s();!(a=r.n()).done;)i()}catch(n){r.e(n)}finally{r.f()}t.excelData=o.result,console.log(t.excelData),t.isLoading=!1,t.dtTrigger.next()})}},{key:"close",value:function(e){var t=this;console.log(e),m().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.apiService.excelMappingAuditLog(e,"close").subscribe(function(e){var o,a,r,i,n,s,l;console.log(e),t.newDataResponse=e,t.newDataResponse?(t.authStatus=null===(o=t.newDataResponse)||void 0===o?void 0:o.authStatus,t.recordStatus=null===(a=t.newDataResponse)||void 0===a?void 0:a.recordStatus,t.modifiedBy=null===(r=t.newDataResponse)||void 0===r?void 0:r.inputBy,t.modifiedTime=null===(i=t.newDataResponse)||void 0===i?void 0:i.inputDtStamp,t.authorizedBy=null===(n=t.newDataResponse)||void 0===n?void 0:n.authorizedBy,t.authorizedTime=null===(s=t.newDataResponse)||void 0===s?void 0:s.authorizedTime,t.version=null===(l=t.newDataResponse)||void 0===l?void 0:l.version,"U"===t.authStatus&&(t.authStatus="UNAUTHORIZED"),"A"===t.authStatus&&(t.authStatus="AUTHORIZED"),"C"===t.recordStatus&&(t.recordStatus="CLOSED"),"O"===t.recordStatus&&(t.recordStatus="OPEN"),m().fire({title:"Record is  Closed",icon:"success"}).then(function(){return window.location.reload()}),t.auditLog()):m().fire({title:"Failed to Close the Recored!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"open",value:function(e){var t=this;m().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){console.log("this is reopen ",o),!0===o.isConfirmed&&t.apiService.excelMappingAuditLog(e,"reopen").subscribe(function(e){var o,a,r,i,n,s,l;console.log(e),t.newDataResponse=e,t.newDataResponse?(t.authStatus=null===(o=t.newDataResponse)||void 0===o?void 0:o.authStatus,t.recordStatus=null===(a=t.newDataResponse)||void 0===a?void 0:a.recordStatus,t.modifiedBy=null===(r=t.newDataResponse)||void 0===r?void 0:r.inputBy,t.modifiedTime=null===(i=t.newDataResponse)||void 0===i?void 0:i.inputDtStamp,t.authorizedBy=null===(n=t.newDataResponse)||void 0===n?void 0:n.authorizedBy,t.authorizedTime=null===(s=t.newDataResponse)||void 0===s?void 0:s.authorizedTime,t.version=null===(l=t.newDataResponse)||void 0===l?void 0:l.version,"U"===t.authStatus&&(t.authStatus="UNAUTHORIZED"),"A"===t.authStatus&&(t.authStatus="AUTHORIZED"),"C"===t.recordStatus&&(t.recordStatus="CLOSED"),"O"===t.recordStatus&&(t.recordStatus="OPEN"),m().fire({title:"Record is Reopened",icon:"success"}).then(function(){return window.location.reload()}),t.auditLog()):m().fire({title:"Failed to Reopen the Record!",icon:"error"})},function(e){u.UA&&m().fire({text:"Server Error!",icon:"error"})})})}},{key:"delete",value:function(e){console.log(e)}},{key:"auth",value:function(e){var t=this;console.log(e),this.currentUser=localStorage.getItem("userFromLogin"),this.modifiedBy===this.currentUser?m().fire({title:"Maker Cannot Authorized the Record!",icon:"error"}):m().fire({text:"You are trying to Authorize the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.apiService.excelMappingAuditLog(e,"authorize").subscribe(function(e){var o,a,r,i,n,s,l,u;t.newDataResponse=e,t.newDataResponse&&(t.authStatus=null===(o=t.newDataResponse)||void 0===o?void 0:o.authStatus,t.recordStatus=null===(a=t.newDataResponse)||void 0===a?void 0:a.recordStatus,t.modifiedTime=null===(r=t.newDataResponse)||void 0===r?void 0:r.inputDtStamp,t.authorizedBy=null===(i=t.newDataResponse)||void 0===i?void 0:i.authorizedBy,t.authorizedTime=null===(n=t.newDataResponse)||void 0===n?void 0:n.authorizedDtStamp,t.version=null===(s=t.newDataResponse)||void 0===s?void 0:s.version,t.firstTimeAuth=null===(l=t.newDataResponse)||void 0===l?void 0:l.firstTimeAuth,t.modifiedBy=null===(u=t.newDataResponse)||void 0===u?void 0:u.inputBy,"U"===t.authStatus&&(t.authStatus="UNAUTHORIZED"),"A"===t.authStatus&&(t.authStatus="AUTHORIZED"),"C"===t.recordStatus&&(t.recordStatus="CLOSED"),"O"===t.recordStatus&&(t.recordStatus="OPEN"),"Y"===t.firstTimeAuth&&(t.firstTimeAuth="YES"),"N"===t.firstTimeAuth&&(t.firstTimeAuth="NO"),m().fire({title:"Record is Authorized",icon:"success"}).then(function(){return window.location.reload()}))})})}},{key:"setDataFromSummaryToUpdateExcelMapping",value:function(e){localStorage.setItem("summryResponse",JSON.stringify(e)),this.apiService.setexcelSummaryData({extSysCode:e.extSysCode,extSys:e.extSys,processName:e.processName,authStatus:e.authStatus,currency:e.currency,sheetNumber:e.sheetNumber}),this.router.navigate(["/excel-mapping/excel-mapping-edit"])}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(f.sM),h.Y36(Z.N),h.Y36(v.k),h.Y36(s.F0))},t.\u0275cmp=h.Xpm({type:t,selectors:[["npr-excel-mapping"]],decls:35,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],["class","col-auto",4,"ngIf"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],[1,"table-responsive"],["id","dbTable1","datatable","",1,"dataTable","table","tableStyle","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLink"],[1,"primaryColor",2,"cursor","pointer",3,"click"],["title","Authorize",1,"btn",2,"color","red",3,"disabled","click"],["src","assets/images/authorize.svg","alt","Authorize",1,"summaryIcon"],["class","btn","style","color: red","title","Close",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Reopen",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Delete",3,"click",4,"ngIf"],["title","Close",1,"btn",2,"color","red",3,"click"],["src","assets/images/CROSS1.svg","alt","...",1,"summaryIcon"],["title","Reopen",1,"btn",2,"color","red",3,"click"],["src","assets/images/open.svg","alt","...",1,"summaryIcon"],["title","Delete",1,"btn",2,"color","red",3,"click"],["src","assets/images/delete.svg","alt","...",1,"summaryIcon"],[1,"loading-page-center"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(e,t){1&e&&(h.TgZ(0,"div",0),h.TgZ(1,"div",1),h.TgZ(2,"h2",2),h._uU(3,"Template Mapping Summary"),h.qZA(),h.qZA(),h.TgZ(4,"div",3),h.TgZ(5,"div",4),h.YNc(6,he,3,3,"div",5),h.TgZ(7,"div",6),h.TgZ(8,"a",7),h._uU(9,"Exit"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(10,"div",8),h.TgZ(11,"table",9),h.TgZ(12,"thead"),h.TgZ(13,"tr"),h.TgZ(14,"th"),h._uU(15,"Process Code"),h.qZA(),h.TgZ(16,"th"),h._uU(17,"External System Code"),h.qZA(),h.TgZ(18,"th"),h._uU(19,"External system name"),h.qZA(),h.TgZ(20,"th"),h._uU(21,"Currency"),h.qZA(),h.TgZ(22,"th"),h._uU(23,"Sheet Number"),h.qZA(),h.TgZ(24,"th"),h._uU(25,"Auth status"),h.qZA(),h.TgZ(26,"th"),h._uU(27,"Record status"),h.qZA(),h.TgZ(28,"th"),h._uU(29,"Date"),h.qZA(),h.TgZ(30,"th"),h._uU(31,"Action"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(32,"tbody"),h.YNc(33,ye,25,15,"tr",10),h.qZA(),h.qZA(),h.qZA(),h.YNc(34,xe,5,0,"ng-container",11),h.qZA(),h.qZA()),2&e&&(h.xp6(6),h.Q6J("ngIf",t.roleCodes.new),h.xp6(2),h.Q6J("routerLink",h.DdM(6,Ae)),h.xp6(3),h.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),h.xp6(22),h.Q6J("ngForOf",t.excelData),h.xp6(1),h.Q6J("ngIf",t.isLoading))},directives:[n.O5,s.yS,ge.G,n.sg],pipes:[n.uU],styles:[".overflow[_ngcontent-%COMP%]{overflow:auto}table.tableStyle[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:9px;text-transform:uppercase;letter-spacing:1px;padding:16px 13px;border-bottom:1px solid #F5F5F5}"]}),t}()},{path:"excel-mapping-new",component:pe,canDeactivate:[l.I]},{path:"excel-mapping-edit",component:z,canDeactivate:[l.I]}],Se=function(){var e=r(function e(){o(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[s.Bz.forChild(Te)],s.Bz]}),e}(),be=function(){var e=r(function e(){o(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.oAB({type:e}),e.\u0275inj=h.cJS({imports:[[n.ez,Se,ge.T,c.u5,c.UX,V.A0]]}),e}()}}])}();