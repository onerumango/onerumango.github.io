"use strict";(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[193],{17988:function(t,e,i){i.d(e,{G:function(){return r},T:function(){return a}});var n=i(37716),r=function(){function t(t,e,i){this.el=t,this.vcr=e,this.renderer=i,this.dtOptions={}}return t.prototype.ngOnInit=function(){var t=this;this.dtTrigger?this.dtTrigger.subscribe(function(e){t.displayTable(e)}):this.displayTable(null)},t.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},t.prototype.displayTable=function(t){var e=this;t&&(this.dtOptions=t),this.dtInstance=new Promise(function(t,i){Promise.resolve(e.dtOptions).then(function(n){0===Object.keys(n).length&&0===$("tbody tr",e.el.nativeElement).length?i("Both the table and dtOptions cannot be empty"):setTimeout(function(){var i={rowCallback:function(t,i,r){if(n.columns){var s=n.columns;e.applyNgPipeTransform(t,s),e.applyNgRefTemplate(t,s,i)}n.rowCallback&&n.rowCallback(t,i,r)}};i=Object.assign({},n,i),e.dt=$(e.el.nativeElement).DataTable(i),t(e.dt)})})})},t.prototype.applyNgPipeTransform=function(t,e){e.filter(function(t){return t.ngPipeInstance&&!t.ngTemplateRef}).forEach(function(i){var n=i.ngPipeInstance,r=e.findIndex(function(t){return t.data===i.data}),s=t.childNodes.item(r),a=$(s).text(),o=n.transform(a);$(s).text(o)})},t.prototype.applyNgRefTemplate=function(t,e,i){var n=this;e.filter(function(t){return t.ngTemplateRef&&!t.ngPipeInstance}).forEach(function(r){var s=r.ngTemplateRef,a=s.ref,o=s.context,l=e.findIndex(function(t){return t.data===r.data}),d=t.childNodes.item(l);$(d).html("");var u=Object.assign({},o,null==o?void 0:o.userData,{adtData:i}),c=n.vcr.createEmbeddedView(a,u);n.renderer.appendChild(d,c.rootNodes[0])})},t.\u0275fac=function(e){return new(e||t)(n.Y36(n.SBq),n.Y36(n.s_b),n.Y36(n.Qsj))},t.\u0275dir=n.lG2({type:t,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),t}(),s=i(38583),a=function(){function t(){}return t.forRoot=function(){return{ngModule:t}},t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[s.ez]]}),t}()},1193:function(t,e,i){i.r(e),i.d(e,{AuthorizeModificationModule:function(){return _}});var n=i(38583),r=i(39895),s=i(3679);class a{}var o=i(27721),l=i(91841),d=i(92803),u=i(17283),c=i(79765),h=i(88259),g=i.n(h),p=i(37716),A=i(94761),T=i(59119),f=i(58219),m=i(17988);function D(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"button",11),p.NdJ("click",function(){const e=p.CHM(t),i=e.$implicit,n=e.index;return p.oxw().queryDetailsDataByParam(i,n)}),p._uU(3," Get Details "),p.qZA(),p.qZA(),p.TgZ(4,"td"),p._uU(5),p.qZA(),p.TgZ(6,"td"),p._uU(7),p.qZA(),p.TgZ(8,"td"),p._uU(9),p.qZA(),p.TgZ(10,"td"),p._uU(11),p.ALo(12,"date"),p.qZA(),p.TgZ(13,"td"),p._uU(14),p.qZA(),p.TgZ(15,"td"),p._uU(16),p.qZA(),p.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=p.oxw();p.xp6(2),p.s9C("id","btnGetDetails"+i),p.xp6(3),p.Oqu(null==t?null:t.externalSysName),p.xp6(2),p.Oqu(null==t?null:t.batchNumber),p.xp6(2),p.Oqu(null==t?null:t.processName),p.xp6(2),p.Oqu(p.xi3(12,7,null==t?null:t.processingDate,"medium")),p.xp6(3),p.Oqu(n.extractFilename(null==t?null:t.fileName)),p.xp6(2),p.Oqu(null==t?null:t.currency)}}function Z(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",13),p.NdJ("click",function(){p.CHM(t);const e=p.oxw().$implicit;return p.oxw().viewOperation(e)}),p._uU(1," View "),p.qZA()}}function b(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.TgZ(13,"td"),p._uU(14),p.qZA(),p.TgZ(15,"td"),p._uU(16),p.qZA(),p.TgZ(17,"td"),p._uU(18),p.qZA(),p.TgZ(19,"td"),p._uU(20),p.qZA(),p.TgZ(21,"td"),p.YNc(22,Z,2,0,"button",12),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(null==t?null:t.account),p.xp6(2),p.Oqu(null==t?null:t.ccyCd),p.xp6(2),p.Oqu(null==t?null:t.branchCode),p.xp6(2),p.Oqu(null==t?null:t.amount),p.xp6(2),p.Oqu(null==t?null:t.lcyEquivalent),p.xp6(2),p.Oqu(null==t?null:t.drCr),p.xp6(2),p.Oqu(null==t?null:t.exchRate),p.xp6(2),p.Oqu(null==t?null:t.relatedAccount),p.xp6(2),p.Oqu(null==t?null:t.addlText),p.xp6(2),p.Oqu(null==t?null:t.acumenJournal),p.xp6(2),p.Q6J("ngIf",t.versionNo>=1)}}function y(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",14),p.NdJ("click",function(){return p.CHM(t),p.oxw().approveSecondLevel()}),p._uU(1," Approve Data "),p.qZA()}}const q=[{path:"",component:(()=>{class t{constructor(t,e,i){this.api=t,this.userApi=e,this.excelService=i,this.respArray=[],this.dtOptions={},this.dtTrigger1=new c.xQ,this.dtTrigger2=new c.xQ,this.pendingForAuthData=[],this.pendingForAuthDetailsListAll=[],this.excelDataAuthSecondAuditlog=new d.n,this.pipe=new n.uU("en-US"),this.firstAndSecondAuthAuditLogRespDTO=new u.U,this.name=new s.NI(""),this.button_permission={},this.now=Date.now(),this.dataForProcessScreen1=[]}ngOnInit(){this.firstLevelAuthorizationStatus={},this.user_id=sessionStorage.getItem("user_id"),this.role=sessionStorage.getItem("user_role"),this.getPendingForAuthData(),this.dtOptions[0]={pagingType:"full_numbers",pageLength:5,columnDefs:[{type:"date",targets:[4]}],order:[[4,"desc"]],processing:!0,lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]],retrieve:!0},this.dtOptions[1]={pagingType:"full_numbers",pageLength:5,processing:!0,retrieve:!0,lengthMenu:[[5,10,20,-1],[5,10,20,30]]}}ngOnDestroy(){this.dtTrigger1.unsubscribe(),this.dtTrigger2.unsubscribe()}screenpermission(){this.screenName="DataAmendAuthorization",this.userApi.getRoleScreenPermission(this.user_id,this.screenName,this.role).subscribe(t=>{this.rolepermission=t,console.log(this.rolepermission),this.rolepermission&&(this.button_permission=this.rolepermission[0])})}extractFilename(t){const e=t.split("/");return e[e.length-1]}getAuditLogData(t){this.api.getFirstAndSecondAuthAuditService(this.getDetailsQueryToggleReqDTO).subscribe(t=>{this.firstAndSecondAuthAuditLogRespDTO=t})}approveSecondLevel(){if(this.pendingForAuthDetailsListAll&&(this.todaydate=this.pipe.transform(this.now,"dd-MMM-yy"),this.uploaddate=this.pipe.transform(this.pendingForAuthDetailsListAll[0].uploadDate,"dd-MMM-yy"),console.log("date for compare",this.todaydate,this.uploaddate),this.todaydate!==this.uploaddate))return console.log("inside if"),void g().fire("Unable to authorized.","backdated authorization not allowed.");this.user_id!==this.pendingForAuthDetailsListAll[0].inputBy?(this.flag=!1,this.progress=!0,this.api.authorizeSecondLevel(this.pendingForAuthDetailsListAll,localStorage.getItem("currentUser")).subscribe(t=>{this.firstLevelAuthorizationStatus=t,console.log(this.firstLevelAuthorizationStatus),this.firstLevelAuthorizationStatus&&(this.progress=!1,g().fire("You authorized the record to second level ")),this.firstLevelAuthorizationStatus||(this.progress=!1,g().fire("Error","You failed to authorize the record."))}),this.getPendingForAuthData()):g().fire("Maker do not have permission to authorized.")}getAllSecondLevelAuthDetailsData(){this.api.getSecondLevelAuthDetailsData().subscribe(t=>{this.pendingForAuthDetailsListAll=t,this.dtTrigger2.next()})}queryDetailsDataByParam(t,e){var i=document.getElementById("btnGetDetails"+e);i.innerHTML='<span class="indicator-progress" >Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>',this.getDetailsQueryToggleReqDTO=new o.AJ,this.getDetailsQueryToggleReqDTO.batchNumber=t.batchNumber,this.api.queryDetailsDataByParamServiceSecond(t.batchNumber).subscribe(t=>{this.pendingForAuthDetailsListAll=t,i.innerHTML="<span>Get Details</span>",this.dtTrigger2.next(),console.log(this.pendingForAuthDetailsListAll),this.pendingForAuthDetailsListAll.length>0?(this.flag=!0,this.flag1=!0,this.getAuditLogData(this.getDetailsQueryToggleReqDTO)):g().fire("Edit the data from modify excel screen","No data found.")})}getDataWithOldAndNewValue(t){this.deUploadPendingForAuthDTO=t,this.getDetailsQueryToggleReqDTO=new o.AJ,this.getDetailsQueryToggleReqDTO.externalSysName=this.deUploadPendingForAuthDTO.externalSysName,this.getDetailsQueryToggleReqDTO.processName=this.deUploadPendingForAuthDTO.processName,this.getDetailsQueryToggleReqDTO.processingDate=this.deUploadPendingForAuthDTO.processingDate,this.getDetailsQueryToggleReqDTO.currency=this.deUploadPendingForAuthDTO.currency,this.api.queryDetailsDataByParamService(this.getDetailsQueryToggleReqDTO).subscribe(t=>{this.detailsDataForFlex=t})}approveAndProcess(){this.spinner=!0,this.deUploadReqDTO=new o.Qz,this.deUploadReqDTO.pendingForAuthDTO=this.deUploadPendingForAuthDTO,this.deUploadReqDTO.pendingForAuthDetailsDTOList=this.detailsDataForFlex,this.api.processDeUpload(this.deUploadReqDTO,this.user_id).subscribe(t=>{this.deUploadStatus=t,"FAILURE"===this.deUploadStatus.statusMessage&&(this.spinner=!1,this.openSnackBar("Data Failed to Upload In Demodule","")),"SUCCESS"===this.deUploadStatus.statusMessage&&(this.spinner=!1,this.openSnackBar("Data Successfully Uploaded TO DeUpload",""))},t=>{l.UA&&(this.spinner=!1,g().fire("Error","Failed to connect to flexcube"))})}getPendingForAuthData(){this.api.getPendingForAuthDataFirstError(this.user_id).subscribe(t=>{this.pendingForAuthData=t,this.dtTrigger1.next(),this.dtTrigger1.complete(),console.log(this.pendingForAuthData)})}doValidationOfString(t,e){return t===e}openSnackBar(t,e){g().fire(t)}viewOperation(t){this.getDataWithOldAndNewValue(t),console.log(t),console.log(a),this.dummyPendingForAuthDataDetailsSecond=new Array;const e=t.id.sourceCode,i=t.id.branchCode,n=t.id.batchNo,r=t.id.initiationDate,s=t.id.currNo;for(const a of this.pendingForAuthDetailsListAll)a.id.sourceCode===e&&a.id.branchCode===i&&a.id.batchNo===n&&a.id.initiationDate===r&&a.id.currNo===s&&this.dummyPendingForAuthDataDetailsSecond.push(a);this.openDialog(this.dummyPendingForAuthDataDetailsSecond)}openDialog(t){}downloadData(){this.button1=!1,console.log(this.dummyPendingForAuthDataDetailsSecond),this.dummyPendingForAuthDataDetailsSecond.forEach(t=>{this.dataForProcessScreen1.push({Source_Code:t.id.sourceCode,Process_Code:t.processCode,Branch_Code:t.id.branchCode,Batch_No:t.id.batchNo,Value_Date:this.pipe.transform(t.valueDate,"dd-MMM-yy"),Account:t.account,Account_Branch:t.accountBranch,Currency:t.ccyCd,Amount:t.amount,DrCr:t.drCr,LcyEquivalent:t.lcyEquivalent,Curr_No:t.id.currNo,Addl_Text:t.addlText,TreasuryReference:t.acumenJournal,Trn_Code:t.txnCode,Period_Code:t.periodCode,Financial_Cycle:t.finCycle,Upload_Date:this.pipe.transform(t.uploadDate,"dd-MMM-yy"),Input_By:t.inputBy,Input_Time:this.pipe.transform(t.inputTime,"dd-MMM-yy"),Related_Customer:t.relCust,Related_Account:t.relatedAccount,Related_Reference:t.relatedRef}),console.log(this.dataForProcessScreen1)}),console.log("final data",this.dataForProcessScreen1),this.excelService.exportAsExcelFile(this.dataForProcessScreen1,"Excel_Upload_Data"),this.dataForProcessScreen1=[""]}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(A.sM),p.Y36(T.fz),p.Y36(f.x))},t.\u0275cmp=p.Xpm({type:t,selectors:[["npr-authorize-modification"]],decls:58,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"pageTitle","my-3","text-center"],[1,"dbCardStyle","table-responsive"],["id","dbTable1","datatable","",1,"dataTable","table","tableStyle","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],["id","dbTable2","datatable","",1,"dataTable","table","tableStyle","nowrap",2,"width","100%",3,"dtOptions","dtTrigger"],[1,"btnCol","mt-md-4","mt-3"],["href","javascript:void(0)",1,"btn","smBtn","btnDarkGrey"],["class","btn smBtn btnPrimary ","style","height : 90%",3,"click",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"id","click"],[3,"click",4,"ngIf"],[3,"click"],[1,"btn","smBtn","btnPrimary",2,"height","90%",3,"click"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Authorize Modifications"),p.qZA(),p.qZA(),p.TgZ(4,"h2",3),p._uU(5,"Pending for Authorization"),p.qZA(),p.TgZ(6,"div",4),p.TgZ(7,"table",5),p.TgZ(8,"thead"),p.TgZ(9,"tr"),p.TgZ(10,"th"),p._uU(11,"process detail"),p.qZA(),p.TgZ(12,"th"),p._uU(13,"external system"),p.qZA(),p.TgZ(14,"th"),p._uU(15,"batch number"),p.qZA(),p.TgZ(16,"th"),p._uU(17,"process name"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"processing date"),p.qZA(),p.TgZ(20,"th"),p._uU(21,"file name"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"currancy"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(24,"tbody"),p.YNc(25,D,17,10,"tr",6),p.qZA(),p.qZA(),p.qZA(),p.TgZ(26,"div",4),p.TgZ(27,"table",7),p.TgZ(28,"thead"),p.TgZ(29,"tr"),p.TgZ(30,"th"),p._uU(31,"account"),p.qZA(),p.TgZ(32,"th"),p._uU(33,"currency"),p.qZA(),p.TgZ(34,"th"),p._uU(35,"branch"),p.qZA(),p.TgZ(36,"th"),p._uU(37,"amount"),p.qZA(),p.TgZ(38,"th"),p._uU(39,"lcy ammount"),p.qZA(),p.TgZ(40,"th"),p._uU(41,"dR/cr"),p.qZA(),p.TgZ(42,"th"),p._uU(43,"exchange rate"),p.qZA(),p.TgZ(44,"th"),p._uU(45,"related acc"),p.qZA(),p.TgZ(46,"th"),p._uU(47,"add text"),p.qZA(),p.TgZ(48,"th"),p._uU(49,"treasury reference"),p.qZA(),p.TgZ(50,"th"),p._uU(51,"Process"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(52,"tbody"),p.YNc(53,b,23,11,"tr",6),p.qZA(),p.qZA(),p.qZA(),p.TgZ(54,"div",8),p.TgZ(55,"a",9),p._uU(56,"Export +"),p.qZA(),p.YNc(57,y,2,0,"button",10),p.qZA(),p.qZA()),2&t&&(p.xp6(7),p.Q6J("dtOptions",e.dtOptions[0])("dtTrigger",e.dtTrigger1),p.xp6(18),p.Q6J("ngForOf",e.pendingForAuthData),p.xp6(2),p.Q6J("dtOptions",e.dtOptions[1])("dtTrigger",e.dtTrigger2),p.xp6(26),p.Q6J("ngForOf",e.pendingForAuthDetailsListAll),p.xp6(4),p.Q6J("ngIf",e.flag))},directives:[m.G,n.sg,n.O5],pipes:[n.uU],styles:["table.tableStyle[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:9px;text-transform:uppercase;letter-spacing:1px;padding:16px 13px;border-bottom:1px solid #F5F5F5}"]}),t})()}];let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[r.Bz.forChild(q)],r.Bz]}),t})(),_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[n.ez,O,m.T]]}),t})()}}]);