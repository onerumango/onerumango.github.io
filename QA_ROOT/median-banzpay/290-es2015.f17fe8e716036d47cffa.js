"use strict";(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[290],{31443:function(s,t,e){e.d(t,{k:function(){return o}});var i=e(37716),r=e(80463);let o=(()=>{class s{constructor(s){this.iziToast=s}successMessage(s,t){this.iziToast.success({title:s,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}errorMessage(s,t){this.iziToast.error({title:s,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}infoMessage(s,t){this.iziToast.info({title:s,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}}return s.\u0275fac=function(t){return new(t||s)(i.LFG(r.I))},s.\u0275prov=i.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},65290:function(s,t,e){e.r(t),e.d(t,{ForgetPasswordModule:function(){return U}});var i=e(38583),r=e(39895),o=e(3679),n=e(2527),a=e(88259),h=e.n(a),c=e(37716),u=e(3118),g=e(26215),d=e(91841);let p=(()=>{class s{constructor(s){this.http=s,this.uri=u.$.baseURL,this.dashboardapi=u.$.baseURL+"/dashboard",this.userapi=u.$.baseURL+"/users",this.departmentname=new g.X(""),this.logouttime=new g.X("")}getOtp(s){return this.http.post(`${this.uri}/login/otp`,s)}loginService(s){return this.http.post(`${this.uri}/login/credentials`,s)}forgetPassword(s){return this.http.post(`${this.uri}/login/forgetPsw`,s)}fristTimePassword(s){return this.http.post(`${this.uri}/user/passwordReset`,s)}getOtpForReset(s){return this.http.post(`${this.uri}/users/otpForReset`,s)}userPasswordExpireNotif(s){return this.http.get(`${this.uri}/login/pwdNotif/${s}`)}fetchSecurityPolicyService(){return this.http.get(`${this.uri}/securityPolicy/fetch`)}fetchMedUser(s){return this.http.get(`${this.uri}/login/getUserByUserId/${s}`)}settingdepartmentlogged(s,t){this.departmentname.next(s),this.logouttime.next(t)}gettingloginTimeandDepartment(s){return this.http.get(`${this.userapi}/loganddept/${s}`)}}return s.\u0275fac=function(t){return new(t||s)(c.LFG(d.eN))},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var l=e(31443),m=e(10402),f=e(3494);const w=["ngOtpInput"];function v(s,t){if(1&s&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&s){const s=c.oxw(2);c.xp6(1),c.Oqu(s.errorMsg)}}function x(s,t){if(1&s&&(c.TgZ(0,"div",25),c.YNc(1,v,2,1,"div",26),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.Q6J("ngIf",s.reactiveForm.get("password").errors.pattern)}}function P(s,t){if(1&s&&(c.TgZ(0,"div",25),c._uU(1),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.hij(" New Password Password must contain Minimum ",s.minPass," digits. ")}}function b(s,t){if(1&s&&(c.TgZ(0,"div",25),c._uU(1),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.hij(" New Password must contain Maximum ",s.maxPass," digits. ")}}function Z(s,t){if(1&s&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&s){const s=c.oxw(2);c.xp6(1),c.Oqu(s.errorMsg)}}function I(s,t){if(1&s&&(c.TgZ(0,"div",25),c.YNc(1,Z,2,1,"div",26),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.Q6J("ngIf",s.reactiveForm.get("confirmPassword").errors.pattern)}}function y(s,t){if(1&s&&(c.TgZ(0,"div",25),c._uU(1),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.hij(" Confirm Password must contain Minimum ",s.minPass," digits. ")}}function A(s,t){if(1&s&&(c.TgZ(0,"div",25),c._uU(1),c.qZA()),2&s){const s=c.oxw();c.xp6(1),c.hij(" Confirm Password must contain Maximum ",s.maxPass," digits. ")}}let S=(()=>{class s{constructor(s,t,e,i,r,o){this.router=s,this.route=t,this.apiService=e,this.fb=i,this.toastService=r,this.securityService=o,this.config={allowNumbersOnly:!0,length:6,isPasswordInput:!1,disableAutoFocus:!1,placeholder:"*",inputStyles:{width:"40px",height:"40px"}},this.loginProcessing=!1,this.login=new q,this.editable=!1,this.errorMsg="",this.hide=!0,this.hideConfirm=!0,this.modifyUserObject=new q,this.login1=new q,this.otpBtn=!1,this.submitBtn=!1,this.getOtpButtonEnable=!0,this.route.queryParams.subscribe(s=>{this.modifyUserObject.username=s.userId})}ngOnInit(){this.isReadOnly=!1,this.button2=!0,this.reactiveForm=this.fb.group({userId:new o.NI(""),otp:new o.NI("",[o.kI.required]),password:new o.NI("",[o.kI.required,o.kI.compose([o.kI.pattern(this.passwordRegex),o.kI.maxLength(this.maxPass),o.kI.minLength(this.minPass)])]),confirmPassword:new o.NI("",[o.kI.required,o.kI.compose([o.kI.pattern(this.passwordRegex),o.kI.maxLength(this.maxPass),o.kI.minLength(this.minPass)])])}),this.userId=localStorage.getItem("userIdForChangePassword"),this.securityService.fetchSecurityPolicyService().subscribe(s=>{this.security=s,console.log(this.security),this.minPass=this.security.minPswdLength,this.maxPass=this.security.maxPswdLength,this.buildForm(this.minPass,this.maxPass),console.log(this.minPass,this.maxPass),console.log(this.security)}),this.buildForm(this.minPass?this.minPass:void 0,this.maxPass?this.maxPass:void 0)}buildForm(s,t){this.securityService.fetchSecurityPolicyService().subscribe(s=>{this.security1=s,this.ucase=this.security1.pswdComplexUcase,this.lcase=this.security1.pswdComplexLcase,this.num=this.security1.pswdComplexNum,this.splc=this.security1.pswdComplexSplc,"true"==this.security1.pswdComplexUcase&&(this.passwordRegex="(?=[^A-Z]*[A-Z])",this.errorMsg=" UpperCase"),"true"==this.security1.pswdComplexLcase&&(this.passwordRegex=this.passwordRegex+"(?=[^a-z]*[a-z])",this.errorMsg=""!=this.errorMsg?this.errorMsg+", LowerCase":this.errorMsg+" LowerCase"),"true"==this.splc&&(this.passwordRegex=this.passwordRegex+"(?=.*[!@#$%^&*])",this.errorMsg=""!=this.errorMsg?this.errorMsg+", Special Character":this.errorMsg+" Special Character"),"true"==this.security1.pswdComplexNum&&(this.passwordRegex=this.passwordRegex+"(?=[^0-9]*[0-9])",this.errorMsg=""!=this.errorMsg?this.errorMsg+", Number":this.errorMsg+" Number"),this.passwordRegex=this.passwordRegex+".{"+this.minPass+","+this.maxPass+"}",this.errorMsg="Password must contain atleast one "+this.errorMsg+".",console.log(this.passwordRegex),this.reactiveForm=this.fb.group({userId:new o.NI(""),otp:new o.NI("",[o.kI.required]),password:new o.NI("",[o.kI.required,o.kI.compose([o.kI.pattern(this.passwordRegex),o.kI.maxLength(this.maxPass),o.kI.minLength(this.minPass)])]),confirmPassword:new o.NI("",[o.kI.required,o.kI.compose([o.kI.pattern(this.passwordRegex),o.kI.maxLength(this.maxPass),o.kI.minLength(this.minPass)])])})}),console.log(this.minPass,this.maxPass),console.log("form",this.reactiveForm)}resetButton(){this.reactiveForm.reset()}reset(s){if(s.username){var t=n.AES.encrypt(s.password,"@12#90!^*NPR*g&*()$34#$"),e=n.AES.encrypt(s.username,"@12#90!^*NPR*g&*()$34#$"),i=t.toString(),r=e.toString();this.login1.password=i,this.login1.username=r,this.login1.otp=this.otp,console.log(this.login1),this.spinnerbutton=!0,this.apiService.forgetPassword(this.login1).subscribe(s=>{this.var1=s,console.log(this.var1),this.var1?(this.spinnerbutton=!1,"Login success."===this.var1[0]?(this.otpBtn=!0,this.submitBtn=!0,h().fire({text:"password Changed Successfully."})):h().fire({text:this.var1[0]})):(this.spinnerbutton=!1,h().fire({text:"Choose Other Password or otp is invalid."}))})}else this.toastService.infoMessage("Enter User Id.","")}getOtp(s){this.loginProcessing=!0,s?this.apiService.fetchMedUser(s).subscribe(t=>{console.log(t),this.user=t,this.email=this.user.email,localStorage.setItem("userFromLogin",this.user.userId),sessionStorage.setItem("user_id",this.user.userId);var e=n.AES.encrypt(s,"@12#90!^*NPR*g&*()$34#$").toString();console.log(e),this.spinnerbutton=!0,this.passwordReset1=e,console.log("uname",e),this.apiService.getOtpForReset(this.passwordReset1).subscribe(s=>{this.loginProcessing=!1,this.var=s,this.var?(this.button1=!0,this.button2=!1,this.isReadOnly=!0,this.spinnerbutton=!1,this.toastService.successMessage("OTP sent successfully to "+this.email,""),this.getOtpButtonEnable=!1):(h().fire({text:"Unable to find User details.Verify your userid."}),this.button1=!1,this.button2=!0,this.isReadOnly=!0,this.spinnerbutton=!1)})},s=>{h().fire(s.error.message)}):h().fire({text:"Enter User Id."})}goHome(){this.router.navigate(["/login"])}onOtpChange(s){this.otp=s,6===this.otp.length&&this.reactiveForm.get("otp").setValue(this.otp)}changePassword(s,t,e,i){if(console.log(s,t,e,i),s!=t)h().fire({text:"Password Not Matched."});else{this.loginProcessing=!0;let t=n.AES.encrypt(s,"@12#90!^*NPR*g&*()$34#$"),o=n.AES.encrypt(e,"@12#90!^*NPR*g&*()$34#$");var r=t.toString();let a=o.toString();this.login.password=r,this.login.username=a,this.login.otp=i,console.log(this.login),this.apiService.forgetPassword(this.login).subscribe(s=>{this.loginProcessing=!1,this.res=s,console.log(this.res),this.res?("Login success."===this.res[0]&&(this.otpBtn=!0,this.submitBtn=!0,h().fire({text:"Password Changed Successfully."})),"You cannot use your previous password. Please choose another password"==s[0]&&h().fire("You can not use your last "+this.security.pswdReuseAft+" passwords. Please choose another password.",""),"OTP is invalid"==s[0]&&h().fire({text:"Otp is invalid."}),"successfull"==s[0]&&(this.otpBtn=!0,this.submitBtn=!0,h().fire({text:"Password Changed Successfully."}))):h().fire({text:"Choose Other Password or otp is invalid."})})}}exit(){localStorage.clear(),sessionStorage.clear(),this.router.navigate(["/session/login"])}}return s.\u0275fac=function(t){return new(t||s)(c.Y36(r.F0),c.Y36(r.gz),c.Y36(p),c.Y36(o.qu),c.Y36(l.k),c.Y36(m.W))},s.\u0275cmp=c.Xpm({type:s,selectors:[["npr-forget-password"]],viewQuery:function(s,t){if(1&s&&c.Gf(w,5),2&s){let s;c.iGM(s=c.CRH())&&(t.ngOtpInput=s.first)}},decls:52,vars:10,consts:[[1,"mt-4"],["action","",1,"formStyle",3,"formGroup"],[1,"dbCardStyle","fieldwidth"],[1,"pageTitle","text-center","mb-md-4","mb-3"],[1,"row","gy-4"],[1,"col-12"],[1,"formLbl"],[1,"colorRed"],["id","User Id","placeholder","User Id","required","","value","","name","userId","formControlName","userId","oninput","this.value = this.value.toUpperCase()",1,"form-control"],["user",""],[1,"mb-10","px-md-10"],[1,"d-flex","flex-wrap","flex-stack"],["inputControls","9",2,"font-size","20px",3,"config","onInputChange"],["ngOtpInput",""],["id","password","placeholder","New Password","required","","value","","name","password","formControlName","password",1,"form-control"],["newPassword",""],["class","invalid-feedback",4,"ngIf"],["id","confirm password","placeholder","Confirm Password","required","","value","","name","confirmPassword","formControlName","confirmPassword",1,"form-control"],["confirmPassword",""],[1,"col-lg-12"],[1,"row","g-3","pb-3","pt-3","justify"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(s,t){if(1&s){const s=c.EpF();c.TgZ(0,"div",0),c.TgZ(1,"form",1),c.TgZ(2,"div",2),c.TgZ(3,"h2",3),c._uU(4,"Reset Password"),c.qZA(),c.TgZ(5,"div",4),c.TgZ(6,"div",5),c.TgZ(7,"label",6),c._uU(8,"User ID"),c.TgZ(9,"span",7),c._uU(10,"*"),c.qZA(),c.qZA(),c._UZ(11,"input",8,9),c.qZA(),c.TgZ(13,"div",10),c.TgZ(14,"label",6),c._uU(15,"OTP"),c.TgZ(16,"span",7),c._uU(17,"*"),c.qZA(),c.qZA(),c.TgZ(18,"div",11),c.TgZ(19,"ng-otp-input",12,13),c.NdJ("onInputChange",function(s){return t.onOtpChange(s)}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(21,"div",5),c.TgZ(22,"label",6),c._uU(23,"New Password"),c.TgZ(24,"span",7),c._uU(25,"*"),c.qZA(),c.qZA(),c._UZ(26,"input",14,15),c.YNc(28,x,2,1,"div",16),c.YNc(29,P,2,1,"div",16),c.YNc(30,b,2,1,"div",16),c.qZA(),c.TgZ(31,"div",5),c.TgZ(32,"label",6),c._uU(33,"Confirm Password"),c.TgZ(34,"span",7),c._uU(35,"*"),c.qZA(),c.qZA(),c._UZ(36,"input",17,18),c.YNc(38,I,2,1,"div",16),c.YNc(39,y,2,1,"div",16),c.YNc(40,A,2,1,"div",16),c.qZA(),c.TgZ(41,"div",19),c.TgZ(42,"div",20),c.TgZ(43,"div",21),c.TgZ(44,"button",22),c.NdJ("click",function(){c.CHM(s);const e=c.MAs(12);return t.getOtp(e.value)}),c._uU(45,"Get OTP"),c.qZA(),c.qZA(),c.TgZ(46,"div",21),c.TgZ(47,"button",23),c.NdJ("click",function(){c.CHM(s);const e=c.MAs(27),i=c.MAs(37),r=c.MAs(12);return t.changePassword(e.value,i.value,r.value,t.otp)}),c._uU(48,"Save"),c.qZA(),c.qZA(),c.TgZ(49,"div",21),c.TgZ(50,"a",24),c.NdJ("click",function(){return t.exit()}),c._uU(51,"Exit"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}2&s&&(c.xp6(1),c.Q6J("formGroup",t.reactiveForm),c.xp6(18),c.Q6J("config",t.config),c.xp6(9),c.Q6J("ngIf",t.reactiveForm.get("password").touched&&!t.reactiveForm.get("password").valid),c.xp6(1),c.Q6J("ngIf",t.reactiveForm.get("password").hasError("minlength")),c.xp6(1),c.Q6J("ngIf",t.reactiveForm.get("password").hasError("maxlength")),c.xp6(8),c.Q6J("ngIf",t.reactiveForm.get("confirmPassword").touched&&!t.reactiveForm.get("confirmPassword").valid),c.xp6(1),c.Q6J("ngIf",t.reactiveForm.get("confirmPassword").hasError("minlength")),c.xp6(1),c.Q6J("ngIf",t.reactiveForm.get("confirmPassword").hasError("maxlength")),c.xp6(4),c.Q6J("disabled",t.otpBtn||!t.getOtpButtonEnable),c.xp6(3),c.Q6J("disabled",!t.reactiveForm.valid||t.submitBtn))},directives:[o._Y,o.JL,o.sg,o.Fj,o.Q7,o.JJ,o.u,f.df,i.O5],styles:[""]}),s})();class q{}const T=[{path:"",component:S}];let C=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=c.oAB({type:s}),s.\u0275inj=c.cJS({imports:[[r.Bz.forChild(T)],r.Bz]}),s})(),U=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=c.oAB({type:s}),s.\u0275inj=c.cJS({imports:[[i.ez,C,o.UX,f.Xz]]}),s})()}}]);