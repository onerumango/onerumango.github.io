!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[290],{31443:function(t,r,o){o.d(r,{k:function(){return u}});var i,n=o(37716),a=o(80463),u=((i=function(){function t(s){e(this,t),this.iziToast=s}return s(t,[{key:"successMessage",value:function(e,t){this.iziToast.success({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}},{key:"errorMessage",value:function(e,t){this.iziToast.error({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}},{key:"infoMessage",value:function(e,t){this.iziToast.info({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}}]),t}()).\u0275fac=function(e){return new(e||i)(n.LFG(a.I))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},65290:function(t,r,o){o.r(r),o.d(r,{ForgetPasswordModule:function(){return M}});var i,n=o(38583),a=o(39895),u=o(3679),c=o(2527),g=o(88259),l=o.n(g),d=o(37716),p=o(3118),h=o(26215),f=o(91841),m=((i=function(){function t(s){e(this,t),this.http=s,this.uri=p.$.baseURL,this.dashboardapi=p.$.baseURL+"/dashboard",this.userapi=p.$.baseURL+"/users",this.departmentname=new h.X(""),this.logouttime=new h.X("")}return s(t,[{key:"getOtp",value:function(e){return this.http.post("".concat(this.uri,"/login/otp"),e)}},{key:"loginService",value:function(e){return this.http.post("".concat(this.uri,"/login/credentials"),e)}},{key:"forgetPassword",value:function(e){return this.http.post("".concat(this.uri,"/login/forgetPsw"),e)}},{key:"fristTimePassword",value:function(e){return this.http.post("".concat(this.uri,"/user/passwordReset"),e)}},{key:"getOtpForReset",value:function(e){return this.http.post("".concat(this.uri,"/users/otpForReset"),e)}},{key:"userPasswordExpireNotif",value:function(e){return this.http.get("".concat(this.uri,"/login/pwdNotif/").concat(e))}},{key:"fetchSecurityPolicyService",value:function(){return this.http.get("".concat(this.uri,"/securityPolicy/fetch"))}},{key:"fetchMedUser",value:function(e){return this.http.get("".concat(this.uri,"/login/getUserByUserId/").concat(e))}},{key:"settingdepartmentlogged",value:function(e,t){this.departmentname.next(e),this.logouttime.next(t)}},{key:"gettingloginTimeandDepartment",value:function(e){return this.http.get("".concat(this.userapi,"/loganddept/").concat(e))}}]),t}()).\u0275fac=function(e){return new(e||i)(d.LFG(f.eN))},i.\u0275prov=d.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i),v=o(31443),w=o(10402),x=o(3494),y=["ngOtpInput"];function P(e,t){if(1&e&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&e){var s=d.oxw(2);d.xp6(1),d.Oqu(s.errorMsg)}}function b(e,t){if(1&e&&(d.TgZ(0,"div",25),d.YNc(1,P,2,1,"div",26),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.Q6J("ngIf",s.reactiveForm.get("password").errors.pattern)}}function Z(e,t){if(1&e&&(d.TgZ(0,"div",25),d._uU(1),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.hij(" New Password Password must contain Minimum ",s.minPass," digits. ")}}function I(e,t){if(1&e&&(d.TgZ(0,"div",25),d._uU(1),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.hij(" New Password must contain Maximum ",s.maxPass," digits. ")}}function k(e,t){if(1&e&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&e){var s=d.oxw(2);d.xp6(1),d.Oqu(s.errorMsg)}}function A(e,t){if(1&e&&(d.TgZ(0,"div",25),d.YNc(1,k,2,1,"div",26),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.Q6J("ngIf",s.reactiveForm.get("confirmPassword").errors.pattern)}}function S(e,t){if(1&e&&(d.TgZ(0,"div",25),d._uU(1),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.hij(" Confirm Password must contain Minimum ",s.minPass," digits. ")}}function q(e,t){if(1&e&&(d.TgZ(0,"div",25),d._uU(1),d.qZA()),2&e){var s=d.oxw();d.xp6(1),d.hij(" Confirm Password must contain Maximum ",s.maxPass," digits. ")}}var T=function(){var t=function(){function t(s,r,o,i,n,a){var u=this;e(this,t),this.router=s,this.route=r,this.apiService=o,this.fb=i,this.toastService=n,this.securityService=a,this.config={allowNumbersOnly:!0,length:6,isPasswordInput:!1,disableAutoFocus:!1,placeholder:"*",inputStyles:{width:"40px",height:"40px"}},this.loginProcessing=!1,this.login=new C,this.editable=!1,this.errorMsg="",this.hide=!0,this.hideConfirm=!0,this.modifyUserObject=new C,this.login1=new C,this.otpBtn=!1,this.submitBtn=!1,this.getOtpButtonEnable=!0,this.route.queryParams.subscribe(function(e){u.modifyUserObject.username=e.userId})}return s(t,[{key:"ngOnInit",value:function(){var e=this;this.isReadOnly=!1,this.button2=!0,this.reactiveForm=this.fb.group({userId:new u.NI(""),otp:new u.NI("",[u.kI.required]),password:new u.NI("",[u.kI.required,u.kI.compose([u.kI.pattern(this.passwordRegex),u.kI.maxLength(this.maxPass),u.kI.minLength(this.minPass)])]),confirmPassword:new u.NI("",[u.kI.required,u.kI.compose([u.kI.pattern(this.passwordRegex),u.kI.maxLength(this.maxPass),u.kI.minLength(this.minPass)])])}),this.userId=localStorage.getItem("userIdForChangePassword"),this.securityService.fetchSecurityPolicyService().subscribe(function(t){e.security=t,console.log(e.security),e.minPass=e.security.minPswdLength,e.maxPass=e.security.maxPswdLength,e.buildForm(e.minPass,e.maxPass),console.log(e.minPass,e.maxPass),console.log(e.security)}),this.buildForm(this.minPass?this.minPass:void 0,this.maxPass?this.maxPass:void 0)}},{key:"buildForm",value:function(e,t){var s=this;this.securityService.fetchSecurityPolicyService().subscribe(function(e){s.security1=e,s.ucase=s.security1.pswdComplexUcase,s.lcase=s.security1.pswdComplexLcase,s.num=s.security1.pswdComplexNum,s.splc=s.security1.pswdComplexSplc,"true"==s.security1.pswdComplexUcase&&(s.passwordRegex="(?=[^A-Z]*[A-Z])",s.errorMsg=" UpperCase"),"true"==s.security1.pswdComplexLcase&&(s.passwordRegex=s.passwordRegex+"(?=[^a-z]*[a-z])",s.errorMsg=""!=s.errorMsg?s.errorMsg+", LowerCase":s.errorMsg+" LowerCase"),"true"==s.splc&&(s.passwordRegex=s.passwordRegex+"(?=.*[!@#$%^&*])",s.errorMsg=""!=s.errorMsg?s.errorMsg+", Special Character":s.errorMsg+" Special Character"),"true"==s.security1.pswdComplexNum&&(s.passwordRegex=s.passwordRegex+"(?=[^0-9]*[0-9])",s.errorMsg=""!=s.errorMsg?s.errorMsg+", Number":s.errorMsg+" Number"),s.passwordRegex=s.passwordRegex+".{"+s.minPass+","+s.maxPass+"}",s.errorMsg="Password must contain atleast one "+s.errorMsg+".",console.log(s.passwordRegex),s.reactiveForm=s.fb.group({userId:new u.NI(""),otp:new u.NI("",[u.kI.required]),password:new u.NI("",[u.kI.required,u.kI.compose([u.kI.pattern(s.passwordRegex),u.kI.maxLength(s.maxPass),u.kI.minLength(s.minPass)])]),confirmPassword:new u.NI("",[u.kI.required,u.kI.compose([u.kI.pattern(s.passwordRegex),u.kI.maxLength(s.maxPass),u.kI.minLength(s.minPass)])])})}),console.log(this.minPass,this.maxPass),console.log("form",this.reactiveForm)}},{key:"resetButton",value:function(){this.reactiveForm.reset()}},{key:"reset",value:function(e){var t=this;if(e.username){var s=c.AES.encrypt(e.password,"@12#90!^*NPR*g&*()$34#$"),r=c.AES.encrypt(e.username,"@12#90!^*NPR*g&*()$34#$"),o=s.toString(),i=r.toString();this.login1.password=o,this.login1.username=i,this.login1.otp=this.otp,console.log(this.login1),this.spinnerbutton=!0,this.apiService.forgetPassword(this.login1).subscribe(function(e){t.var1=e,console.log(t.var1),t.var1?(t.spinnerbutton=!1,"Login success."===t.var1[0]?(t.otpBtn=!0,t.submitBtn=!0,l().fire({text:"password Changed Successfully."})):l().fire({text:t.var1[0]})):(t.spinnerbutton=!1,l().fire({text:"Choose Other Password or otp is invalid."}))})}else this.toastService.infoMessage("Enter User Id.","")}},{key:"getOtp",value:function(e){var t=this;this.loginProcessing=!0,e?this.apiService.fetchMedUser(e).subscribe(function(s){console.log(s),t.user=s,t.email=t.user.email,localStorage.setItem("userFromLogin",t.user.userId),sessionStorage.setItem("user_id",t.user.userId);var r=c.AES.encrypt(e,"@12#90!^*NPR*g&*()$34#$").toString();console.log(r),t.spinnerbutton=!0,t.passwordReset1=r,console.log("uname",r),t.apiService.getOtpForReset(t.passwordReset1).subscribe(function(e){t.loginProcessing=!1,t.var=e,t.var?(t.button1=!0,t.button2=!1,t.isReadOnly=!0,t.spinnerbutton=!1,t.toastService.successMessage("OTP sent successfully to "+t.email,""),t.getOtpButtonEnable=!1):(l().fire({text:"Unable to find User details.Verify your userid."}),t.button1=!1,t.button2=!0,t.isReadOnly=!0,t.spinnerbutton=!1)})},function(e){l().fire(e.error.message)}):l().fire({text:"Enter User Id."})}},{key:"goHome",value:function(){this.router.navigate(["/login"])}},{key:"onOtpChange",value:function(e){this.otp=e,6===this.otp.length&&this.reactiveForm.get("otp").setValue(this.otp)}},{key:"changePassword",value:function(e,t,s,r){var o=this;if(console.log(e,t,s,r),e!=t)l().fire({text:"Password Not Matched."});else{this.loginProcessing=!0;var i=c.AES.encrypt(e,"@12#90!^*NPR*g&*()$34#$"),n=c.AES.encrypt(s,"@12#90!^*NPR*g&*()$34#$"),a=i.toString(),u=n.toString();this.login.password=a,this.login.username=u,this.login.otp=r,console.log(this.login),this.apiService.forgetPassword(this.login).subscribe(function(e){o.loginProcessing=!1,o.res=e,console.log(o.res),o.res?("Login success."===o.res[0]&&(o.otpBtn=!0,o.submitBtn=!0,l().fire({text:"Password Changed Successfully."})),"You cannot use your previous password. Please choose another password"==e[0]&&l().fire("You can not use your last "+o.security.pswdReuseAft+" passwords. Please choose another password.",""),"OTP is invalid"==e[0]&&l().fire({text:"Otp is invalid."}),"successfull"==e[0]&&(o.otpBtn=!0,o.submitBtn=!0,l().fire({text:"Password Changed Successfully."}))):l().fire({text:"Choose Other Password or otp is invalid."})})}}},{key:"exit",value:function(){localStorage.clear(),sessionStorage.clear(),this.router.navigate(["/session/login"])}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(a.F0),d.Y36(a.gz),d.Y36(m),d.Y36(u.qu),d.Y36(v.k),d.Y36(w.W))},t.\u0275cmp=d.Xpm({type:t,selectors:[["npr-forget-password"]],viewQuery:function(e,t){var s;(1&e&&d.Gf(y,5),2&e)&&(d.iGM(s=d.CRH())&&(t.ngOtpInput=s.first))},decls:52,vars:10,consts:[[1,"mt-4"],["action","",1,"formStyle",3,"formGroup"],[1,"dbCardStyle","fieldwidth"],[1,"pageTitle","text-center","mb-md-4","mb-3"],[1,"row","gy-4"],[1,"col-12"],[1,"formLbl"],[1,"colorRed"],["id","User Id","placeholder","User Id","required","","value","","name","userId","formControlName","userId","oninput","this.value = this.value.toUpperCase()",1,"form-control"],["user",""],[1,"mb-10","px-md-10"],[1,"d-flex","flex-wrap","flex-stack"],["inputControls","9",2,"font-size","20px",3,"config","onInputChange"],["ngOtpInput",""],["id","password","placeholder","New Password","required","","value","","name","password","formControlName","password",1,"form-control"],["newPassword",""],["class","invalid-feedback",4,"ngIf"],["id","confirm password","placeholder","Confirm Password","required","","value","","name","confirmPassword","formControlName","confirmPassword",1,"form-control"],["confirmPassword",""],[1,"col-lg-12"],[1,"row","g-3","pb-3","pt-3","justify"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"click"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){if(1&e){var s=d.EpF();d.TgZ(0,"div",0),d.TgZ(1,"form",1),d.TgZ(2,"div",2),d.TgZ(3,"h2",3),d._uU(4,"Reset Password"),d.qZA(),d.TgZ(5,"div",4),d.TgZ(6,"div",5),d.TgZ(7,"label",6),d._uU(8,"User ID"),d.TgZ(9,"span",7),d._uU(10,"*"),d.qZA(),d.qZA(),d._UZ(11,"input",8,9),d.qZA(),d.TgZ(13,"div",10),d.TgZ(14,"label",6),d._uU(15,"OTP"),d.TgZ(16,"span",7),d._uU(17,"*"),d.qZA(),d.qZA(),d.TgZ(18,"div",11),d.TgZ(19,"ng-otp-input",12,13),d.NdJ("onInputChange",function(e){return t.onOtpChange(e)}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(21,"div",5),d.TgZ(22,"label",6),d._uU(23,"New Password"),d.TgZ(24,"span",7),d._uU(25,"*"),d.qZA(),d.qZA(),d._UZ(26,"input",14,15),d.YNc(28,b,2,1,"div",16),d.YNc(29,Z,2,1,"div",16),d.YNc(30,I,2,1,"div",16),d.qZA(),d.TgZ(31,"div",5),d.TgZ(32,"label",6),d._uU(33,"Confirm Password"),d.TgZ(34,"span",7),d._uU(35,"*"),d.qZA(),d.qZA(),d._UZ(36,"input",17,18),d.YNc(38,A,2,1,"div",16),d.YNc(39,S,2,1,"div",16),d.YNc(40,q,2,1,"div",16),d.qZA(),d.TgZ(41,"div",19),d.TgZ(42,"div",20),d.TgZ(43,"div",21),d.TgZ(44,"button",22),d.NdJ("click",function(){d.CHM(s);var e=d.MAs(12);return t.getOtp(e.value)}),d._uU(45,"Get OTP"),d.qZA(),d.qZA(),d.TgZ(46,"div",21),d.TgZ(47,"button",23),d.NdJ("click",function(){d.CHM(s);var e=d.MAs(27),r=d.MAs(37),o=d.MAs(12);return t.changePassword(e.value,r.value,o.value,t.otp)}),d._uU(48,"Save"),d.qZA(),d.qZA(),d.TgZ(49,"div",21),d.TgZ(50,"a",24),d.NdJ("click",function(){return t.exit()}),d._uU(51,"Exit"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(1),d.Q6J("formGroup",t.reactiveForm),d.xp6(18),d.Q6J("config",t.config),d.xp6(9),d.Q6J("ngIf",t.reactiveForm.get("password").touched&&!t.reactiveForm.get("password").valid),d.xp6(1),d.Q6J("ngIf",t.reactiveForm.get("password").hasError("minlength")),d.xp6(1),d.Q6J("ngIf",t.reactiveForm.get("password").hasError("maxlength")),d.xp6(8),d.Q6J("ngIf",t.reactiveForm.get("confirmPassword").touched&&!t.reactiveForm.get("confirmPassword").valid),d.xp6(1),d.Q6J("ngIf",t.reactiveForm.get("confirmPassword").hasError("minlength")),d.xp6(1),d.Q6J("ngIf",t.reactiveForm.get("confirmPassword").hasError("maxlength")),d.xp6(4),d.Q6J("disabled",t.otpBtn||!t.getOtpButtonEnable),d.xp6(3),d.Q6J("disabled",!t.reactiveForm.valid||t.submitBtn))},directives:[u._Y,u.JL,u.sg,u.Fj,u.Q7,u.JJ,u.u,x.df,n.O5],styles:[""]}),t}(),C=s(function t(){e(this,t)}),U=[{path:"",component:T}],N=function(){var t=s(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[a.Bz.forChild(U)],a.Bz]}),t}(),M=function(){var t=s(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[n.ez,N,u.UX,x.Xz]]}),t}()}}])}();