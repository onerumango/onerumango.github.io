!function(){"use strict";function t(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,n)}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==i.return||i.return()}finally{if(u)throw o}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[193],{17988:function(t,e,n){n.d(e,{G:function(){return r},T:function(){return o}});var i=n(37716),r=function(){function t(t,e,n){this.el=t,this.vcr=e,this.renderer=n,this.dtOptions={}}return t.prototype.ngOnInit=function(){var t=this;this.dtTrigger?this.dtTrigger.subscribe(function(e){t.displayTable(e)}):this.displayTable(null)},t.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},t.prototype.displayTable=function(t){var e=this;t&&(this.dtOptions=t),this.dtInstance=new Promise(function(t,n){Promise.resolve(e.dtOptions).then(function(i){0===Object.keys(i).length&&0===$("tbody tr",e.el.nativeElement).length?n("Both the table and dtOptions cannot be empty"):setTimeout(function(){var n={rowCallback:function(t,n,r){if(i.columns){var a=i.columns;e.applyNgPipeTransform(t,a),e.applyNgRefTemplate(t,a,n)}i.rowCallback&&i.rowCallback(t,n,r)}};n=Object.assign({},i,n),e.dt=$(e.el.nativeElement).DataTable(n),t(e.dt)})})})},t.prototype.applyNgPipeTransform=function(t,e){e.filter(function(t){return t.ngPipeInstance&&!t.ngTemplateRef}).forEach(function(n){var i=n.ngPipeInstance,r=e.findIndex(function(t){return t.data===n.data}),a=t.childNodes.item(r),o=$(a).text(),s=i.transform(o);$(a).text(s)})},t.prototype.applyNgRefTemplate=function(t,e,n){var i=this;e.filter(function(t){return t.ngTemplateRef&&!t.ngPipeInstance}).forEach(function(r){var a=r.ngTemplateRef,o=a.ref,s=a.context,u=e.findIndex(function(t){return t.data===r.data}),l=t.childNodes.item(u);$(l).html("");var d=Object.assign({},s,null==s?void 0:s.userData,{adtData:n}),c=i.vcr.createEmbeddedView(o,d);i.renderer.appendChild(l,c.rootNodes[0])})},t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(i.s_b),i.Y36(i.Qsj))},t.\u0275dir=i.lG2({type:t,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),t}(),a=n(38583),o=function(){function t(){}return t.forRoot=function(){return{ngModule:t}},t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[a.ez]]}),t}()},1193:function(e,n,a){a.r(n),a.d(n,{AuthorizeModificationModule:function(){return S}});var o=a(38583),s=a(39895),u=a(3679),l=i(function t(){r(this,t)}),d=a(27721),c=a(91841),g=a(92803),p=a(17283),h=a(79765),f=a(88259),A=a.n(f),T=a(37716),m=a(94761),y=a(59119),b=a(58219),D=a(17988);function Z(t,e){if(1&t){var n=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"td"),T.TgZ(2,"button",11),T.NdJ("click",function(){var t=T.CHM(n),e=t.$implicit,i=t.index;return T.oxw().queryDetailsDataByParam(e,i)}),T._uU(3," Get Details "),T.qZA(),T.qZA(),T.TgZ(4,"td"),T._uU(5),T.qZA(),T.TgZ(6,"td"),T._uU(7),T.qZA(),T.TgZ(8,"td"),T._uU(9),T.qZA(),T.TgZ(10,"td"),T._uU(11),T.ALo(12,"date"),T.qZA(),T.TgZ(13,"td"),T._uU(14),T.qZA(),T.TgZ(15,"td"),T._uU(16),T.qZA(),T.qZA()}if(2&t){var i=e.$implicit,r=e.index,a=T.oxw();T.xp6(2),T.s9C("id","btnGetDetails"+r),T.xp6(3),T.Oqu(null==i?null:i.externalSysName),T.xp6(2),T.Oqu(null==i?null:i.batchNumber),T.xp6(2),T.Oqu(null==i?null:i.processName),T.xp6(2),T.Oqu(T.xi3(12,7,null==i?null:i.processingDate,"medium")),T.xp6(3),T.Oqu(a.extractFilename(null==i?null:i.fileName)),T.xp6(2),T.Oqu(null==i?null:i.currency)}}function v(t,e){if(1&t){var n=T.EpF();T.TgZ(0,"button",13),T.NdJ("click",function(){T.CHM(n);var t=T.oxw().$implicit;return T.oxw().viewOperation(t)}),T._uU(1," View "),T.qZA()}}function q(t,e){if(1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"td"),T._uU(2),T.qZA(),T.TgZ(3,"td"),T._uU(4),T.qZA(),T.TgZ(5,"td"),T._uU(6),T.qZA(),T.TgZ(7,"td"),T._uU(8),T.qZA(),T.TgZ(9,"td"),T._uU(10),T.qZA(),T.TgZ(11,"td"),T._uU(12),T.qZA(),T.TgZ(13,"td"),T._uU(14),T.qZA(),T.TgZ(15,"td"),T._uU(16),T.qZA(),T.TgZ(17,"td"),T._uU(18),T.qZA(),T.TgZ(19,"td"),T._uU(20),T.qZA(),T.TgZ(21,"td"),T.YNc(22,v,2,0,"button",12),T.qZA(),T.qZA()),2&t){var n=e.$implicit;T.xp6(2),T.Oqu(null==n?null:n.account),T.xp6(2),T.Oqu(null==n?null:n.ccyCd),T.xp6(2),T.Oqu(null==n?null:n.branchCode),T.xp6(2),T.Oqu(null==n?null:n.amount),T.xp6(2),T.Oqu(null==n?null:n.lcyEquivalent),T.xp6(2),T.Oqu(null==n?null:n.drCr),T.xp6(2),T.Oqu(null==n?null:n.exchRate),T.xp6(2),T.Oqu(null==n?null:n.relatedAccount),T.xp6(2),T.Oqu(null==n?null:n.addlText),T.xp6(2),T.Oqu(null==n?null:n.acumenJournal),T.xp6(2),T.Q6J("ngIf",n.versionNo>=1)}}function O(t,e){if(1&t){var n=T.EpF();T.TgZ(0,"button",14),T.NdJ("click",function(){return T.CHM(n),T.oxw().approveSecondLevel()}),T._uU(1," Approve Data "),T.qZA()}}var _,x=[{path:"",component:(_=function(){function e(t,n,i){r(this,e),this.api=t,this.userApi=n,this.excelService=i,this.respArray=[],this.dtOptions={},this.dtTrigger1=new h.xQ,this.dtTrigger2=new h.xQ,this.pendingForAuthData=[],this.pendingForAuthDetailsListAll=[],this.excelDataAuthSecondAuditlog=new g.n,this.pipe=new o.uU("en-US"),this.firstAndSecondAuthAuditLogRespDTO=new p.U,this.name=new u.NI(""),this.button_permission={},this.now=Date.now(),this.dataForProcessScreen1=[]}return i(e,[{key:"ngOnInit",value:function(){this.firstLevelAuthorizationStatus={},this.user_id=sessionStorage.getItem("user_id"),this.role=sessionStorage.getItem("user_role"),this.getPendingForAuthData(),this.dtOptions[0]={pagingType:"full_numbers",pageLength:5,columnDefs:[{type:"date",targets:[4]}],order:[[4,"desc"]],processing:!0,lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]]},this.dtOptions[1]={pagingType:"full_numbers",pageLength:5,processing:!0,retrieve:!0,lengthMenu:[[5,10,20,-1],[5,10,20,30]]}}},{key:"ngOnDestroy",value:function(){this.dtTrigger1.unsubscribe(),this.dtTrigger2.unsubscribe()}},{key:"screenpermission",value:function(){var t=this;this.screenName="DataAmendAuthorization",this.userApi.getRoleScreenPermission(this.user_id,this.screenName,this.role).subscribe(function(e){t.rolepermission=e,console.log(t.rolepermission),t.rolepermission&&(t.button_permission=t.rolepermission[0])})}},{key:"extractFilename",value:function(t){var e=t.split("/");return e[e.length-1]}},{key:"getAuditLogData",value:function(t){var e=this;this.api.getFirstAndSecondAuthAuditService(this.getDetailsQueryToggleReqDTO).subscribe(function(t){e.firstAndSecondAuthAuditLogRespDTO=t})}},{key:"approveSecondLevel",value:function(){var t=this;if(this.pendingForAuthDetailsListAll&&(this.todaydate=this.pipe.transform(this.now,"dd-MMM-yy"),this.uploaddate=this.pipe.transform(this.pendingForAuthDetailsListAll[0].uploadDate,"dd-MMM-yy"),console.log("date for compare",this.todaydate,this.uploaddate),this.todaydate!==this.uploaddate))return console.log("inside if"),void A().fire("Unable to authorized.","backdated authorization not allowed.");this.user_id!==this.pendingForAuthDetailsListAll[0].inputBy?(this.flag=!1,this.progress=!0,this.api.authorizeSecondLevel(this.pendingForAuthDetailsListAll,localStorage.getItem("currentUser")).subscribe(function(e){t.firstLevelAuthorizationStatus=e,console.log(t.firstLevelAuthorizationStatus),t.firstLevelAuthorizationStatus&&(t.progress=!1,A().fire("You authorized the record to second level ")),t.firstLevelAuthorizationStatus||(t.progress=!1,A().fire("Error","You failed to authorize the record."))}),this.getPendingForAuthData()):A().fire("Maker do not have permission to authorized.")}},{key:"getAllSecondLevelAuthDetailsData",value:function(){var t=this;this.api.getSecondLevelAuthDetailsData().subscribe(function(e){t.pendingForAuthDetailsListAll=e,t.dtTrigger2.next()})}},{key:"queryDetailsDataByParam",value:function(t,e){var n=this,i=document.getElementById("btnGetDetails"+e);i.innerHTML='<span class="indicator-progress" >Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>',this.getDetailsQueryToggleReqDTO=new d.AJ,this.getDetailsQueryToggleReqDTO.batchNumber=t.batchNumber,this.api.queryDetailsDataByParamServiceSecond(t.batchNumber).subscribe(function(t){n.pendingForAuthDetailsListAll=t,i.innerHTML="<span>Get Details</span>",n.dtTrigger2.next(),console.log(n.pendingForAuthDetailsListAll),n.pendingForAuthDetailsListAll.length>0?(n.flag=!0,n.flag1=!0,n.getAuditLogData(n.getDetailsQueryToggleReqDTO)):A().fire("Edit the data from modify excel screen","No data found.")})}},{key:"getDataWithOldAndNewValue",value:function(t){var e=this;this.deUploadPendingForAuthDTO=t,this.getDetailsQueryToggleReqDTO=new d.AJ,this.getDetailsQueryToggleReqDTO.externalSysName=this.deUploadPendingForAuthDTO.externalSysName,this.getDetailsQueryToggleReqDTO.processName=this.deUploadPendingForAuthDTO.processName,this.getDetailsQueryToggleReqDTO.processingDate=this.deUploadPendingForAuthDTO.processingDate,this.getDetailsQueryToggleReqDTO.currency=this.deUploadPendingForAuthDTO.currency,this.api.queryDetailsDataByParamService(this.getDetailsQueryToggleReqDTO).subscribe(function(t){e.detailsDataForFlex=t})}},{key:"approveAndProcess",value:function(){var t=this;this.spinner=!0,this.deUploadReqDTO=new d.Qz,this.deUploadReqDTO.pendingForAuthDTO=this.deUploadPendingForAuthDTO,this.deUploadReqDTO.pendingForAuthDetailsDTOList=this.detailsDataForFlex,this.api.processDeUpload(this.deUploadReqDTO,this.user_id).subscribe(function(e){t.deUploadStatus=e,"FAILURE"===t.deUploadStatus.statusMessage&&(t.spinner=!1,t.openSnackBar("Data Failed to Upload In Demodule","")),"SUCCESS"===t.deUploadStatus.statusMessage&&(t.spinner=!1,t.openSnackBar("Data Successfully Uploaded TO DeUpload",""))},function(e){c.UA&&(t.spinner=!1,A().fire("Error","Failed to connect to flexcube"))})}},{key:"getPendingForAuthData",value:function(){var t=this;this.api.getPendingForAuthDataFirstError(this.user_id).subscribe(function(e){t.pendingForAuthData=e,t.dtTrigger1.next(),t.dtTrigger1.complete(),console.log(t.pendingForAuthData)})}},{key:"doValidationOfString",value:function(t,e){return t===e}},{key:"openSnackBar",value:function(t,e){A().fire(t)}},{key:"viewOperation",value:function(e){this.getDataWithOldAndNewValue(e),console.log(e),console.log(l),this.dummyPendingForAuthDataDetailsSecond=new Array;var n,i=e.id.sourceCode,r=e.id.branchCode,a=e.id.batchNo,o=e.id.initiationDate,s=e.id.currNo,u=t(this.pendingForAuthDetailsListAll);try{for(u.s();!(n=u.n()).done;){var d=n.value;d.id.sourceCode===i&&d.id.branchCode===r&&d.id.batchNo===a&&d.id.initiationDate===o&&d.id.currNo===s&&this.dummyPendingForAuthDataDetailsSecond.push(d)}}catch(c){u.e(c)}finally{u.f()}this.openDialog(this.dummyPendingForAuthDataDetailsSecond)}},{key:"openDialog",value:function(t){}},{key:"downloadData",value:function(){var t=this;this.button1=!1,console.log(this.dummyPendingForAuthDataDetailsSecond),this.dummyPendingForAuthDataDetailsSecond.forEach(function(e){t.dataForProcessScreen1.push({Source_Code:e.id.sourceCode,Process_Code:e.processCode,Branch_Code:e.id.branchCode,Batch_No:e.id.batchNo,Value_Date:t.pipe.transform(e.valueDate,"dd-MMM-yy"),Account:e.account,Account_Branch:e.accountBranch,Currency:e.ccyCd,Amount:e.amount,DrCr:e.drCr,LcyEquivalent:e.lcyEquivalent,Curr_No:e.id.currNo,Addl_Text:e.addlText,TreasuryReference:e.acumenJournal,Trn_Code:e.txnCode,Period_Code:e.periodCode,Financial_Cycle:e.finCycle,Upload_Date:t.pipe.transform(e.uploadDate,"dd-MMM-yy"),Input_By:e.inputBy,Input_Time:t.pipe.transform(e.inputTime,"dd-MMM-yy"),Related_Customer:e.relCust,Related_Account:e.relatedAccount,Related_Reference:e.relatedRef}),console.log(t.dataForProcessScreen1)}),console.log("final data",this.dataForProcessScreen1),this.excelService.exportAsExcelFile(this.dataForProcessScreen1,"Excel_Upload_Data"),this.dataForProcessScreen1=[""]}}]),e}(),_.\u0275fac=function(t){return new(t||_)(T.Y36(m.sM),T.Y36(y.fz),T.Y36(b.x))},_.\u0275cmp=T.Xpm({type:_,selectors:[["npr-authorize-modification"]],decls:58,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"pageTitle","my-3","text-center"],[1,"dbCardStyle","table-responsive"],["id","dbTable1","datatable","",1,"dataTable","table","tableStyle","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],["id","dbTable2","datatable","",1,"dataTable","table","tableStyle","nowrap",2,"width","100%",3,"dtOptions","dtTrigger"],[1,"btnCol","mt-md-4","mt-3"],["href","javascript:void(0)",1,"btn","smBtn","btnDarkGrey"],["class","btn smBtn btnPrimary ","style","height : 90%",3,"click",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"id","click"],[3,"click",4,"ngIf"],[3,"click"],[1,"btn","smBtn","btnPrimary",2,"height","90%",3,"click"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"h2",2),T._uU(3,"Authorize Modifications"),T.qZA(),T.qZA(),T.TgZ(4,"h2",3),T._uU(5,"Pending for Authorization"),T.qZA(),T.TgZ(6,"div",4),T.TgZ(7,"table",5),T.TgZ(8,"thead"),T.TgZ(9,"tr"),T.TgZ(10,"th"),T._uU(11,"process detail"),T.qZA(),T.TgZ(12,"th"),T._uU(13,"external system"),T.qZA(),T.TgZ(14,"th"),T._uU(15,"batch number"),T.qZA(),T.TgZ(16,"th"),T._uU(17,"process name"),T.qZA(),T.TgZ(18,"th"),T._uU(19,"processing date"),T.qZA(),T.TgZ(20,"th"),T._uU(21,"file name"),T.qZA(),T.TgZ(22,"th"),T._uU(23,"currancy"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(24,"tbody"),T.YNc(25,Z,17,10,"tr",6),T.qZA(),T.qZA(),T.qZA(),T.TgZ(26,"div",4),T.TgZ(27,"table",7),T.TgZ(28,"thead"),T.TgZ(29,"tr"),T.TgZ(30,"th"),T._uU(31,"account"),T.qZA(),T.TgZ(32,"th"),T._uU(33,"currency"),T.qZA(),T.TgZ(34,"th"),T._uU(35,"branch"),T.qZA(),T.TgZ(36,"th"),T._uU(37,"amount"),T.qZA(),T.TgZ(38,"th"),T._uU(39,"lcy ammount"),T.qZA(),T.TgZ(40,"th"),T._uU(41,"dR/cr"),T.qZA(),T.TgZ(42,"th"),T._uU(43,"exchange rate"),T.qZA(),T.TgZ(44,"th"),T._uU(45,"related acc"),T.qZA(),T.TgZ(46,"th"),T._uU(47,"add text"),T.qZA(),T.TgZ(48,"th"),T._uU(49,"treasury reference"),T.qZA(),T.TgZ(50,"th"),T._uU(51,"Process"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(52,"tbody"),T.YNc(53,q,23,11,"tr",6),T.qZA(),T.qZA(),T.qZA(),T.TgZ(54,"div",8),T.TgZ(55,"a",9),T._uU(56,"Export +"),T.qZA(),T.YNc(57,O,2,0,"button",10),T.qZA(),T.qZA()),2&t&&(T.xp6(7),T.Q6J("dtOptions",e.dtOptions[0])("dtTrigger",e.dtTrigger1),T.xp6(18),T.Q6J("ngForOf",e.pendingForAuthData),T.xp6(2),T.Q6J("dtOptions",e.dtOptions[1])("dtTrigger",e.dtTrigger2),T.xp6(26),T.Q6J("ngForOf",e.pendingForAuthDetailsListAll),T.xp6(4),T.Q6J("ngIf",e.flag))},directives:[D.G,o.sg,o.O5],pipes:[o.uU],styles:["table.tableStyle[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:9px;text-transform:uppercase;letter-spacing:1px;padding:16px 13px;border-bottom:1px solid #F5F5F5}"]}),_)}],U=function(){var t=i(function t(){r(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=T.oAB({type:t}),t.\u0275inj=T.cJS({imports:[[s.Bz.forChild(x)],s.Bz]}),t}(),S=function(){var t=i(function t(){r(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=T.oAB({type:t}),t.\u0275inj=T.cJS({imports:[[o.ez,U,D.T]]}),t}()}}])}();