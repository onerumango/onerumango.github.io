"use strict";(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[363],{17988:function(e,t,o){o.d(t,{G:function(){return s},T:function(){return r}});var i=o(37716),s=function(){function e(e,t,o){this.el=e,this.vcr=t,this.renderer=o,this.dtOptions={}}return e.prototype.ngOnInit=function(){var e=this;this.dtTrigger?this.dtTrigger.subscribe(function(t){e.displayTable(t)}):this.displayTable(null)},e.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},e.prototype.displayTable=function(e){var t=this;e&&(this.dtOptions=e),this.dtInstance=new Promise(function(e,o){Promise.resolve(t.dtOptions).then(function(i){0===Object.keys(i).length&&0===$("tbody tr",t.el.nativeElement).length?o("Both the table and dtOptions cannot be empty"):setTimeout(function(){var o={rowCallback:function(e,o,s){if(i.columns){var l=i.columns;t.applyNgPipeTransform(e,l),t.applyNgRefTemplate(e,l,o)}i.rowCallback&&i.rowCallback(e,o,s)}};o=Object.assign({},i,o),t.dt=$(t.el.nativeElement).DataTable(o),e(t.dt)})})})},e.prototype.applyNgPipeTransform=function(e,t){t.filter(function(e){return e.ngPipeInstance&&!e.ngTemplateRef}).forEach(function(o){var i=o.ngPipeInstance,s=t.findIndex(function(e){return e.data===o.data}),l=e.childNodes.item(s),r=$(l).text(),n=i.transform(r);$(l).text(n)})},e.prototype.applyNgRefTemplate=function(e,t,o){var i=this;t.filter(function(e){return e.ngTemplateRef&&!e.ngPipeInstance}).forEach(function(s){var l=s.ngTemplateRef,r=l.ref,n=l.context,c=t.findIndex(function(e){return e.data===s.data}),a=e.childNodes.item(c);$(a).html("");var d=Object.assign({},n,null==n?void 0:n.userData,{adtData:o}),h=i.vcr.createEmbeddedView(r,d);i.renderer.appendChild(a,h.rootNodes[0])})},e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(i.s_b),i.Y36(i.Qsj))},e.\u0275dir=i.lG2({type:e,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),e}(),l=o(38583),r=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[l.ez]]}),e}()},9363:function(e,t,o){o.r(t),o.d(t,{RolesModule:function(){return $}});var i=o(38583),s=o(39895),l=o(50215),r=o(3679),n=o(41211),c=o(79765),a=o(35383);class d{}class h{}var u=o(88259),m=o.n(u),g=o(37716),f=o(77382),b=o(94761),p=o(80463);function Z(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1," Please Enter RoleName "),g.qZA())}function T(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1," RoleName cannot contain space "),g.qZA())}function S(e,t){if(1&e&&(g.TgZ(0,"div",25),g.YNc(1,Z,2,0,"div",26),g.YNc(2,T,2,0,"div",26),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.myform.get("roleName").errors.required),g.xp6(1),g.Q6J("ngIf",e.myform.get("roleName").errors.cannotContainSpace)}}function R(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1," Please Enter RoleDesc "),g.qZA())}function A(e,t){if(1&e&&(g.TgZ(0,"div",25),g.YNc(1,R,2,0,"div",26),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.myform.get("roleDesc").errors.required)}}function y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",28),g.NdJ("click",function(){const t=g.CHM(e).$implicit;return g.oxw().getPermission(t.tabId,t.tabName)}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=t.$implicit,o=g.oxw();g.xp6(1),g.Q6J("ngClass",e.tabName==o.btnNameSelected?"active":"notActive")("disabled",o.editFlag),g.xp6(1),g.Oqu(e.tabName)}}function O(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td"),g.TgZ(2,"span",29),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"td"),g.TgZ(5,"div",17),g.TgZ(6,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"SELECTALL",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(7,"td"),g.TgZ(8,"div",17),g.TgZ(9,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"VIEW",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(10,"td"),g.TgZ(11,"div",17),g.TgZ(12,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"NEW",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(13,"td"),g.TgZ(14,"div",17),g.TgZ(15,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"EDIT",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(16,"td"),g.TgZ(17,"div",17),g.TgZ(18,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"AUTH",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(19,"td"),g.TgZ(20,"div",17),g.TgZ(21,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"DELETE",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(22,"td"),g.TgZ(23,"div",17),g.TgZ(24,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"CLOSE",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(25,"td"),g.TgZ(26,"div",17),g.TgZ(27,"input",18),g.NdJ("click",function(t){const o=g.CHM(e),i=o.$implicit,s=o.index;return g.oxw().clickRoleAction(i,"REOPEN",t.target.checked,s)}),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=t.$implicit,o=g.oxw();g.xp6(3),g.Oqu(e.Screens),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked",o.selectAllChecked),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.VIEW),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.NEW),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.EDIT),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.AUTH),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.DELETE),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.CLOSE),g.xp6(3),g.Q6J("disabled",o.editFlag)("checked","0"!=e.REOPEN)}}const E=function(){return["/roles/list"]};function v(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",30),g.TgZ(1,"div",27),g.TgZ(2,"button",31),g.NdJ("click",function(){return g.CHM(e),g.oxw().onSubmit()}),g._uU(3,"Save"),g.qZA(),g.qZA(),g.TgZ(4,"div",27),g.TgZ(5,"button",32),g._uU(6,"Exit"),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=g.oxw();g.xp6(2),g.uIk("disabled",!e.myform.valid||e.submitBtn),g.xp6(3),g.Q6J("routerLink",g.DdM(2,E))}}function N(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",34),g.NdJ("click",function(){return g.CHM(e),g.oxw(2).editValues()}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(2),g.hij("",e.roleCodes.edit.labelDescription," ")}}function q(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",35),g.NdJ("click",function(){return g.CHM(e),g.oxw(2).modifyRoles()}),g._uU(2,"Save"),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(1),g.Q6J("disabled",!e.myform.dirty&&e.isDisable)}}function I(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",36),g.NdJ("click",function(){g.CHM(e);const t=g.oxw(2);return t.verifyRole(t.modifyRoleObject.roleName)}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(1),g.Q6J("hidden",e.enableEdit)("disabled",e.authBtn),g.xp6(1),g.Oqu(e.roleCodes.auth.labelDescription)}}function C(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",37),g.NdJ("click",function(){g.CHM(e);const t=g.oxw(2);return t.reopenRecord(t.modifyRoleObject.roleName)}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(1),g.Q6J("hidden",!e.openHide||e.enableEdit),g.xp6(1),g.Oqu(e.roleCodes.reopen.labelDescription)}}function L(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",37),g.NdJ("click",function(){g.CHM(e);const t=g.oxw(2);return t.closeRecord(t.modifyRoleObject.roleName)}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(1),g.Q6J("hidden",!e.closeHide||e.enableEdit),g.xp6(1),g.Oqu(e.roleCodes.close.labelDescription)}}function x(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",27),g.TgZ(1,"button",37),g.NdJ("click",function(){g.CHM(e);const t=g.oxw(2);return t.deleteRole(t.modifyRoleObject.roleName)}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw(2);g.xp6(1),g.Q6J("hidden",e.enableEdit),g.xp6(1),g.Oqu(e.roleCodes.delete.labelDescription)}}function D(e,t){if(1&e&&(g.TgZ(0,"div",14),g.TgZ(1,"div",30),g.YNc(2,N,3,1,"div",33),g.YNc(3,q,3,1,"div",33),g.YNc(4,I,3,3,"div",33),g.YNc(5,C,3,2,"div",33),g.YNc(6,L,3,2,"div",33),g.YNc(7,x,3,2,"div",33),g.TgZ(8,"div",27),g.TgZ(9,"button",32),g._uU(10,"Exit"),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Q6J("ngIf",e.editFlag&&e.roleCodes.edit&&("Open"==e.modifyRoleObject.recordStatus||"OPEN"==e.modifyRoleObject.recordStatus)),g.xp6(1),g.Q6J("ngIf",!e.editFlag),g.xp6(1),g.Q6J("ngIf",("UNAUTHORIZED"==e.modifyRoleObject.authStatus||"Unauthorized"==e.modifyRoleObject.authStatus||"U"==e.modifyRoleObject.authStatus)&&e.roleCodes.auth),g.xp6(1),g.Q6J("ngIf",("CLOSED"==e.modifyRoleObject.recordStatus||"Close"==e.modifyRoleObject.recordStatus||"C"==e.modifyRoleObject.recordStatus)&&("YES"==e.modifyRoleObject.firstTimeAuth||"Y"==e.modifyRoleObject.firstTimeAuth)&&e.roleCodes.reopen),g.xp6(1),g.Q6J("ngIf",("OPEN"==e.modifyRoleObject.recordStatus||"Open"==e.modifyRoleObject.recordStatus||"O"==e.modifyRoleObject.recordStatus)&&("YES"==e.modifyRoleObject.firstTimeAuth||"Y"==e.modifyRoleObject.firstTimeAuth)&&e.roleCodes.close),g.xp6(1),g.Q6J("ngIf",("NO"==e.modifyRoleObject.firstTimeAuth||"N"==e.modifyRoleObject.firstTimeAuth)&&e.roleCodes.delete),g.xp6(2),g.Q6J("routerLink",g.DdM(7,E))}}function j(e,t){if(1&e&&(g.TgZ(0,"div",5),g.TgZ(1,"div",38),g.TgZ(2,"div",39),g.TgZ(3,"div",40),g.TgZ(4,"div",41),g.TgZ(5,"div",27),g.TgZ(6,"div",42),g._UZ(7,"i",43),g.qZA(),g.qZA(),g.TgZ(8,"div",44),g.TgZ(9,"div",45),g.TgZ(10,"h2"),g._uU(11,"Maker"),g.qZA(),g.TgZ(12,"p"),g._uU(13),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"div",39),g.TgZ(15,"div",40),g.TgZ(16,"div",41),g.TgZ(17,"div",27),g.TgZ(18,"div",46),g._UZ(19,"img",47),g.qZA(),g.qZA(),g.TgZ(20,"div",44),g.TgZ(21,"div",45),g.TgZ(22,"h2"),g._uU(23,"Maker Time Stamp"),g.qZA(),g.TgZ(24,"p"),g._uU(25),g.ALo(26,"date"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(27,"div",39),g.TgZ(28,"div",40),g.TgZ(29,"div",41),g.TgZ(30,"div",27),g.TgZ(31,"div",48),g._UZ(32,"i",49),g.qZA(),g.qZA(),g.TgZ(33,"div",44),g.TgZ(34,"div",45),g.TgZ(35,"h2"),g._uU(36,"Record Status"),g.qZA(),g.TgZ(37,"p"),g._uU(38),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(39,"div",39),g.TgZ(40,"div",40),g.TgZ(41,"div",41),g.TgZ(42,"div",27),g.TgZ(43,"div",50),g._UZ(44,"i",51),g.qZA(),g.qZA(),g.TgZ(45,"div",44),g.TgZ(46,"div",45),g.TgZ(47,"h2"),g._uU(48,"Checker"),g.qZA(),g.TgZ(49,"p"),g._uU(50),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(51,"div",39),g.TgZ(52,"div",40),g.TgZ(53,"div",41),g.TgZ(54,"div",27),g.TgZ(55,"div",52),g._UZ(56,"img",53),g.qZA(),g.qZA(),g.TgZ(57,"div",44),g.TgZ(58,"div",45),g.TgZ(59,"h2"),g._uU(60,"Checker Time Stamp"),g.qZA(),g.TgZ(61,"p"),g._uU(62),g.ALo(63,"date"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(64,"div",39),g.TgZ(65,"div",40),g.TgZ(66,"div",41),g.TgZ(67,"div",27),g.TgZ(68,"div",54),g._UZ(69,"i",55),g.qZA(),g.qZA(),g.TgZ(70,"div",44),g.TgZ(71,"div",45),g.TgZ(72,"h2"),g._uU(73,"First Time Authorization"),g.qZA(),g.TgZ(74,"p"),g._uU(75),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(76,"div",39),g.TgZ(77,"div",40),g.TgZ(78,"div",41),g.TgZ(79,"div",27),g.TgZ(80,"div",56),g._UZ(81,"img",57),g.qZA(),g.qZA(),g.TgZ(82,"div",44),g.TgZ(83,"div",45),g.TgZ(84,"h2"),g._uU(85,"Authorization Status"),g.qZA(),g.TgZ(86,"p"),g._uU(87),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(88,"div",39),g.TgZ(89,"div",40),g.TgZ(90,"div",41),g.TgZ(91,"div",27),g.TgZ(92,"div",56),g._UZ(93,"img",58),g.qZA(),g.qZA(),g.TgZ(94,"div",44),g.TgZ(95,"div",45),g.TgZ(96,"h2"),g._uU(97,"Modification Number"),g.qZA(),g.TgZ(98,"p"),g._uU(99),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&e){const e=g.oxw();g.xp6(13),g.Oqu(e.modifyRoleObject.makerId),g.xp6(12),g.Oqu(g.xi3(26,8,e.modifyRoleObject.makerDtStamp,"MM/dd/yyyy, h:mm a")),g.xp6(13),g.Oqu(e.modifyRoleObject.recordStatus),g.xp6(12),g.Oqu(e.modifyRoleObject.checkerId),g.xp6(12),g.Oqu(g.xi3(63,11,e.modifyRoleObject.checkerDtStamp,"MM/dd/yyyy, h:mm a")),g.xp6(13),g.Oqu(e.modifyRoleObject.firstTimeAuth),g.xp6(12),g.Oqu(e.modifyRoleObject.authStatus),g.xp6(12),g.Oqu(e.modifyRoleObject.version)}}let k=(()=>{class e{constructor(e,t,o,i,s,l,r,n,u){this.roleService=e,this.api=t,this.route=o,this.formBuilder=i,this.router=s,this.cdr=l,this.iziToast=r,this.modalService=n,this.canDeactivateGuard=u,this.roleCodes=new a.yv,this.modifyRoleObject=new h,this.previouschecklist=[],this.checkedlist=[],this.screenName=[],this.modifyScreen=!1,this.editFlag=!1,this.enableEdit=!1,this.newRolesData=new d,this.checkAll=!1,this.openBtn=!0,this.closeBtn=!0,this.authBtn=!1,this.openHide=!0,this.closeHide=!0,this.isDisable=!0,this.formTouched=!0,this.closeResult="",this.selectAllChecked=!1,this.showDialog=!1,this.subject=new c.xQ}ngOnInit(){this.roleNavObj=localStorage.getItem("roleNavObj"),this.roleNavigationObject=JSON.parse(this.roleNavObj),this.roleService.getIndexValue().subscribe(e=>{console.log(e),this.paramScreen=e,""===e.index&&this.createRole()}),this.username=localStorage.getItem("userFromLogin").replace(/['"]+/g,""),this.navSubscription=this.roleService.getNavParam.subscribe(e=>this.editRoleScreen=e),console.log(this.editRoleScreen),this.editFlag=!1,this.modifyRoleObject.id=this.editRoleScreen.queryParams.id,this.modifyRoleObject.roleName=this.editRoleScreen.queryParams.roleName,this.modifyRoleObject.roleDesc=this.editRoleScreen.queryParams.roleDesc,this.modifyRoleObject.makerId=this.editRoleScreen.queryParams.makerId,this.modifyRoleObject.makerDtStamp=this.editRoleScreen.queryParams.makerDtStamp,this.modifyRoleObject.checkerId=this.editRoleScreen.queryParams.checkerId,this.modifyRoleObject.checkerDtStamp=this.editRoleScreen.queryParams.checkerDtStamp,this.modifyRoleObject.recordStatus=this.editRoleScreen.queryParams.recordStatus,this.modifyRoleObject.version=this.editRoleScreen.queryParams.version,console.log(this.modifyRoleObject),this.modifyRoleObject.recordStatus="Open"==this.modifyRoleObject.recordStatus?"OPEN":"C"==this.modifyRoleObject.recordStatus?"CLOSED":this.editRoleScreen.queryParams.recordStatus,this.modifyRoleObject.authStatus=this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.authStatus="A"==this.modifyRoleObject.authStatus?"AUTHORIZED":"U"==this.modifyRoleObject.authStatus?"UNAUTHORIZED":this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.firstTimeAuth=this.editRoleScreen.queryParams.firstTimeAuth,this.modifyRoleObject.firstTimeAuth="Y"==this.modifyRoleObject.firstTimeAuth?"YES":"N"==this.modifyRoleObject.firstTimeAuth?"NO":this.editRoleScreen.queryParams.firstTimeAuth,console.log(this.roleNavigationObject),null!=JSON.parse(this.roleNavObj)&&(console.log("Inside If"),this.buildRoleForm(this.roleNavigationObject),this.modifyRoleObject=this.roleNavigationObject),(null==this.modifyRoleObject.roleName&&"new"==this.paramScreen.index||null==this.roleNavigationObject)&&(console.log("Undesfined"),this.buildRoleForm(this.modifyRoleObject)),this.fetchdynamicroles(),this.roleService.fetchScreenPermissions("Roles"),this.roleService.screenLabelList.subscribe(e=>this.roleCodes=e),(this.modifyRoleObject.roleName||this.roleNavigationObject.roleName)&&(this.modifyScreen=!0,this.editFlag=!0),this.auditLog()}buildRoleForm(e){console.log(e),this.myform=this.formBuilder.group({roleName:[e.roleName?e.roleName:"",[r.kI.required,w.cannotContainSpace]],roleDesc:[e.roleDesc?e.roleDesc:"",r.kI.required]})}preparingPermissiondto(e,t){let o=[];for(let i=0;i<e.length;i++){let s={roleName:"",screenId:e[i].screensId.screenId},l=[];for(let e=0;e<t;e++)l.push(0);let r=l.join("");o.push({permissionId:s,permissions:r})}return o}editValues(){this.enableEdit=!0,this.editFlag=!1,this.openBtn=!1,this.closeBtn=!1,this.submitBtn=!0}getPermission(e,t){this.btnNameSelected=t,null!=e||null!=e?(this.rolestype(e),console.log("inside If")):(this.rolestype(1),console.log("Else")),this.roleService.fetchScreenPermissions("Roles")}verifyRole(e){console.log(e,this.username),this.modifyRoleObject.makerId!==this.username?m().fire({text:"You are trying to Authorize record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.verifyRole(e,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,this.modifyRoleObject&&(this.auditLog(),m().fire({text:"Role is Authorized",icon:"success"}))})}):m().fire({text:"Maker Cannot Authorize Record!",icon:"error"})}closeRecord(e){m().fire({text:"You are trying to Closed record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.closelockRecord(e,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,console.log("role is closed",this.updatedRoleObject.recordStatus),this.openBtn=!1,this.closeBtn=!1,this.updatedRoleObject&&(this.auditLog(),m().fire({text:"Role is Closed",icon:"success"}))})}),!1===this.updatedRoleObject&&m().fire({icon:"error",text:"Failed to Closed Record "})}reopenRecord(e){m().fire({text:"You are trying to Reopen record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.reopenRecord(e,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,console.log("user is reopened"),this.openBtn=!1,this.closeBtn=!1,this.updatedRoleObject&&(this.auditLog(),m().fire({text:"Role is Reopened",icon:"success"}))})}),!1===this.deleteStatusFlag&&m().fire({icon:"error",text:"Failed to Reopened Record "})}deleteRole(e){m().fire({text:"You are trying to Delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.deleteRole(e,this.username).subscribe(e=>{this.deleteStatusFlag=e,this.deleteStatusFlag&&(m().fire({text:"Role is Deleted",icon:"success"}),this.router.navigate(["/roles/list"]))})}),!1===this.deleteStatusFlag&&m().fire({icon:"error",text:"Failed to Delete Record "})}button(){this.isDisable=!1}modifyRoles(){let e=[];for(let o=0;o<this.rolessorteddata.length;o++){let t=this.rolessorteddata[o].screenlist;for(let o=0;o<t.length;o++)if(t[o].permission.toString()!=t[o].newpermission.toString()){let i=this.newRolesData.permissionDto.findIndex(function(e){return e.permissionId.screenId==t[o].screenid});if(i>=0){let s={permissionId:this.newRolesData.permissionDto[i].permissionId};s.permissions=t[o].newpermission,e.push(s)}}}let t={roleDto:this.newRolesData.roleDto};t.permissionDto=e,console.log(t),t.roleDto.roleDesc=this.myform.get("roleDesc").value,t.roleDto.makerId=this.username,this.roleService.newmodifyRoleService(t).subscribe(e=>{this.validationResponse=e,this.cdr.markForCheck();let t=localStorage.getItem("userFromLogin");this.roleService.fetchNewRolePermissions(t),console.log(this.validationResponse),this.modifyRoleObject=this.validationResponse,console.log(this.modifyRoleObject),this.validationResponse?(m().fire("Role is Updated "),this.formTouched=!this.myform.touched,this.submitBtn=!0,this.editFlag=!0,this.enableEdit=!1,console.log("IF IF IF IF IF"),this.auditLog(),console.log(this.modifyRoleObject),console.log(this.roleCodes)):(m().fire({icon:"error",text:"Server Error "}),console.log("ELSE ELSE ELSE ELSE"))})}fetchdynamicroles(){console.log(this.roleNavigationObject),null!=this.roleNavigationObject&&(this.modifyRoleObject.roleName=this.roleNavigationObject.roleName),null!=this.modifyRoleObject.roleName?this.roleService.fetchdynamicrolesdata(this.modifyRoleObject.roleName).subscribe(e=>{console.log("fetch",e),this.newRolesData.roleDto=e.roleDto,this.newRolesData.permissionDto=e.permissionDto,this.newRolesData.tabDto=e.tabDto,this.newRolesData.labelDto=e.labelDto,this.newRolesData.screenDto=e.screenDto;let t=[],o=e.screenDto,i=e.labelDto,s=e.permissionDto;if(console.log(this.newRolesData,"New roles Data"),s&&s.length<e.screenDto.length){let t="";if(e.labelDto){let o=[];for(let t=0;t<e.labelDto.length;t++)o.push(0);t=o.join("")}for(let o=0;o<e.screenDto.length;o++){let i=e.screenDto[o];-1==s.findIndex(function(e){return e.permissionId.screenId==i.screensId.screenId})&&s.push({permissionId:{roleName:this.modifyRoleObject.roleName,screenId:i.screensId.screenId},permissions:t})}}this.screenName=this.newRolesData.tabDto;let l=[];for(let r=0;r<this.screenName.length;r++)l[this.screenName[r].tabId-1]=this.screenName[r];this.screenName=[];for(let r=0;r<l.length;r++)null!=l[r]&&(this.screenName[this.screenName.length]=l[r]);console.log(this.btnNameSelected),(null==this.btnNameSelected||null==this.btnNameSelected)&&(this.btnNameSelected=this.screenName[0].tabName);for(let r=0;r<e.tabDto.length;r++){let l=[],n=[],c=e.tabDto[r];n=this.getscreenlist(o,c,s,l,n);let a=c.visibility.toString(),d=[],h=[];for(let e=0;e<a.length;e++)1==a.charAt(e)&&(d.push(i[e].labelName),h.push(i[e]));t.push({tabId:c.tabId,tabname:c.tabName,screens:l,screenlist:n,labels:d,labelslist:h})}this.rolessorteddata=t,this.rolestype(1),console.log("arrayc",t)}):this.roleService.fetchnewscreenlabels().subscribe(e=>{let t=this.preparingPermissiondto(e.screenDto,e.labelDto.length);this.newRolesData.roleDto=e.roleDto,this.newRolesData.permissionDto=t,this.newRolesData.tabDto=e.tabDto,this.newRolesData.labelDto=e.labelDto,this.newRolesData.screenDto=e.screenDto;let o=[],i=e.screenDto,s=e.labelDto;this.screenName=this.newRolesData.tabDto;let l=[];for(let r=0;r<this.screenName.length;r++)l[this.screenName[r].tabId-1]=this.screenName[r];this.screenName=[];for(let r=0;r<l.length;r++)null!=l[r]&&(this.screenName[this.screenName.length]=l[r]);(null==this.btnNameSelected||null==this.btnNameSelected)&&(this.btnNameSelected=this.screenName[0].tabName);for(let r=0;r<e.tabDto.length;r++){let l=[],n=[],c=e.tabDto[r];n=this.getscreenlist(i,c,t,l,n);let a=c.visibility.toString(),d=[],h=[];for(let e=0;e<a.length;e++)1==a.charAt(e)&&(d.push(s[e].labelName),h.push(s[e]));o.push({tabId:c.tabId,tabname:c.tabName,screens:l,screenlist:n,labels:d,labelslist:h})}this.rolessorteddata=o,this.rolestype(1)})}getscreenlist(e,t,o,i,s){for(let l=0;l<e.length;l++){let r=e[l];if(t.tabId==r.screensId.tabId){let e=o.findIndex(function(e){return e.permissionId.screenId==r.screensId.screenId});i.push(r.screenName),e>-1&&s.push({screenname:r.screenName,screenid:r.screensId.screenId,permission:o[e].permissions,newpermission:o[e].permissions})}}return s}rolestype(e){let t;console.log(e),t=this.rolessorteddata.findIndex(function(t){return t.tabId==e}),this.selectedtab=this.rolessorteddata[t].tabname,this.indexdata=this.rolessorteddata[t];let o=this.indexdata.labels,i=o.indexOf("Screens");this.previouschecklist.splice(t,0,this.checkedlist);let s=[];-1==i&&(o.splice(0,0,"Screens"),o.splice(1,0,"checkbox"));let l=[],r=[],n=[],c=this.indexdata.screenlist;for(let m=0;m<c.length;m++){var a={},d={},h=[{value:""},{value:""}],u=[{value:""},{value:""}];[].push(c[m].screenname),a[this.indexdata.labels[0]]=c[m].screenname,a[this.indexdata.labels[1]]="checkbox",d[this.indexdata.labels[0]]=!0,d[this.indexdata.labels[1]]=!0;let e=c[m].newpermission.toString(),t=e.length;t==(e.match(/1/g)||[]).length&&s.push(m);for(let o=0;o<t;o++)a[this.indexdata.labels[2+o]]=e.charAt(o),1==e.charAt(o)?(d[this.indexdata.labels[2+o]]=!0,h.push({value:!0}),u.push({value:!0})):(d[this.indexdata.labels[2+o]]=!1,h.push({value:!1}),u.push({value:!1}));l.push(a),r.push(h),n.push(u)}this.roleScreenList=l,console.log(this.roleScreenList);for(let m=0;m<this.roleScreenList.length;m++)console.log(this.roleScreenList[m],"AUTH INside for"),"0"==this.roleScreenList[m].NEW||"0"==this.roleScreenList[m].EDIT||"0"==this.roleScreenList[m].DELETE||"0"==this.roleScreenList[m].CLOSE||"0"==this.roleScreenList[m].REOPEN||"0"==this.roleScreenList[m].AUTH||"0"==this.roleScreenList[m].UNLOCK||"0"==this.roleScreenList[m].PRINT||"0"==this.roleScreenList[m].VIEW?(console.log("Tabs are Selected"),this.selectAllChecked=!1):this.selectAllChecked=!0}onSubmit(){this.submitted=!0,this.save()}save(){console.log(this.username),this.modifyRoleObject.makerId=this.username;let e=[];for(let o=0;o<this.rolessorteddata.length;o++){let t=this.rolessorteddata[o].screenlist;for(let o=0;o<t.length;o++){let i=this.newRolesData.permissionDto.findIndex(function(e){return e.permissionId.screenId==t[o].screenid});if(console.log(i),i>=0){console.log(this.modifyRoleObject),console.log(this.myform.get("roleName").value),this.newRolesData.permissionDto[i].permissionId.roleName=this.myform.get("roleName").value;let s={permissionId:this.newRolesData.permissionDto[i].permissionId};s.permissions=t[o].newpermission,e.push(s),console.log(e)}}}console.log(this.modifyRoleObject),this.modifyRoleObject.roleName=this.myform.get("roleName").value,this.modifyRoleObject.roleDesc=this.myform.get("roleDesc").value,console.log(this.modifyRoleObject);let t={roleDto:this.modifyRoleObject};t.permissionDto=e,console.log(t),this.roleService.createnewrole(t).subscribe(e=>{console.log(e),e?(this.modifyRoleObject=e,e&&(e.roleDto&&(this.modifyRoleObject=e.roleDto,this.modifyRoleObject.recordStatus="Open"==this.modifyRoleObject.recordStatus?"OPEN":"C"==this.modifyRoleObject.recordStatus?"CLOSE":this.editRoleScreen.queryParams.recordStatus,this.modifyRoleObject.authStatus=this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.authStatus="A"==this.modifyRoleObject.authStatus?"AUTHORIZED":this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.authStatus="UNAUTHORIZED",this.modifyRoleObject.firstTimeAuth=this.editRoleScreen.queryParams.firstTimeAuth,"Y"==this.modifyRoleObject.firstTimeAuth?this.modifyRoleObject.firstTimeAuth="YES":"N"==this.modifyRoleObject.firstTimeAuth&&(this.modifyRoleObject.firstTimeAuth="NO"),this.modifyRoleObject.firstTimeAuth="NO"),this.editFlag=!0,this.submitBtn=!0,this.modifyScreen=!0,this.auditLog(),m().fire("Role is Created"),this.fetchdynamicroles(),this.formTouched=!this.myform.touched)):e?m().fire({icon:"error",text:'"Failed ", \'Role already exist or Can\u2019t save role without any permission.'}):m().fire({icon:"error",text:"Role already exist or Can\u2019t save role without any permission."})},e=>{})}isEnabled(){let e=!0;for(let t=0;t<this.roleScreenList.length;t++)("0"==this.roleScreenList[t].NEW||"0"==this.roleScreenList[t].EDIT||"0"==this.roleScreenList[t].DELETE||"0"==this.roleScreenList[t].CLOSE||"0"==this.roleScreenList[t].REOPEN||"0"==this.roleScreenList[t].AUTH||"0"==this.roleScreenList[t].UNLOCK||"0"==this.roleScreenList[t].PRINT||"0"==this.roleScreenList[t].VIEW)&&(e=!1);return e}clickAllAction(e,t){console.log(e,t),console.log(this.roleScreenList,"Role screen list");for(let o=0;o<this.roleScreenList.length;o++)console.log(this.roleScreenList[o],"AUTH INside for"),this.roleScreenList[o].NEW=t?"1":"0",this.roleScreenList[o].EDIT=t?"1":"0",this.roleScreenList[o].DELETE=t?"1":"0",this.roleScreenList[o].CLOSE=t?"1":"0",this.roleScreenList[o].REOPEN=t?"1":"0",this.roleScreenList[o].AUTH=t?"1":"0",this.roleScreenList[o].UNLOCK=t?"1":"0",this.roleScreenList[o].PRINT=t?"1":"0",this.roleScreenList[o].VIEW=t?"1":"0",console.log(e,t),1==t&&(this.selectAllChecked=!0),0==t&&(this.selectAllChecked=!1);for(let o=0;o<this.roleScreenList.length;o++)for(let e=0;e<this.rolessorteddata.length;e++)if(this.rolessorteddata[e].tabname==this.btnNameSelected){for(let t=0;t<this.rolessorteddata[e].screenlist.length;t++)if(this.rolessorteddata[e].screenlist[t].screenname==this.roleScreenList[o].Screens){let i=this.rolessorteddata[e].screenlist[t].newpermission,s=i.split("");for(let t=0;t<this.rolessorteddata[e].labelslist.length;t++)"NEW"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].NEW),"EDIT"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].EDIT),"DELETE"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].DELETE),"CLOSE"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].CLOSE),"REOPEN"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].REOPEN),"UNLOCK"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].UNLOCK),"PRINT"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].PRINT),"AUTH"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].AUTH),"VIEW"==this.rolessorteddata[e].labelslist[t].labelName&&(s[this.rolessorteddata[e].labelslist[t].labelId-1]=this.roleScreenList[o].VIEW),i=s.join("");this.rolessorteddata[e].screenlist[t].newpermission=i}console.log(this.rolessorteddata)}console.log(this.roleScreenList)}clickRoleAction1(){this.button()}clickRoleAction(e,t,o,i){this.isDisable=!1,console.log(this.roleScreenList),console.log(e,"Roles"),console.log(t,"action"),console.log(o,"event"),this.button(),console.log(e.Screens),console.log(e.NEW),e.AUTH&&console.log(this.selectAllChecked),console.log(this.modifyRoleObject),console.log(this.modifyRoleObject.roleName),this.modifyRoleObject.roleName?(("NEW"==t||"SELECTALL"==t)&&(e.NEW=o?"1":"0",e.VIEW="1",console.log(e.NEW,"Inside New If")),("EDIT"==t||"SELECTALL"==t)&&(e.EDIT=o?"1":"0",e.VIEW="1"),("DELETE"==t||"SELECTALL"==t)&&(e.DELETE=o?"1":"0",e.VIEW="1"),("CLOSE"==t||"SELECTALL"==t)&&(e.CLOSE=o?"1":"0",e.VIEW="1"),("REOPEN"==t||"SELECTALL"==t)&&(e.REOPEN=o?"1":"0",e.VIEW="1"),("UNLOCK"==t||"SELECTALL"==t)&&(e.UNLOCK=o?"1":"0",e.VIEW="1"),("PRINT"==t||"SELECTALL"==t)&&(e.PRINT=o?"1":"0",e.VIEW="1"),("AUTH"==t||"SELECTALL"==t)&&(e.AUTH=o?"1":"0",e.VIEW="1"),("VIEW"==t||"SELECTALL"==t)&&(e.VIEW=o?"1":"0"),(1==this.roleScreenList[i].AUTH||1==this.roleScreenList[i].CLOSE||1==this.roleScreenList[i].DELETE||1==this.roleScreenList[i].EDIT||1==this.roleScreenList[i].NEW||1==this.roleScreenList[i].PRINT||1==this.roleScreenList[i].REOPEN)&&(e.VIEW="1")):(("NEW"==t||"SELECTALL"==t)&&(e.NEW=o?"1":"0",e.VIEW=o?"1":"0"),("EDIT"==t||"SELECTALL"==t)&&(e.EDIT=o?"1":"0",e.VIEW=o?"1":"0"),("DELETE"==t||"SELECTALL"==t)&&(e.DELETE=o?"1":"0",e.VIEW=o?"1":"0"),("CLOSE"==t||"SELECTALL"==t)&&(e.CLOSE=o?"1":"0",e.VIEW=o?"1":"0"),("REOPEN"==t||"SELECTALL"==t)&&(e.REOPEN=o?"1":"0",e.VIEW=o?"1":"0"),("UNLOCK"==t||"SELECTALL"==t)&&(e.UNLOCK=o?"1":"0",e.VIEW=o?"1":"0"),("PRINT"==t||"SELECTALL"==t)&&(e.PRINT=o?"1":"0",e.VIEW=o?"1":"0"),("AUTH"==t||"SELECTALL"==t)&&(e.AUTH=o?"1":"0",e.VIEW=o?"1":"0"),("VIEW"==t||"SELECTALL"==t)&&(e.VIEW=o?"1":"0"),(1==this.roleScreenList[i].AUTH||1==this.roleScreenList[i].CLOSE||1==this.roleScreenList[i].DELETE||1==this.roleScreenList[i].EDIT||1==this.roleScreenList[i].NEW||1==this.roleScreenList[i].PRINT||1==this.roleScreenList[i].REOPEN)&&(e.VIEW="1"));for(let s=0;s<this.rolessorteddata.length;s++)if(this.rolessorteddata[s].tabname==this.btnNameSelected){for(let t=0;t<this.rolessorteddata[s].screenlist.length;t++)if(this.rolessorteddata[s].screenlist[t].screenname==e.Screens){let o=this.rolessorteddata[s].screenlist[t].newpermission,i=o.split("");for(let t=0;t<this.rolessorteddata[s].labelslist.length;t++)"NEW"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.NEW),"EDIT"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.EDIT),"DELETE"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.DELETE),"CLOSE"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.CLOSE),"REOPEN"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.REOPEN),"UNLOCK"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.UNLOCK),"PRINT"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.PRINT),"AUTH"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.AUTH),"VIEW"==this.rolessorteddata[s].labelslist[t].labelName&&(i[this.rolessorteddata[s].labelslist[t].labelId-1]=e.VIEW),o=i.join("");this.rolessorteddata[s].screenlist[t].newpermission=o}console.log(e,"Roles"),console.log(this.rolessorteddata)}}reset(){this.validationResponse=null,this.modifyRoleObject=new h,this.roleScreenList=null,this.rolestype(1)}auditLog(){("U"==this.modifyRoleObject.authStatus||"Unauthorized"==this.modifyRoleObject.authStatus||"UNAUTHORIZED"==this.modifyRoleObject.authStatus)&&(this.modifyRoleObject.authStatus="UNAUTHORIZED"),("A"==this.modifyRoleObject.authStatus||"Authorized"==this.modifyRoleObject.authStatus||"AUTHORIZED"==this.modifyRoleObject.authStatus)&&(this.modifyRoleObject.authStatus="AUTHORIZED"),("O"==this.modifyRoleObject.recordStatus||"Open"==this.modifyRoleObject.recordStatus)&&(this.modifyRoleObject.recordStatus="OPEN"),("C"==this.modifyRoleObject.recordStatus||"Close"==this.modifyRoleObject.recordStatus)&&(this.modifyRoleObject.recordStatus="CLOSED"),"N"==this.modifyRoleObject.firstTimeAuth&&(console.log("NO"),this.modifyRoleObject.firstTimeAuth="NO"),"Y"==this.modifyRoleObject.firstTimeAuth&&(this.modifyRoleObject.firstTimeAuth="YES")}canExit(){let e=!1;return this.myform.touched&&1==this.formTouched?m().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>!0===t.isConfirmed?(e=!0,this.cdr.markForCheck(),e):(e=!1,this.cdr.markForCheck(),e)):(e=!0,new Promise((t,o)=>{!0===e&&(e=!0,this.cdr.markForCheck(),t(!0))}))}createRole(){this.roleService.sendNavParam({queryParams:{}})}openDialog(e){console.log(e,"DetailsDTO"),this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",windowClass:"my-class"}).result.then(e=>{this.closeResult=`Closed with: ${e}`},e=>{this.closeResult=`Dismissed ${this.getDismissReason(e)}`})}getDismissReason(e){return console.log(e),e===n.If.ESC?"by pressing ESC":e===n.If.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${e}`}accept(e){console.log(e),this.acceptval=e,"YES"==this.acceptval&&(localStorage.setItem("PageDeactivate",this.acceptval),this.pageDeactive=localStorage.getItem("PageDeactivate"),console.log(this.pageDeactive,"Page Deactivate"))}reject(){this.modalService.dismissAll()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(f.N),g.Y36(b.sM),g.Y36(s.gz),g.Y36(r.qu),g.Y36(s.F0),g.Y36(g.sBO),g.Y36(p.I),g.Y36(n.FF),g.Y36(l.I))},e.\u0275cmp=g.Xpm({type:e,selectors:[["npr-role-details"]],inputs:{modifyRoleObject:"modifyRoleObject"},decls:57,vars:12,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],["action","","novalidate","",1,"formStyle",3,"formGroup"],["roleForm","ngForm"],[1,"dbCardStyle"],[1,"row","gy-4"],[1,"col-lg-4"],["for","roleName",1,"formLbl"],[1,"colorRed"],["id","roleName","type","text","formControlName","roleName","name","roleName","placeholder","Role Name","value","",1,"form-control",3,"readonly"],["class","errorColor",4,"ngIf"],["for","roleDescription",1,"formLbl"],["id","roleDescription","type","text","formControlName","roleDesc","required","","name","roleDesc","placeholder","Tupe your Text","value","",1,"form-control",3,"readonly"],[1,"col-lg-12"],[1,"row","g-2","justify-content-center"],["class","col-auto",4,"ngFor","ngForOf"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"disabled","checked","click"],[1,"table-responsive"],["id","dbTable1",1,"table","tableStyle"],[4,"ngFor","ngForOf"],["class","row g-3 pb-3 justify-content-end pt-3",4,"ngIf"],["class","col-lg-12",4,"ngIf"],["class","dbCardStyle",4,"ngIf"],[1,"errorColor"],[4,"ngIf"],[1,"col-auto"],[1,"btn","btnOutlinePrimary",3,"ngClass","disabled","click"],[1,"link-color"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["class","col-auto",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnAuth",3,"hidden","disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"hidden","click"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/modification.svg","alt","...",1,"modImage"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h2",2),g._uU(3,"Role Management"),g.qZA(),g.qZA(),g.TgZ(4,"form",3,4),g.TgZ(6,"div",5),g.TgZ(7,"div",6),g.TgZ(8,"div",7),g.TgZ(9,"label",8),g._uU(10,"Role Name "),g.TgZ(11,"span",9),g._uU(12,"*"),g.qZA(),g.qZA(),g._UZ(13,"input",10),g.YNc(14,S,3,2,"div",11),g.qZA(),g.TgZ(15,"div",7),g.TgZ(16,"label",12),g._uU(17,"Role Description "),g.TgZ(18,"span",9),g._uU(19,"*"),g.qZA(),g.qZA(),g._UZ(20,"input",13),g.YNc(21,A,2,1,"div",11),g.qZA(),g.TgZ(22,"div",14),g.TgZ(23,"div",15),g.YNc(24,y,3,3,"div",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(25,"div",5),g.TgZ(26,"div",17),g.TgZ(27,"label"),g._uU(28,"Select ALL"),g.qZA(),g.TgZ(29,"input",18),g.NdJ("click",function(){return t.clickRoleAction1()})("click",function(e){return t.clickAllAction("SELECTALLOPT",e.target.checked)}),g.qZA(),g.qZA(),g.TgZ(30,"div",19),g.TgZ(31,"table",20),g.TgZ(32,"thead"),g.TgZ(33,"tr"),g.TgZ(34,"th"),g._uU(35,"Screen"),g.qZA(),g.TgZ(36,"th"),g._uU(37,"Select All"),g.qZA(),g.TgZ(38,"th"),g._uU(39,"View"),g.qZA(),g.TgZ(40,"th"),g._uU(41,"NEW"),g.qZA(),g.TgZ(42,"th"),g._uU(43,"EDIT"),g.qZA(),g.TgZ(44,"th"),g._uU(45,"Auth"),g.qZA(),g.TgZ(46,"th"),g._uU(47,"Delete"),g.qZA(),g.TgZ(48,"th"),g._uU(49,"Close"),g.qZA(),g.TgZ(50,"th"),g._uU(51,"Reopen"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(52,"tbody"),g.YNc(53,O,28,17,"tr",21),g.qZA(),g.qZA(),g.qZA(),g.YNc(54,v,7,3,"div",22),g.YNc(55,D,11,8,"div",23),g.qZA(),g.qZA(),g.qZA(),g.YNc(56,j,100,14,"div",24)),2&e&&(g.xp6(4),g.Q6J("formGroup",t.myform),g.xp6(9),g.Q6J("readonly",t.editFlag),g.xp6(1),g.Q6J("ngIf",t.myform.get("roleName").invalid&&(t.myform.get("roleName").dirty||t.myform.get("roleName").touched)),g.xp6(6),g.Q6J("readonly",t.editFlag),g.xp6(1),g.Q6J("ngIf",t.myform.get("roleDesc").invalid&&(t.myform.get("roleDesc").dirty||t.myform.get("roleDesc").touched)),g.xp6(3),g.Q6J("ngForOf",t.screenName),g.xp6(5),g.Q6J("disabled",t.editFlag)("checked",t.isEnabled()),g.xp6(24),g.Q6J("ngForOf",t.roleScreenList),g.xp6(1),g.Q6J("ngIf",!t.modifyScreen),g.xp6(1),g.Q6J("ngIf",t.modifyScreen),g.xp6(1),g.Q6J("ngIf",null!=t.modifyRoleObject.roleName))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,i.O5,r.Q7,i.sg,i.mk,s.rH],pipes:[i.uU],styles:['.errorColor[_ngcontent-%COMP%]{color:#e6224a}.form-group.required[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]:after{content:"*";color:red}']}),e})();class w{static cannotContainSpace(e){return e.value.indexOf(" ")>=0?{cannotContainSpace:!0}:null}}var U=o(17988);const B=function(){return["active"]};function P(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",6),g.TgZ(1,"button",12),g.NdJ("click",function(){return g.CHM(e),g.oxw().createRole()}),g._uU(2),g.qZA(),g.qZA()}if(2&e){const e=g.oxw();g.xp6(1),g.Q6J("routerLinkActive",g.DdM(2,B)),g.xp6(1),g.hij(" ",e.roleCodes.new.labelDescription," ")}}function F(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",19),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().$implicit;return g.oxw().deleteRole(t)}),g._UZ(1,"img",20),g.qZA()}}function _(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",21),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().$implicit;return g.oxw().closeRecord(t)}),g._UZ(1,"img",22),g.qZA()}}function J(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",23),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().$implicit;return g.oxw().reopenRecord(t)}),g._UZ(1,"img",24),g.qZA()}}function Y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td"),g.TgZ(2,"a",13),g.NdJ("click",function(){const t=g.CHM(e).$implicit;return g.oxw().getRole(t)}),g._uU(3),g.qZA(),g.qZA(),g.TgZ(4,"td"),g._uU(5),g.qZA(),g.TgZ(6,"td"),g._uU(7),g.qZA(),g.TgZ(8,"td"),g._uU(9),g.qZA(),g.TgZ(10,"td"),g._uU(11),g.ALo(12,"date"),g.qZA(),g.TgZ(13,"td"),g.TgZ(14,"button",14),g.NdJ("click",function(){const t=g.CHM(e).$implicit;return g.oxw().verifyRole(t)}),g._UZ(15,"img",15),g.qZA(),g.YNc(16,F,2,0,"button",16),g.YNc(17,_,2,0,"button",17),g.YNc(18,J,2,0,"button",18),g.qZA(),g.qZA()}if(2&e){const e=t.$implicit,o=g.oxw();g.xp6(3),g.Oqu(e.roleName),g.xp6(2),g.Oqu(e.roleDesc),g.xp6(2),g.Oqu(e.authStatus),g.xp6(2),g.Oqu(e.recordStatus),g.xp6(2),g.Oqu(g.xi3(12,9,e.makerDtStamp,"medium")),g.xp6(3),g.Q6J("disabled",!("U"==e.authStatus||"Unauthorized"==e.authStatus)),g.xp6(2),g.Q6J("ngIf","NO"==e.firstTimeAuth||"N"==e.firstTimeAuth),g.xp6(1),g.Q6J("ngIf",("OPEN"==e.recordStatus||"Open"==e.recordStatus)&&("YES"==e.firstTimeAuth||"Y"==e.firstTimeAuth)&&o.roleCodes.close),g.xp6(1),g.Q6J("ngIf",("CLOSED"==e.recordStatus||"Close"==e.recordStatus)&&("YES"==e.firstTimeAuth||"Y"==e.firstTimeAuth)&&o.roleCodes.reopen)}}function W(e,t){1&e&&(g.ynx(0),g.TgZ(1,"div",25),g.TgZ(2,"span",26),g._uU(3,"Please wait... "),g._UZ(4,"span",27),g.qZA(),g.qZA(),g.BQk())}const H=function(){return["/dashboard"]},Q=[{path:"list",component:(()=>{class e{constructor(e,t,o,i){this.cdr=e,this.api=t,this.router=o,this.roleService=i,this.isLoading=!1,this.roleCodes=new a.yv,this.dtOptions={},this.dtTrigger=new c.xQ,this.statusArr=["Authorized","Unauthorized","Open","Close"],this.modifyRoleObject=new h,this.openBtn=!0,this.closeBtn=!0}ngOnInit(){this.getRoles(),this.dtOptions={pagingType:"full_numbers",pageLength:5,processing:!0,columnDefs:[{type:"date",targets:[4]}],order:[[4,"desc"]],lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]]},this.roleService.fetchScreenPermissions("Roles"),this.roleService.screenLabelList.subscribe(e=>this.roleCodes=e),console.log(this.roleCodes),this.username=localStorage.getItem("userFromLogin").replace(/['"]+/g,"")}ngOnDestroy(){this.dtTrigger.unsubscribe()}getRoles(){this.isLoading=!0,this.api.getAllRoles().subscribe(e=>{for(let t of e.result)t.authStatus=this.statusArr.find(e=>e.startsWith(t.authStatus)),t.recordStatus=this.statusArr.find(e=>e.startsWith(t.recordStatus));this.allRoles=e.result,this.isLoading=!1,this.cdr.markForCheck(),console.log(this.allRoles),this.dtTrigger.next()})}getRole(e){this.modifyRoleObject=e,console.log("inside modify"),console.log(this.modifyRoleObject),this.roleService.setIndexValue({index:"edit"});const t={queryParams:{id:this.modifyRoleObject.id,roleName:this.modifyRoleObject.roleName,roleDesc:this.modifyRoleObject.roleDesc,new1:this.modifyRoleObject.new1,copy1:this.modifyRoleObject.copy1,delete1:this.modifyRoleObject.delete1,close1:this.modifyRoleObject.close1,unlock1:this.modifyRoleObject.unlock1,reopen1:this.modifyRoleObject.reopen1,print1:this.modifyRoleObject.print1,auth1:this.modifyRoleObject.auth1,view1:this.modifyRoleObject.view1,makerId:this.modifyRoleObject.makerId,makerDtStamp:this.modifyRoleObject.makerDtStamp,checkerId:this.modifyRoleObject.checkerId,checkerDtStamp:this.modifyRoleObject.checkerDtStamp,recordStatus:this.modifyRoleObject.recordStatus,authStatus:this.modifyRoleObject.authStatus,firstTimeAuth:this.modifyRoleObject.firstTimeAuth,version:this.modifyRoleObject.version}};localStorage.setItem("roleNavObj",JSON.stringify(this.modifyRoleObject)),this.roleService.sendNavParam(t),this.router.navigate(["/roles/create"])}createRole(){localStorage.removeItem("roleNavObj"),this.router.navigate(["/roles/create"]),this.roleService.sendNavParam({queryParams:{}}),this.roleService.setIndexValue({index:"new"})}verifyRole(e){console.log(e.makerId,this.username),e.makerId!==this.username?m().fire({text:"You are trying to Authorize record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.verifyRole(e.roleName,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,this.modifyRoleObject&&m().fire({text:"Role is Authorized",icon:"success"}).then(()=>window.location.reload())})}):m().fire({text:"Maker Cannot Authorize Record!",icon:"error"})}deleteRole(e){m().fire({text:"You are trying to Delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.deleteRole(e.roleName,this.username).subscribe(e=>{this.deleteStatusFlag=e,this.deleteStatusFlag&&m().fire({text:"Role is Deleted",icon:"success"}).then(()=>window.location.reload())})}),!1===this.deleteStatusFlag&&m().fire({icon:"error",text:"Failed to Delete Record "})}reopenRecord(e){m().fire({text:"You are trying to Reopen record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.reopenRecord(e.roleName,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,console.log("user is reopened"),this.openBtn=!1,this.closeBtn=!1,this.updatedRoleObject&&m().fire({text:"Role is Reopened",icon:"success"}).then(()=>window.location.reload())})}),!1===this.deleteStatusFlag&&m().fire({icon:"error",text:"Failed to Reopened Record "})}closeRecord(e){m().fire({text:"You are trying to Closed record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.roleService.closelockRecord(e.roleName,this.username).subscribe(e=>{this.updatedRoleObject=e,this.cdr.markForCheck(),this.modifyRoleObject=this.updatedRoleObject,console.log("role is closed",this.updatedRoleObject.recordStatus),this.openBtn=!1,this.closeBtn=!1,this.updatedRoleObject&&m().fire({text:"Role is Closed",icon:"success"}).then(()=>window.location.reload())})}),!1===this.updatedRoleObject&&m().fire({icon:"error",text:"Failed to Closed Record "})}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(g.sBO),g.Y36(b.sM),g.Y36(s.F0),g.Y36(f.N))},e.\u0275cmp=g.Xpm({type:e,selectors:[["npr-role-list"]],decls:29,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],["class","col-auto",4,"ngIf"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],[1,"table-responsive"],["datatable","",1,"dataTable","table","tableStyle","tableStyleSelect","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLinkActive","click"],[1,"link-color",2,"cursor","pointer",3,"click"],["title","Authorize",1,"btn",2,"color","red",3,"disabled","click"],["src","assets/images/authorize.svg","alt","Authorize",1,"summaryIcon"],["class","btn","style","color: red","title","Delete",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Close",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Reopen",3,"click",4,"ngIf"],["title","Delete",1,"btn",2,"color","red",3,"click"],["src","assets/images/delete.svg","alt","...",1,"summaryIcon"],["title","Close",1,"btn",2,"color","red",3,"click"],["src","assets/images/CROSS1.svg","alt","...",1,"summaryIcon"],["title","Reopen",1,"btn",2,"color","red",3,"click"],["src","assets/images/open.svg","alt","...",1,"summaryIcon"],[1,"loading-page-center"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h2",2),g._uU(3,"Role Management"),g.qZA(),g.qZA(),g.TgZ(4,"div",3),g.TgZ(5,"div",4),g.YNc(6,P,3,3,"div",5),g.TgZ(7,"div",6),g.TgZ(8,"button",7),g._uU(9," Exit "),g.qZA(),g.qZA(),g.qZA(),g.TgZ(10,"div",8),g.TgZ(11,"table",9),g.TgZ(12,"thead"),g.TgZ(13,"tr"),g.TgZ(14,"th"),g._uU(15,"Role Name"),g.qZA(),g.TgZ(16,"th"),g._uU(17,"Role Description"),g.qZA(),g.TgZ(18,"th"),g._uU(19,"Auth Status"),g.qZA(),g.TgZ(20,"th"),g._uU(21,"Record Status"),g.qZA(),g.TgZ(22,"th"),g._uU(23,"Date"),g.qZA(),g.TgZ(24,"th"),g._uU(25,"Action"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(26,"tbody"),g.YNc(27,Y,19,12,"tr",10),g.qZA(),g.qZA(),g.qZA(),g.YNc(28,W,5,0,"ng-container",11),g.qZA(),g.qZA()),2&e&&(g.xp6(6),g.Q6J("ngIf",t.roleCodes.new),g.xp6(2),g.Q6J("routerLink",g.DdM(6,H)),g.xp6(3),g.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),g.xp6(16),g.Q6J("ngForOf",t.allRoles),g.xp6(1),g.Q6J("ngIf",t.isLoading))},directives:[i.O5,s.rH,U.G,i.sg,s.Od],pipes:[i.uU],styles:[""]}),e})()},{path:"create",component:k,canDeactivate:[l.I]},{path:"details/:id",component:k,canDeactivate:[l.I]}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[s.Bz.forChild(Q)],s.Bz]}),e})();var V=o(15626);let $=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[i.ez,r.UX,r.u5,V.K,M,U.T]]}),e})()}}]);