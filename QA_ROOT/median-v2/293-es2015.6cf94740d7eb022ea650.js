"use strict";(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[293],{31443:function(e,t,o){o.d(t,{k:function(){return a}});var i=o(37716),s=o(80463);let a=(()=>{class e{constructor(e){this.iziToast=e}successMessage(e,t){this.iziToast.success({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}errorMessage(e,t){this.iziToast.error({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}infoMessage(e,t){this.iziToast.info({title:e,message:t,layout:2,balloon:!1,position:"topRight",progressBarColor:"red",pauseOnHover:!0})}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(s.I))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},10293:function(e,t,o){o.r(t),o.d(t,{ExcelMappingModule:function(){return Ae}});var i=o(38583),s=o(39895),a=o(50215),r=o(91841),n=o(3679),l=o(79765),d=o(35383),c=o(88259),u=o.n(c),p=o(37716),h=o(94761),g=o(31443),m=o(77382);function Z(e,t){if(1&e&&(p.TgZ(0,"div",6),p.TgZ(1,"label",15),p._uU(2,"Currency"),p.TgZ(3,"span",8),p._uU(4,"*"),p.qZA(),p.qZA(),p._UZ(5,"input",16),p.qZA()),2&e){const e=p.oxw();p.xp6(5),p.Q6J("readonly",!e.editFlag1)}}function f(e,t){if(1&e&&(p.TgZ(0,"option",20),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e),p.xp6(1),p.Oqu(e)}}function v(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",6),p.TgZ(1,"label",15),p._uU(2,"Currency"),p.TgZ(3,"span",8),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"select",17),p.NdJ("change",function(t){return p.CHM(e),p.oxw().getCurrencyData(t,"currency")}),p.TgZ(6,"option",18),p._uU(7,"--Please select--"),p.qZA(),p.YNc(8,f,2,2,"option",19),p.qZA(),p.qZA()}if(2&e){const e=p.oxw();p.xp6(5),p.uIk("disabled",e.showCurrencyDropdown?null:""),p.xp6(3),p.Q6J("ngForOf",e.ccyData)}}function x(e,t){if(1&e&&(p.TgZ(0,"div",6),p.TgZ(1,"label",21),p._uU(2,"Sheet Number"),p.TgZ(3,"span",8),p._uU(4,"*"),p.qZA(),p.qZA(),p._UZ(5,"input",22),p.qZA()),2&e){const e=p.oxw();p.xp6(5),p.Q6J("readonly",!e.editFlag1)}}function A(e,t){if(1&e&&(p.TgZ(0,"option",20),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e),p.xp6(1),p.Oqu(e)}}function y(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",6),p.TgZ(1,"label",21),p._uU(2,"Sheet Number"),p.TgZ(3,"span",8),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"select",23),p.NdJ("change",function(t){return p.CHM(e),p.oxw().getsheetNumData(t,"sheetNumber")}),p.TgZ(6,"option",18),p._uU(7,"--Please select--"),p.qZA(),p.YNc(8,A,2,2,"option",19),p.qZA(),p.qZA()}if(2&e){const e=p.oxw();p.xp6(8),p.Q6J("ngForOf",e.sheetData)}}const T=function(){return["/excel-mapping"]};function S(e,t){1&e&&(p.TgZ(0,"div",24),p.TgZ(1,"div",25),p.TgZ(2,"a",26),p._uU(3,"Exit"),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(2),p.Q6J("routerLink",p.DdM(1,T)))}function q(e,t){if(1&e&&(p.TgZ(0,"div",6),p.TgZ(1,"label",27),p._uU(2,"Data Starting Row"),p.qZA(),p._UZ(3,"input",28),p.qZA()),2&e){const e=p.oxw();p.xp6(3),p.Q6J("readonly",!e.editFlag)}}function b(e,t){if(1&e&&(p.TgZ(0,"div",6),p.TgZ(1,"div",29),p._UZ(2,"input",30),p.TgZ(3,"label",31),p._uU(4,"Is Header Present"),p.qZA(),p.qZA(),p.qZA()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("readonly",!e.editFlag)}}function C(e,t){if(1&e&&(p.TgZ(0,"option",55),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e.value),p.xp6(1),p.Oqu(e.type)}}function F(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"a",56),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(),o=t.index,i=t.$implicit;return p.oxw(2).removeSubArray(o,i)}),p.TgZ(1,"span"),p._UZ(2,"img",57),p.qZA(),p.qZA()}}function N(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"tr",40),p.TgZ(1,"td"),p._UZ(2,"input",41),p.qZA(),p.TgZ(3,"td"),p.TgZ(4,"select",42),p.NdJ("change",function(){const t=p.CHM(e).index;return p.oxw(2).checkTypeStatus(t)}),p.TgZ(5,"option",18),p._uU(6,"--Please select--"),p.qZA(),p.YNc(7,C,2,2,"option",43),p.qZA(),p.qZA(),p.TgZ(8,"td"),p.TgZ(9,"div",44),p.TgZ(10,"div",29),p._UZ(11,"input",45),p.TgZ(12,"label",46),p.TgZ(13,"span",47),p._uU(14,"Is Mandatory?"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(15,"td"),p._UZ(16,"input",48),p.qZA(),p.TgZ(17,"td"),p._UZ(18,"input",49),p.qZA(),p.TgZ(19,"td"),p._UZ(20,"input",50),p.qZA(),p.TgZ(21,"td"),p._UZ(22,"input",51),p.qZA(),p.TgZ(23,"td"),p._UZ(24,"input",52),p.qZA(),p.TgZ(25,"td"),p._UZ(26,"input",53),p.qZA(),p.TgZ(27,"td"),p.YNc(28,F,3,0,"a",54),p.qZA(),p.qZA()}if(2&e){const e=t.index,o=p.oxw(2);p.Q6J("formGroupName",e),p.xp6(2),p.Q6J("readonly",!o.editFlag),p.xp6(2),p.uIk("disabled",o.editFlag?null:""),p.xp6(3),p.Q6J("ngForOf",o.dataTypes),p.xp6(4),p.MGl("id","mandatoryCheck_",e,""),p.xp6(1),p.MGl("for","mandatoryCheck_",e,""),p.xp6(4),p.MGl("id","headerName_",e,""),p.xp6(2),p.MGl("id","dateFormat_",e,""),p.xp6(2),p.MGl("id","mappingColumn_",e,""),p.xp6(2),p.MGl("id","delimeter_",e,""),p.xp6(2),p.MGl("id","defaultValue_",e,""),p.xp6(2),p.MGl("id","repeatedTillNextValue_",e,""),p.xp6(2),p.Q6J("ngIf",o.editFlag)}}function w(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"a",58),p.TgZ(1,"span",59),p.NdJ("click",function(){return p.CHM(e),p.oxw(2).addSubArray()}),p._UZ(2,"img",60),p.qZA(),p.qZA()}}function D(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",66),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(3);return t.updateMappingData(t.addForm.value,t.updateMappingForm.value)}),p._uU(1,"Save"),p.qZA()}if(2&e){const e=p.oxw(3);p.Q6J("disabled",e.dataSaved)("disabled",!e.updateMappingForm.dirty&&!e.addForm.dirty)}}function U(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",63),p.TgZ(1,"button",67),p.NdJ("click",function(){return p.CHM(e),p.oxw(3).enableEditFlag()}),p._uU(2),p.qZA(),p.qZA()}if(2&e){const e=p.oxw(3);p.xp6(2),p.Oqu(e.roleCodes.edit.labelDescription)}}function M(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",63),p.TgZ(1,"button",68),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(3);return t.onClickOfAuth(t.addForm.value,t.updateMappingForm.value)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){const e=p.oxw(3);p.xp6(2),p.Oqu(e.roleCodes.auth.labelDescription)}}function _(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",63),p.TgZ(1,"button",69),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(3);return t.onClickOfClose(t.addForm.value,t.updateMappingForm.value)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){const e=p.oxw(3);p.xp6(2),p.Oqu(e.roleCodes.close.labelDescription)}}function R(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",63),p.TgZ(1,"button",69),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(3);return t.onClickDelete(t.addForm.value,t.updateMappingForm.value)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){const e=p.oxw(3);p.xp6(2),p.Oqu(e.roleCodes.delete.labelDescription)}}function O(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",63),p.TgZ(1,"button",70),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(3);return t.onClickOfReopen(t.addForm.value,t.updateMappingForm.value)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){const e=p.oxw(3);p.xp6(2),p.Oqu(e.roleCodes.reopen.labelDescription)}}function k(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",67),p.NdJ("click",function(){p.CHM(e);const t=p.oxw(4);return t.finalSubmit(t.updateMappingForm.value,t.addForm.value)}),p._uU(1,"Save"),p.qZA()}}function I(e,t){if(1&e&&(p.TgZ(0,"div",63),p.YNc(1,k,2,0,"button",71),p.qZA()),2&e){const e=p.oxw(3);p.xp6(1),p.Q6J("ngIf",!e.editFlag&&!e.copyData)}}function B(e,t){if(1&e&&(p.TgZ(0,"div",61),p.TgZ(1,"div",62),p.TgZ(2,"div",63),p.YNc(3,D,2,2,"button",64),p.qZA(),p.YNc(4,U,3,1,"div",65),p.YNc(5,M,3,1,"div",65),p.YNc(6,_,3,1,"div",65),p.YNc(7,R,3,1,"div",65),p.YNc(8,O,3,1,"div",65),p.YNc(9,I,2,1,"div",65),p.TgZ(10,"div",63),p.TgZ(11,"a",26),p._uU(12,"Exit"),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){const e=p.oxw(2);p.xp6(3),p.Q6J("ngIf",e.editFlag&&e.copyData),p.xp6(1),p.Q6J("ngIf",e.newDataResponse&&!e.editFlag&&"OPEN"==e.recordStatus&&e.roleCodes.edit&&e.copyData),p.xp6(1),p.Q6J("ngIf",e.newDataResponse&&!e.editFlag&&"UNAUTHORIZED"==e.authStatus&&e.roleCodes.auth&&e.copyData),p.xp6(1),p.Q6J("ngIf","OPEN"==e.recordStatus&&!e.editFlag&&e.copyData&&"YES"==e.firstTimeAuth),p.xp6(1),p.Q6J("ngIf","NO"==e.firstTimeAuth&&("OPEN"==e.recordStatus||"O"==e.recordStatus)&&!e.editFlag&&e.copyData),p.xp6(1),p.Q6J("ngIf","CLOSED"==e.recordStatus&&!e.editFlag&&e.copyData),p.xp6(1),p.Q6J("ngIf",e.newDataResponse&&e.editFlag),p.xp6(2),p.Q6J("routerLink",p.DdM(8,T))}}function E(e,t){if(1&e&&(p.TgZ(0,"div",3),p.TgZ(1,"div",72),p.TgZ(2,"div",73),p.TgZ(3,"div",74),p.TgZ(4,"div",75),p.TgZ(5,"div",63),p.TgZ(6,"div",76),p._UZ(7,"i",77),p.qZA(),p.qZA(),p.TgZ(8,"div",78),p.TgZ(9,"div",79),p.TgZ(10,"h2"),p._uU(11,"Maker"),p.qZA(),p.TgZ(12,"p"),p._uU(13),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"div",73),p.TgZ(15,"div",74),p.TgZ(16,"div",75),p.TgZ(17,"div",63),p.TgZ(18,"div",80),p._UZ(19,"img",81),p.qZA(),p.qZA(),p.TgZ(20,"div",78),p.TgZ(21,"div",79),p.TgZ(22,"h2"),p._uU(23,"Maker Time Stamp"),p.qZA(),p.TgZ(24,"p"),p._uU(25),p.ALo(26,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"div",73),p.TgZ(28,"div",74),p.TgZ(29,"div",75),p.TgZ(30,"div",63),p.TgZ(31,"div",82),p._UZ(32,"i",83),p.qZA(),p.qZA(),p.TgZ(33,"div",78),p.TgZ(34,"div",79),p.TgZ(35,"h2"),p._uU(36,"Record Status"),p.qZA(),p.TgZ(37,"p"),p._uU(38),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(39,"div",73),p.TgZ(40,"div",74),p.TgZ(41,"div",75),p.TgZ(42,"div",63),p.TgZ(43,"div",84),p._UZ(44,"i",85),p.qZA(),p.qZA(),p.TgZ(45,"div",78),p.TgZ(46,"div",79),p.TgZ(47,"h2"),p._uU(48,"Checker"),p.qZA(),p.TgZ(49,"p"),p._uU(50),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(51,"div",73),p.TgZ(52,"div",74),p.TgZ(53,"div",75),p.TgZ(54,"div",63),p.TgZ(55,"div",86),p._UZ(56,"img",87),p.qZA(),p.qZA(),p.TgZ(57,"div",78),p.TgZ(58,"div",79),p.TgZ(59,"h2"),p._uU(60,"Checker Time Stamp"),p.qZA(),p.TgZ(61,"p"),p._uU(62),p.ALo(63,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(64,"div",73),p.TgZ(65,"div",74),p.TgZ(66,"div",75),p.TgZ(67,"div",63),p.TgZ(68,"div",88),p._UZ(69,"i",89),p.qZA(),p.qZA(),p.TgZ(70,"div",78),p.TgZ(71,"div",79),p.TgZ(72,"h2"),p._uU(73,"First Time Authorization"),p.qZA(),p.TgZ(74,"p"),p._uU(75),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(76,"div",73),p.TgZ(77,"div",74),p.TgZ(78,"div",75),p.TgZ(79,"div",63),p.TgZ(80,"div",90),p._UZ(81,"img",91),p.qZA(),p.qZA(),p.TgZ(82,"div",78),p.TgZ(83,"div",79),p.TgZ(84,"h2"),p._uU(85,"Authorization Status"),p.qZA(),p.TgZ(86,"p"),p._uU(87),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(88,"div",73),p.TgZ(89,"div",74),p.TgZ(90,"div",75),p.TgZ(91,"div",63),p.TgZ(92,"div",90),p._UZ(93,"img",92),p.qZA(),p.qZA(),p.TgZ(94,"div",78),p.TgZ(95,"div",79),p.TgZ(96,"h2"),p._uU(97,"Modification Number"),p.qZA(),p.TgZ(98,"p"),p._uU(99),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){const e=p.oxw(2);p.xp6(13),p.Oqu(e.modifiedBy),p.xp6(12),p.Oqu(p.xi3(26,8,e.modifiedTime,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(e.recordStatus),p.xp6(12),p.Oqu(e.authorizedBy),p.xp6(12),p.Oqu(p.xi3(63,11,e.authorizedTime,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(e.firstTimeAuth),p.xp6(12),p.Oqu(e.authStatus),p.xp6(12),p.Oqu(e.version)}}function J(e,t){if(1&e&&(p.TgZ(0,"div",3),p.TgZ(1,"form",32),p.TgZ(2,"div",33),p.TgZ(3,"fieldset",34),p.TgZ(4,"table",35),p.TgZ(5,"thead"),p.TgZ(6,"tr"),p.TgZ(7,"th"),p._uU(8,"Name"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"data type"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"mandatory"),p.qZA(),p.TgZ(13,"th"),p._uU(14,"header name"),p.qZA(),p.TgZ(15,"th"),p._uU(16,"date format"),p.qZA(),p.TgZ(17,"th"),p._uU(18,"mapping column"),p.qZA(),p.TgZ(19,"th"),p._uU(20,"delimeter"),p.qZA(),p.TgZ(21,"th"),p._uU(22,"default value"),p.qZA(),p.TgZ(23,"th"),p._uU(24,"repeated till next value"),p.qZA(),p.TgZ(25,"th"),p._uU(26,"delete"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"tbody",36),p.YNc(28,N,29,13,"tr",37),p.TgZ(29,"tr"),p.TgZ(30,"td"),p.YNc(31,w,3,0,"a",38),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.YNc(32,B,13,9,"div",39),p.YNc(33,E,100,14,"div",14),p.qZA(),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("formGroup",e.addForm),p.xp6(2),p.Q6J("disabled",!e.editFlag),p.xp6(25),p.Q6J("ngForOf",e.addForm.get("excelMappingDetails").controls),p.xp6(3),p.Q6J("ngIf",e.editFlag),p.xp6(1),p.Q6J("ngIf",e.newDataResponse),p.xp6(1),p.Q6J("ngIf",e.newDataResponse)}}let Y=(()=>{class e{constructor(e,t,o,i,s,a,r){this.apiService=e,this.cdr=t,this.fb=o,this.toastService=i,this.router=s,this.roleService=a,this.canDeactivateGuard=r,this.roleCodes=new d.yv,this.editFlag=!1,this.editFlag1=!1,this.showCurrencyDropdown=!0,this.showFieldCurrency=!1,this.showFieldsheetNum=!1,this.showFetch=!0,this.extSysCode=null,this.excelprocess=null,this.submitted=!1,this.tempStore=[],this.disablefetchbtn=!1,this.formTouched=!0,this.dataSaved=!1,this.copyData=!0,this.dataTypes=[{id:3,type:"Clob",value:"clob_901",isActive:!1},{id:1,type:"Date",value:"date_751",isActive:!0},{id:2,type:"Number",value:"number_600",isActive:!1},{id:4,type:"Varchar",value:"varchar_0",isActive:!1}],this.showDialog=!1,this.subject=new l.xQ}ngOnInit(){this.currentUser=localStorage.getItem("userFromLogin"),this.getExtCodeforDropdown(),setTimeout(()=>{this.newRolePermissions()},2e3),this.roleService.screenLabelList.subscribe(e=>this.roleCodes=e),setTimeout(()=>{console.log(this.roleCodes)},3e3),console.log("role codes",this.roleCodes),this.updateMappingForm=this.fb.group({processName:[""],extSysCode:[""],extSys:[""],userId:[this.currentUser],sheetNumber:[""],headerRepeated:[!1],startingRow:[""],currency:[""]}),this.addForm=this.fb.group({excelMappingDetails:this.fb.array([this.getSubArray()])}),this.gettingSummaryData()}newRolePermissions(){this.roleService.fetchScreenPermissions("Template Mapping")}canExit(){let e=!1;return this.updateMappingForm.touched&&1==this.formTouched?u().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>!0===t.isConfirmed?(e=!0,this.cdr.markForCheck(),e):(e=!1,this.cdr.markForCheck(),e)):(e=!0,new Promise((t,o)=>{!0===e&&(e=!0,this.cdr.markForCheck(),t(!0))}))}getSubArray(){return this.fb.group({columnnName:["",[n.kI.required]],dataType:[null,[n.kI.required]],mandatory:[!1],headerName:["",[n.kI.required]],dateFormat:[{value:"",disabled:!0}],delimeter:[""],defaultValue:[""],repeatedTillNextValue:[""],tableMappingColumn:[""],mappingMasterId:[""],mappingDetailId:[""],excelMappingColumn:["",[n.kI.required,n.kI.minLength(1),n.kI.maxLength(3),n.kI.pattern("^[a-zA-Z -#,@,%']+")]]})}gettingSummaryData(){this.apiService.getexcelSummaryData().subscribe(e=>{this.summryResponse=e,console.log("this.summryResponse",this.summryResponse);var t=localStorage.getItem("summryResponse");this.summryResponse=JSON.parse(t)}),this.summryResponse&&(this.getExtSysNameByExtSysCode(this.summryResponse.extSysCode),this.extSysCode=this.summryResponse.extSysCode,this.processNAme=this.summryResponse.processName,this.extSys=this.summryResponse.extSys,this.currency=this.summryResponse.currency,this.sheetNumber=this.summryResponse.sheetNumber,this.updateMappingForm.controls.extSysCode.setValue(this.extSysCode),this.updateMappingForm.controls.processName.setValue(this.processNAme),this.apiService.getTemplateMappingDataforEdit(this.extSys,this.processNAme,this.currency,this.sheetNumber).subscribe(e=>{console.log("This. is new Resp",e),this.newDataResponse=e,localStorage.setItem("newDataResponse",JSON.stringify(this.newDataResponse)),console.log(this.newDataResponse,"After"),this.showFieldCurrency=!0,this.showFieldsheetNum=!0,this.updateMappingForm.controls.currency.setValue(this.newDataResponse.currency),this.updateMappingForm.controls.sheetNumber.setValue(this.newDataResponse.sheetNumber);const t=this.newDataResponse.headerRepeated;this.updateMappingForm.controls.startingRow.setValue(this.newDataResponse.startingRow),this.updateMappingForm.controls.headerRepeated.setValue(t),this.showCurrencyDropdown=!1,this.auditLog(),this.patchData(this.newDataResponse.excelMappingDetails.sort((e,t)=>e.excelMappingColumn>t.excelMappingColumn?1:-1))}),setTimeout(()=>{this.getProcess(this.extSysCode)},100))}getAllMappingData(e,t,o,i){console.log("Checking ?",e,t,o,i),this.apiService.fetchAllName(e,t,o).subscribe(e=>{this.fileNames=e}),this.apiService.getAllMappingByExtSysAndProcessCode(e,t,o,i).subscribe(e=>{this.mappingResponse=e,localStorage.setItem("mappingResponse",JSON.stringify(this.mappingResponse));var t=localStorage.getItem("mappingResponse");if(this.mappingResponse=JSON.parse(t),console.log("this.mappingResponse",this.mappingResponse),null==this.mappingResponse)u().fire({title:"Excel mapping is not available with this sheet number!",text:"Please enter the correct sheet number",icon:"warning"});else{u().fire({title:"Data Fetched Successfully!",icon:"success"});const e=this.mappingResponse[0].headerRepeated;this.updateMappingForm.controls.startingRow.setValue(this.mappingResponse[0].startingRow),this.updateMappingForm.controls.headerRepeated.setValue(e),this.showCurrencyDropdown=!1,this.auditLog(),this.patchData(this.mappingResponse),this.cdr.markForCheck(),this.cdr.markForCheck()}})}getCurrencyData(e,t){console.log(e.target.value,t),this.updateMappingForm.controls.sheetNumber.setValue(this.sheetNumber),this.showFieldsheetNum=!0}getsheetNumData(e,t){console.log("event",e.target.value,t)}getExtCodeforDropdown(){this.apiService.getAllExtsysNameOnAuthStatus().subscribe(e=>{this.externalSysData=e,this.extSysData=e.sort()})}getProcess(e){console.log(this.externalSysData.map[e].extSysName),this.externalSystsemCodes=this.externalSysData.map[e].extSysName,this.updateMappingForm.value.extSys=this.externalSysData.map[e].extSysName,this.updateMappingForm.get("processName").setValue(this.externalSysData.map[e].processCode),this.processName=this.externalSysData.map[e].processCode,this.getExtSysNameByExtSysCode(e)}getExtSysNameByExtSysCode(e){this.apiService.getExtSysNameByExtSysCode(e).subscribe(e=>{this.extNameValue=e}),console.log(this.extNameValue)}getProcessName(e,t,o){this.apiService.getCurrencyOnExtNameAndProcssCode(e,t,o).subscribe(e=>{this.ccyData=e,console.log("Currency",this.ccyData),0!=this.ccyData.length||u().fire({title:"No Currency Found For the Process code!",icon:"warning"})})}patchData(e){console.log(e);const t=this.addForm.controls.excelMappingDetails;t.controls=[];for(let o=0;o<e.length;o++)t.push(this.getSubArray()),console.log("Inside for loop");console.log(t),console.log(this.addForm),this.addForm.patchValue({excelMappingDetails:e}),console.log(this.addForm)}addSubArray(){this.addForm.controls.excelMappingDetails.push(this.getSubArray())}getSubArrayFormGroup(e){return this.addForm.controls.excelMappingDetails.get([e]).value}get f(){return this.addForm.controls}get t(){return this.f.excelMappingDetails}auditLog(){var e,t,o,i,s,a,r,n;console.log(this.newDataResponse),this.authStatus=null===(e=this.newDataResponse)||void 0===e?void 0:e.authStatus,this.recordStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.recordStatus,this.modifiedBy=null===(o=this.newDataResponse)||void 0===o?void 0:o.inputBy,this.modifiedTime=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputDtStamp,this.authorizedBy=null===(s=this.newDataResponse)||void 0===s?void 0:s.authorizedBy,this.authorizedTime=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedDtStamp,this.version=null===(r=this.newDataResponse)||void 0===r?void 0:r.version,this.firstTimeAuth=null===(n=this.newDataResponse)||void 0===n?void 0:n.firstTimeAuth,console.log("AuditLog",this.authStatus,this.recordStatus,this.modifiedBy,this.authorizedBy),"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),"Y"===this.firstTimeAuth&&(this.firstTimeAuth="YES"),"N"===this.firstTimeAuth&&(this.firstTimeAuth="NO")}checkTypeStatus(e){let t=this.addForm.controls.excelMappingDetails.get([e]);"Date"==t.value.dataType?(this.is_edit=!1,t.get("dateFormat").enable()):t.get("dateFormat").disable()}mandatoryCheck(e,t){const o=e.currentTarget.checked;this.addForm.get("excelMappingDetails").at(t).get("mandatory").setValue(o),console.log("value",o,t)}enableEditFlag(){this.editFlag=!0,this.editFlag1=!1,this.showCurrencyDropdown=!0;const e=this.addForm.controls.excelMappingDetails;for(let t=0;t<this.addForm.get("excelMappingDetails").controls.length;t++){let o=e.get([t]);"date_751"==o.value.dataType?(console.log("Inside If"),this.is_edit=!1,o.get("dateFormat").enable()):(console.log("Inside else"),o.get("dateFormat").disable())}}clickFunction(e){console.log("i",e)}copyMaping(e){this.mappingResponse="",this.editFlag=!0,this.copyData=!1,this.processResp=[],this.excelprocess="",e.excelMappingDetails.forEach(e=>{e.id=null}),console.log(e.excelMappingDetails)}updateMappingData(e,t){console.log(this.extNameValue),this.submitted=!0,this.progress=!0;let o=e.excelMappingDetails[0].inputBy;if(o=this.currentUser,this.addForm.invalid)u().fire({text:"Numeric values not allowed in mapping column!",icon:"warning"});else{t.extSys=this.extNameValue;var i=Object.assign(Object.assign({},t),e);console.log(i),this.apiService.excelMappingAuditLog(i,"update").subscribe(e=>{this.newDataResponse=e,console.log(this.newDataResponse),this.newDataResponse?(this.editFlag=!1,this.showCurrencyDropdown=!1,this.dataSaved=!0,u().fire({text:"Record is Updated!",icon:"success"}),this.auditLog(),this.formTouched=!this.updateMappingForm.touched,this.cdr.markForCheck()):u().fire({text:"Failed to update ",icon:"error"})})}}onClickOfAuth(e,t){this.currentUser=localStorage.getItem("userFromLogin"),console.log("this.currentUser",this.currentUser,e,t),console.log(this.newDataResponse),this.modifiedBy===this.currentUser?u().fire({title:"Maker Cannot Authorized the Record!",icon:"error"}):u().fire({text:"You are trying to Authorize the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{!0===e.isConfirmed&&(this.newDataResponse.userId=this.currentUser,this.apiService.excelMappingAuditLog(this.newDataResponse,"authorize").subscribe(e=>{var t,o,i,s,a,r,n,l;this.newDataResponse=e,this.newDataResponse&&(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedTime=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputDtStamp,this.authorizedBy=null===(s=this.newDataResponse)||void 0===s?void 0:s.authorizedBy,this.authorizedTime=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedDtStamp,this.version=null===(r=this.newDataResponse)||void 0===r?void 0:r.version,this.firstTimeAuth=null===(n=this.newDataResponse)||void 0===n?void 0:n.firstTimeAuth,this.modifiedBy=null===(l=this.newDataResponse)||void 0===l?void 0:l.inputBy,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),"Y"===this.firstTimeAuth&&(this.firstTimeAuth="YES"),"N"===this.firstTimeAuth&&(this.firstTimeAuth="NO"),u().fire({title:"Record is Authorized",icon:"success"}))}))})}onClickDelete(e,t){console.log(this.newDataResponse),u().fire({text:"You are trying to delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{!0===e.isConfirmed&&this.apiService.deleteTemplateMapping(this.extSys,this.processNAme,this.currency,this.sheetNumber).subscribe(e=>{1==e?u().fire({title:"Record is deleted",icon:"success"}).then(e=>{this.router.navigate(["/excel-mapping"])}):u().fire({title:"Failed to Delete the Recored!",icon:"error"})})})}onClickOfClose(e,t){console.log(this.newDataResponse),u().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{!0===e.isConfirmed&&this.apiService.excelMappingAuditLog(this.newDataResponse,"close").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.newDataResponse=e,this.newDataResponse?(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.newDataResponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.newDataResponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.newDataResponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is Closed",icon:"success"}),this.auditLog()):u().fire({title:"Failed to Close the Recored!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}onClickOfReopen(e,t){this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.currentUser=this.newDataResponse.inputBy,u().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{console.log("this is reopen ",e),!0===e.isConfirmed&&this.apiService.excelMappingAuditLog(this.newDataResponse,"reopen").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.newDataResponse=e,this.newDataResponse?(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.newDataResponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.newDataResponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.newDataResponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is Reopened",icon:"success"}),this.auditLog()):u().fire({title:"Failed to Reopen the Record!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}removeSubArray(e,t){console.log(e,"Deleted"),this.getRowIdx(e)}getRowIdx(e){const t=this.addForm.controls.excelMappingDetails,o=t.get([e]);this.apiService.deleteMappingRow(o.value.mappingDetailId).subscribe(e=>{e||u().fire({title:"Failed to Delete the Record!",icon:"error"}),this.cdr.markForCheck()}),t.removeAt(e)}finalSubmit(e,t){console.log(this.externalSystsemCodes),e.extSys=this.externalSystsemCodes,console.log("Form",e,t),this.submitted=!0,this.extCodeValue=e.extSysCode,this.proCodeValue=e.processName,this.isCheckedValue=e.headerRepeated,this.startingValue=e.startingRow,this.currencyValue=e.currency,this.sheetNumberValue=e.sheetNumber,this.apiService.columnData(t,this.extCodeValue,this.proCodeValue,this.isCheckedValue,this.startingValue,this.extCodeValue,this.currencyValue,this.currentUser,this.sheetNumberValue).subscribe(e=>{if(this.newDataResponse=e,console.log("this.mappingResponse",this.newDataResponse),this.newDataResponse)return this.is_edit=!0,this.auditLog(),u().fire({title:"Mapped Successfully!",icon:"success"}),this.updateMappingForm.reset(),void this.addForm.reset();u().fire({title:"Failed ExternalSystem And ProcessCode Already Mapped.",icon:"error"}),this.updateMappingForm.reset(),this.addForm.reset()})}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(h.sM),p.Y36(p.sBO),p.Y36(n.qu),p.Y36(g.k),p.Y36(s.F0),p.Y36(m.N),p.Y36(a.I))},e.\u0275cmp=p.Xpm({type:e,selectors:[["npr-excel-mapping-edit"]],decls:27,vars:11,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],["action","",1,"formStyle",3,"formGroup"],[1,"row","gy-4","align-items-end"],[1,"col-lg-2"],["for","extSysCode",1,"formLbl"],[1,"colorRed"],["id","extSysCode","type","text","required","","formControlName","extSysCode","placeholder","External System","value","",1,"form-control",3,"readonly"],["for","processName",1,"formLbl"],["id","processName","type","text","required","","formControlName","processName","placeholder","Process Code","value","",1,"form-control",3,"readonly"],["class","col-lg-2",4,"ngIf"],["class","row gy-4  col-lg-4 ",4,"ngIf"],["class","dbCardStyle",4,"ngIf"],["for","currency",1,"formLbl"],["id","currency","type","text","required","","formControlName","currency","placeholder","Currency ","value","",1,"form-control",3,"readonly"],["formControlName","currency","required","","aria-label","Default select example",1,"form-select",3,"change"],["hidden","","value","","disabled","","selected",""],["class","form-class",3,"value",4,"ngFor","ngForOf"],[1,"form-class",3,"value"],["for","sheetNumber",1,"formLbl"],["id","sheetNumber","type","text","required","","formControlName","sheetNumber","placeholder","Sheet Number","value","",1,"form-control",3,"readonly"],["formControlName","sheetNumber","required","","aria-label","Default select example",1,"form-select",3,"change"],[1,"row","gy-4","col-lg-4"],[1,"col-lg-4"],["href","javascript:void(0)",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["for","startingRow",1,"formLbl"],["id","startingRow","type","text","required","","formControlName","startingRow","placeholder","Data Starting Row","value","",1,"form-control",3,"readonly"],[1,"checkStyle"],["type","checkbox","id","headerRepeated","formControlName","headerRepeated",3,"readonly"],["for","headerRepeated"],["action","","novalidate","",1,"formStyle",3,"formGroup"],[1,"table-responsive"],[3,"disabled"],["id","dbTable1",1,"table","tableStyle1","responsive","nowrap","vAlignMdl"],["formArrayName","excelMappingDetails"],[3,"formGroupName",4,"ngFor","ngForOf"],["href","javascript:void(0)","class","addIcon primarybg",4,"ngIf"],["class","col-lg-12",4,"ngIf"],[3,"formGroupName"],["id","sourceCode","type","text","formControlName","columnnName","placeholder","Name","value","",1,"form-control1",3,"readonly"],["formControlName","dataType","placeholder","Choose DataType","aria-label","Default select example",1,"form-select1",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"checkboxdiv"],["type","checkbox","formControlName","mandatory",3,"id"],[3,"for"],[2,"display","none"],["type","text","formControlName","headerName","placeholder","Header Name","value","",1,"form-control1",3,"id"],["type","text","formControlName","dateFormat","placeholder","Date Format","value","",1,"form-control1",3,"id"],["type","text","formControlName","excelMappingColumn","placeholder","Mapping Column","value","",1,"form-control1",3,"id"],["type","text","formControlName","delimeter","placeholder","Delimeter","value","",1,"form-control1",3,"id"],["type","text","formControlName","defaultValue","placeholder","Default Value","value","",1,"form-control1",3,"id"],["type","text","formControlName","repeatedTillNextValue","placeholder","Repeated Till Next Value","value","",1,"form-control1",3,"id"],["href","javascript:void(0)","class","deleteIcon2",3,"click",4,"ngIf"],[3,"value"],["href","javascript:void(0)",1,"deleteIcon2",3,"click"],["src","assets/images/delete-icon.svg","alt","..."],["href","javascript:void(0)",1,"addIcon","primarybg"],[3,"click"],["src","assets/images/plus-icon.svg","alt","..."],[1,"col-lg-12"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],[1,"col-auto"],["class","btn smBtn minWdSmBtn btnPrimary",3,"disabled","click",4,"ngIf"],["class","col-auto",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnAuth",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["color","warn",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["class","btn smBtn minWdSmBtn btnUpdate","color","primary",3,"click",4,"ngIf"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/modification.svg","alt","...",1,"modImage"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Update/Copy Mapping"),p.qZA(),p.qZA(),p.TgZ(4,"div",3),p.TgZ(5,"form",4),p.TgZ(6,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"label",7),p._uU(9,"External System"),p.TgZ(10,"span",8),p._uU(11,"*"),p.qZA(),p.qZA(),p._UZ(12,"input",9),p.qZA(),p.TgZ(13,"div",6),p.TgZ(14,"label",10),p._uU(15,"Process Code"),p.TgZ(16,"span",8),p._uU(17,"*"),p.qZA(),p.qZA(),p._UZ(18,"input",11),p.qZA(),p.YNc(19,Z,6,1,"div",12),p.YNc(20,v,9,2,"div",12),p.YNc(21,x,6,1,"div",12),p.YNc(22,y,9,1,"div",12),p.YNc(23,S,4,2,"div",13),p.YNc(24,q,4,1,"div",12),p.YNc(25,b,5,1,"div",12),p.qZA(),p.qZA(),p.qZA(),p.YNc(26,J,34,6,"div",14),p.qZA()),2&e&&(p.xp6(5),p.Q6J("formGroup",t.updateMappingForm),p.xp6(7),p.Q6J("readonly",!t.editFlag1),p.xp6(6),p.Q6J("readonly",!t.editFlag1),p.xp6(1),p.Q6J("ngIf",t.showFieldCurrency),p.xp6(1),p.Q6J("ngIf",!t.showFieldCurrency),p.xp6(1),p.Q6J("ngIf",t.showFieldsheetNum),p.xp6(1),p.Q6J("ngIf",!t.showFieldsheetNum),p.xp6(1),p.Q6J("ngIf",t.showFetch),p.xp6(1),p.Q6J("ngIf",t.newDataResponse),p.xp6(1),p.Q6J("ngIf",t.newDataResponse),p.xp6(1),p.Q6J("ngIf",t.newDataResponse))},directives:[n._Y,n.JL,n.sg,n.Fj,n.Q7,n.JJ,n.u,i.O5,n.EJ,n.YN,n.Kr,i.sg,s.yS,n.Wl,n.CE,n.x0],pipes:[i.uU],styles:[".form-class[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#797979;background-color:#fff;background-clip:padding-box;border-bottom:1px solid #ebebeb;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;-webkit-appearance:none;-moz-appearance:none;appearance:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}table.tableStyle1[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:10px;text-transform:uppercase;border-bottom:1px solid #F5F5F5}.form-control1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:13px;font-weight:400;line-height:1.5;color:#212529;height:45px;background-color:#f8f9fa;background-clip:padding-box;border:1px solid #efefef;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control1[_ngcontent-%COMP%]:disabled, .form-control1[readonly][_ngcontent-%COMP%]{opacity:1}.form-select1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;-moz-padding-start:calc(.75rem - 3px);font-size:13px;height:45px;font-weight:400;line-height:1.5;color:#212529;background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;background-color:#f8f9fa;border:1px solid #efefef;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-appearance:none;-moz-appearance:none;appearance:none}.checkboxdiv[_ngcontent-%COMP%]{padding-left:25px;padding-bottom:15px;cursor:pointer}"]}),e})();var Q=o(24376);function L(e,t){if(1&e&&(p.TgZ(0,"ng-option",40),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e),p.xp6(1),p.Oqu(e)}}function z(e,t){if(1&e&&(p.TgZ(0,"option",40),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e),p.xp6(1),p.Oqu(e)}}function P(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"select",41),p.NdJ("change",function(){p.CHM(e);const t=p.oxw();return t.getProcessName(t.excelMappingForm.get("processName").value,t.excelMappingForm.get("extSysCode").value)}),p.TgZ(1,"option",14),p._uU(2,"--Please select--"),p.qZA(),p.YNc(3,z,2,2,"option",15),p.qZA()}if(2&e){const e=p.oxw();p.uIk("disabled",e.editFlag?"":null),p.xp6(3),p.Q6J("ngForOf",e.processName)}}function V(e,t){if(1&e&&p._UZ(0,"input",42),2&e){const e=p.oxw();p.Q6J("readonly",e.editFlag)}}function H(e,t){if(1&e&&(p.TgZ(0,"option",40),p._uU(1),p.qZA()),2&e){const e=t.$implicit;p.Q6J("value",e.type),p.xp6(1),p.Oqu(e.type)}}function G(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"a",56),p.TgZ(1,"span",57),p.NdJ("click",function(){p.CHM(e);const t=p.oxw().index;return p.oxw().removeSubArray(t)}),p._UZ(2,"img",58),p.qZA(),p.qZA()}}function j(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"tr"),p.ynx(1,43),p.TgZ(2,"td"),p._UZ(3,"input",44),p.qZA(),p.TgZ(4,"td"),p.TgZ(5,"select",45),p.NdJ("change",function(){const t=p.CHM(e).index,o=p.oxw();return o.checkTypeStatus(t,o.addForm.value)}),p.TgZ(6,"option",14),p._uU(7,"--Please select--"),p.qZA(),p.YNc(8,H,2,2,"option",15),p.qZA(),p.qZA(),p.TgZ(9,"td"),p.TgZ(10,"div",46),p.TgZ(11,"div",25),p._UZ(12,"input",47),p._UZ(13,"label",48),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"td"),p._UZ(15,"input",49),p.qZA(),p.TgZ(16,"td"),p._UZ(17,"input",50),p.qZA(),p.TgZ(18,"td"),p._UZ(19,"input",51),p.qZA(),p.TgZ(20,"td"),p._UZ(21,"input",52),p.qZA(),p.TgZ(22,"td"),p._UZ(23,"input",53),p.qZA(),p.TgZ(24,"td"),p._UZ(25,"input",54),p.qZA(),p.TgZ(26,"td"),p.YNc(27,G,3,0,"a",55),p.qZA(),p.BQk(),p.qZA()}if(2&e){const e=t.index,o=p.oxw();p.xp6(1),p.Q6J("formGroupName",e),p.xp6(2),p.Q6J("readonly",o.editFlag),p.xp6(2),p.uIk("disabled",o.editFlag?"":null),p.xp6(3),p.Q6J("ngForOf",o.dataTypes),p.xp6(4),p.MGl("id","mandatoryCheck_",e,""),p.xp6(1),p.MGl("for","mandatoryCheck_",e,""),p.xp6(2),p.MGl("id","headerName_",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.MGl("id","dateFormat_",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.MGl("id","excelMappingColumn",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.MGl("id","delimeter_",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.MGl("id","defaultValue_",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.MGl("id","repeatedTillNextValue_",e,""),p.Q6J("readonly",o.editFlag),p.xp6(2),p.Q6J("ngIf",!o.editFlag)}}function W(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"a",59),p.NdJ("click",function(){return p.CHM(e),p.oxw().addSubArray()}),p.TgZ(1,"span"),p._UZ(2,"img",60),p.qZA(),p.qZA()}}function $(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",61),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.updateMappingData(t.addForm.value,t.excelMappingForm.value)}),p._uU(2,"Save"),p.qZA(),p.qZA()}if(2&e){const e=p.oxw();p.xp6(1),p.Q6J("disabled",e.dataSaved)}}function X(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",62),p.NdJ("click",function(){return p.CHM(e),p.oxw().enableEditFlag()}),p._uU(2,"Edit"),p.qZA(),p.qZA()}}function K(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",63),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.onClickOfAuth(t.addForm.value,t.excelMappingForm.value)}),p._uU(2,"Auth"),p.qZA(),p.qZA()}}function ee(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",64),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.onClickOfDelete(t.addForm.value,t.excelMappingForm.value)}),p._uU(2,"Delete"),p.qZA(),p.qZA()}}function te(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",62),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.onClickOfClose(t.addForm.value,t.excelMappingForm.value)}),p._uU(2,"Close"),p.qZA(),p.qZA()}}function oe(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",65),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.onClickOfReopen(t.addForm.value,t.excelMappingForm.value)}),p._uU(2,"Reopen"),p.qZA(),p.qZA()}}function ie(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"button",61),p.NdJ("click",function(){p.CHM(e);const t=p.oxw();return t.finalSubmit(t.excelMappingForm.value,t.addForm.value)}),p._uU(2,"Save"),p.qZA(),p.qZA()}if(2&e){const e=p.oxw();p.xp6(1),p.Q6J("disabled",e.excelMappingForm.invalid||e.addForm.controls.excelMappingDetails.invalid),p.uIk("disabled",e.editFlag)}}function se(e,t){if(1&e&&(p.TgZ(0,"div",3),p.TgZ(1,"div",66),p.TgZ(2,"div",67),p.TgZ(3,"div",68),p.TgZ(4,"div",69),p.TgZ(5,"div",5),p.TgZ(6,"div",70),p._UZ(7,"i",71),p.qZA(),p.qZA(),p.TgZ(8,"div",72),p.TgZ(9,"div",73),p.TgZ(10,"h2"),p._uU(11,"Maker"),p.qZA(),p.TgZ(12,"p"),p._uU(13),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"div",67),p.TgZ(15,"div",68),p.TgZ(16,"div",69),p.TgZ(17,"div",5),p.TgZ(18,"div",74),p._UZ(19,"img",75),p.qZA(),p.qZA(),p.TgZ(20,"div",72),p.TgZ(21,"div",73),p.TgZ(22,"h2"),p._uU(23,"Maker Time Stamp"),p.qZA(),p.TgZ(24,"p"),p._uU(25),p.ALo(26,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"div",67),p.TgZ(28,"div",68),p.TgZ(29,"div",69),p.TgZ(30,"div",5),p.TgZ(31,"div",76),p._UZ(32,"i",77),p.qZA(),p.qZA(),p.TgZ(33,"div",72),p.TgZ(34,"div",73),p.TgZ(35,"h2"),p._uU(36,"Record Status"),p.qZA(),p.TgZ(37,"p"),p._uU(38),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(39,"div",67),p.TgZ(40,"div",68),p.TgZ(41,"div",69),p.TgZ(42,"div",5),p.TgZ(43,"div",78),p._UZ(44,"i",79),p.qZA(),p.qZA(),p.TgZ(45,"div",72),p.TgZ(46,"div",73),p.TgZ(47,"h2"),p._uU(48,"Checker"),p.qZA(),p.TgZ(49,"p"),p._uU(50),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(51,"div",67),p.TgZ(52,"div",68),p.TgZ(53,"div",69),p.TgZ(54,"div",5),p.TgZ(55,"div",80),p._UZ(56,"img",81),p.qZA(),p.qZA(),p.TgZ(57,"div",72),p.TgZ(58,"div",73),p.TgZ(59,"h2"),p._uU(60,"Checker Time Stamp"),p.qZA(),p.TgZ(61,"p"),p._uU(62),p.ALo(63,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(64,"div",67),p.TgZ(65,"div",68),p.TgZ(66,"div",69),p.TgZ(67,"div",5),p.TgZ(68,"div",82),p._UZ(69,"i",83),p.qZA(),p.qZA(),p.TgZ(70,"div",72),p.TgZ(71,"div",73),p.TgZ(72,"h2"),p._uU(73,"First Time Authorization"),p.qZA(),p.TgZ(74,"p"),p._uU(75),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(76,"div",67),p.TgZ(77,"div",68),p.TgZ(78,"div",69),p.TgZ(79,"div",5),p.TgZ(80,"div",84),p._UZ(81,"img",85),p.qZA(),p.qZA(),p.TgZ(82,"div",72),p.TgZ(83,"div",73),p.TgZ(84,"h2"),p._uU(85,"Authorization Status"),p.qZA(),p.TgZ(86,"p"),p._uU(87),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(88,"div",67),p.TgZ(89,"div",68),p.TgZ(90,"div",69),p.TgZ(91,"div",5),p.TgZ(92,"div",84),p._UZ(93,"img",86),p.qZA(),p.qZA(),p.TgZ(94,"div",72),p.TgZ(95,"div",73),p.TgZ(96,"h2"),p._uU(97,"Modification Number"),p.qZA(),p.TgZ(98,"p"),p._uU(99),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){const e=p.oxw();p.xp6(13),p.Oqu(e.dataFromresponse.inputBy),p.xp6(12),p.Oqu(p.xi3(26,8,e.dataFromresponse.inputDtStamp,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(e.dataFromresponse.recordStatus),p.xp6(12),p.Oqu(e.dataFromresponse.authorizedBy),p.xp6(12),p.Oqu(p.xi3(63,11,e.dataFromresponse.authorizedDtStamp,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(e.dataFromresponse.firstTimeAuth),p.xp6(12),p.Oqu(e.dataFromresponse.authStatus),p.xp6(12),p.Oqu(e.dataFromresponse.version)}}const ae=function(){return["/excel-mapping/excel-mapping-edit"]},re=function(){return["/dashbaord"]},ne=function(){return["/excel-mapping"]};let le=(()=>{class e{constructor(e,t,o,i,s,a){this.apiService=e,this.fb=t,this.toastService=o,this.router=i,this.cdr=s,this.canDeactivateGuard=a,this.extSysCode=null,this.excelprocess=null,this.submitted=!1,this.editFlag=!1,this.dataTypes=[{id:3,type:"Clob",isActive:!1},{id:1,type:"Date",isActive:!0},{id:2,type:"Number",isActive:!1},{id:4,type:"VarChar",isActive:!1}],this.dataSaved=!1,this.showUpdate=!1,this.formTouched=!0,this.showDialog=!1,this.subject=new l.xQ,this.checkMandatory=!1,this.isDateValid=!1,this.processNameField="text"}ngOnInit(){this.currentUser=localStorage.getItem("userFromLogin"),this.excelMappingForm=this.fb.group({processName:[""],extSysCode:[""],extSys:[""],userId:[this.currentUser],sheetNumber:[""],headerRepeated:[!1],startingRow:[""],currency:[""]}),this.addForm=this.fb.group({excelMappingDetails:this.fb.array([this.getSubArray()])}),this.getAllExtsysNameAndProcessCodeOnAuthStatus(),console.log(this.currentUser)}auditLog(){"U"===this.dataFromresponse.authStatus&&(this.dataFromresponse.authStatus="UNAUTHORIZED"),"A"===this.dataFromresponse.authStatus&&(this.dataFromresponse.authStatus="AUTHORIZED"),"C"===this.dataFromresponse.recordStatus&&(this.dataFromresponse.recordStatus="CLOSED"),"O"===this.dataFromresponse.recordStatus&&(this.dataFromresponse.recordStatus="OPEN"),"N"===this.dataFromresponse.firstTimeAuth&&(this.dataFromresponse.firstTimeAuth="NO"),"Y"===this.dataFromresponse.firstTimeAuth&&(this.dataFromresponse.firstTimeAuth="YES")}getSubArray(){return this.fb.group({columnnName:["",[n.kI.required]],dataType:[null,[n.kI.required]],mandatory:[!1],headerName:["",[n.kI.required]],dateFormat:[{value:"",disabled:!0}],delimeter:[""],defaultValue:[""],repeatedTillNextValue:[""],tableMappingColumn:[""],mappingMasterId:[""],excelMappingColumn:["",[n.kI.required,n.kI.minLength(1),n.kI.maxLength(3),n.kI.pattern("^[a-zA-Z -#,@,%']+")]]})}mandatoryRequired(e,t){console.log(e),console.log(t),1==e&&(console.log("Inside True"),this.checkMandatory=!1),0==e&&console.log("Inside False")}getAllExternalSystem(){this.apiService.getAllExtCode().subscribe(e=>{this.extSysData=e})}getAllExtsysNameAndProcessCodeOnAuthStatus(){this.apiService.getAllExtsysNameOnAuthStatus().subscribe(e=>{this.externalSysData=e,this.extSysData=e.sort()})}getExtSysNameByExtSysCode(e){this.apiService.getExtSysNameByExtSysCode(e).subscribe(e=>{this.extNameValue=e}),console.log(this.extNameValue)}getProcess(e){this.excelMappingForm.get("processName").setValue(""),this.processNameField="text",this.processName=[],this.apiService.getProcessNameByExtSysCode(e).subscribe(t=>{this.processResp=t,this.processName=this.processResp,1===this.processName.length&&null!=this.processName&&(this.processNameField="text",this.excelMappingForm.get("processName").setValue(this.processName[0]),this.excelMappingForm.value.extSys=""),this.processName.length>1&&(this.processNameField="select"),this.getExtSysNameByExtSysCode(e)})}getProcessName(e,t){this.extSysCode=t,this.excelprocess=e}mandatoryCheck(e,t){const o=e.currentTarget.checked;this.addForm.get("excelMappingDetails").at(t).get("mandatory").setValue(o),console.log("value",o,t)}addSubArray(){const e=this.addForm.controls.excelMappingDetails;console.log("const control",e),e.push(this.getSubArray())}patchData(e){console.log("formdata");const t=this.addForm.controls.excelMappingDetails;for(let o=0;o<e.length;o++)t.push(this.getSubArray());this.addForm.patchValue({excelMappingDetails:e})}removeSubArray(e){this.addForm.controls.excelMappingDetails.removeAt(e)}clearAllSubArray(){const e=this.addForm.controls.excelMappingDetails;for(;e.length;)e.removeAt(e.length-1);e.clearValidators()}get f(){return this.addForm.controls}get t(){return this.f.excelMappingDetails}checkTypeStatus(e,t){let o=this.addForm.controls.excelMappingDetails.get([e]);console.log(o.value.dataType),"Date"==o.value.dataType?(console.log("Dates"),this.is_edit=!1,o.get("dateFormat").clearValidators(),o.get("dateFormat").setValidators([n.kI.required]),o.get("dateFormat").updateValueAndValidity(),o.get("dateFormat").enable()):o.get("dateFormat").disable()}clickFunction(e){console.log("i",e)}finalSubmit(e,t){console.log(t);let o=0;for(let s=0;s<t.excelMappingDetails.length;s++)console.log(t.excelMappingDetails[s].mandatory),1==t.excelMappingDetails[s].mandatory&&(console.log("Inside If"),o+=1),console.log(o);if(o<2)console.log("More than 2 rows"),u().fire({text:"Add atleast two mininum rows with mandatory condition",icon:"info"});else{e.extSys=this.extNameValue,this.submitted=!0,t.excelMappingDetails[0].modifiedBy=this.currentUser;var i=Object.assign(Object.assign({},e),t);this.apiService.createTemplateMap(i).subscribe(e=>{if(this.dataFromresponse=e,console.log("this.dataFromresponse",this.dataFromresponse),this.dataFromresponse)return this.is_edit=!0,console.log("sucess"),this.auditLog(),this.formTouched=!this.excelMappingForm.touched,u().fire({title:"Mapped Successfully!",icon:"success"}),void(this.editFlag=!0);u().fire({title:"Mapping Failed!",icon:"error"})},e=>{u().fire({text:e.error.message,icon:"error"})})}}enableEditFlag(){this.editFlag=!1,this.showUpdate=!0}canExit(){let e=!1;return this.excelMappingForm.touched&&1==this.formTouched?u().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>!0===t.isConfirmed?(e=!0,this.cdr.markForCheck(),e):(e=!1,this.cdr.markForCheck(),e)):(e=!0,new Promise((t,o)=>{!0===e&&(e=!0,this.cdr.markForCheck(),t(!0))}))}onClickOfReopen(e,t){this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.currentUser=this.dataFromresponse.inputBy,u().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{console.log("this is reopen ",e),!0===e.isConfirmed&&this.apiService.excelMappingAuditLog(this.dataFromresponse,"reopen").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.dataFromresponse=e,this.dataFromresponse?(this.authStatus=null===(t=this.dataFromresponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.dataFromresponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.dataFromresponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.dataFromresponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.dataFromresponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.dataFromresponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.dataFromresponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is Reopened",icon:"success"}),this.auditLog()):u().fire({title:"Failed to Reopen the Record!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}onClickOfDelete(e,t){console.log(this.dataFromresponse),u().fire({text:"You are trying to delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{!0===e.isConfirmed&&this.apiService.deleteTemplateMapping(this.dataFromresponse.extSys,this.dataFromresponse.processName,this.dataFromresponse.currency,this.dataFromresponse.sheetNumber).subscribe(e=>{1==e?(console.log(this.excelMappingForm.touched),console.log(1==this.formTouched),u().fire({text:"Role is Deleted",icon:"success"}).then(e=>{this.router.navigate(["/excel-mapping"])})):u().fire({title:"Failed to Delete the Recored!",icon:"error"})})})}onClickOfClose(e,t){console.log(this.dataFromresponse),u().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(e=>{!0===e.isConfirmed&&this.apiService.excelMappingAuditLog(this.dataFromresponse,"close").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.dataFromresponse=e,this.dataFromresponse?(this.authStatus=null===(t=this.dataFromresponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.dataFromresponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.dataFromresponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.dataFromresponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.dataFromresponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.dataFromresponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.dataFromresponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is Closed",icon:"success"}),this.auditLog()):u().fire({title:"Failed to Close the Recored!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}updateMappingData(e,t){this.submitted=!0,this.progress=!0;let o=e.excelMappingDetails[0].modifiedBy;o=this.currentUser,e.excelMappingDetails[0].excelMappingColumn=e.excelMappingDetails[0].mappingColumn;var i=Object.assign(Object.assign({},t),e);this.addForm.invalid?u().fire({text:"Numeric values not allowed in mapping column!",icon:"warning"}):this.apiService.createTemplateMap(i).subscribe(e=>{this.dataFromresponse=e,console.log(this.dataFromresponse),this.dataFromresponse?(this.editFlag=!1,this.dataSaved=!0,u().fire({text:"Record is Updated!",icon:"success"}),this.formTouched=!this.excelMappingForm.touched,this.cdr.markForCheck()):u().fire({text:"Failed to update ",icon:"error"})})}onClickOfAuth(e,t){var o;this.currentUser=localStorage.getItem("userFromLogin"),console.log("this.currentUser",this.currentUser,e,t),this.extCodeValue=t.extSysCode,this.extNameValue=t.extSysCode,this.proCodeValue=t.processName,this.currencyValue=t.currency,this.modifiedBy=null===(o=this.dataFromresponse[0])||void 0===o?void 0:o.modifiedBy,this.modifiedBy===this.currentUser&&u().fire({title:"Maker Cannot Authorized the Record!",icon:"error"})}letterOnly(e){var t=e.keyCode;return t>64&&t<91||t>96&&t<123||8==t}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(h.sM),p.Y36(n.qu),p.Y36(g.k),p.Y36(s.F0),p.Y36(p.sBO),p.Y36(a.I))},e.\u0275cmp=p.Xpm({type:e,selectors:[["npr-excel-mapping-new"]],decls:99,vars:27,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],[1,"col-auto"],["href","excel-mapping-new.html","routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLink"],["href","javascript:void(0)","routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["action","",1,"formStyle",3,"formGroup"],[1,"row","gy-4","align-items-end"],[1,"col-lg-4"],["for","extSystem",1,"formLbl"],[1,"colorRed"],["id","outlineNgSelect","formControlName","extSysCode","required","","aria-label","Default select example",2,"width","200px",3,"clearable","change"],["hidden","","value","","disabled","","selected",""],["class","form-class",3,"value",4,"ngFor","ngForOf"],["for","processName",1,"formLbl"],["class","form-select","formControlName","processName","required","","aria-label","Default select example",3,"change",4,"ngIf"],["type","text","formControlName","processName","required","","class","form-control","placeholder","Process Code","value","",3,"readonly",4,"ngIf"],["for","startingRow",1,"formLbl"],["id","startingRow","type","number","formControlName","startingRow","required","","placeholder","Data Starting Row","value","",1,"form-control",3,"readonly"],["for","currency",1,"formLbl"],["id","currency","type","text","formControlName","currency","name","currency","required","","placeholder","Currency","value","","minlength","1","maxlength","3","onkeydown","/[A-Z]/i.test(event.key)","oninput","this.value = this.value.toUpperCase()",1,"form-control",3,"readonly","keypress"],["for","sheetNumber",1,"formLbl"],["id","sheetNumber","type","number","formControlName","sheetNumber","placeholder","Sheet Number","value","",1,"form-control",3,"readonly"],[1,"checkStyle"],["type","checkbox","id","fcyRate","formControlName","headerRepeated"],["for","fcyRate"],["action","","novalidate","",1,"formStyle",3,"formGroup"],[1,"titleStyle","mt-2","mb-4"],[1,"pageTitle","darkgreyClr"],[1,"table-responsive"],["id","dbTable1",1,"table","tableStyle1","responsive","nowrap","vAlignMdl"],["formArrayName","excelMappingDetails"],[4,"ngFor","ngForOf"],["class","addIcon primarybg",3,"click",4,"ngIf"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],["class","col-auto",4,"ngIf"],["routerLinkActive","router-link-active",1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["class","dbCardStyle",4,"ngIf"],[1,"form-class",3,"value"],["formControlName","processName","required","","aria-label","Default select example",1,"form-select",3,"change"],["type","text","formControlName","processName","required","","placeholder","Process Code","value","",1,"form-control",3,"readonly"],[3,"formGroupName"],["id","sourceCode","type","text","formControlName","columnnName","placeholder","Name","value","",1,"form-control",3,"readonly"],["formControlName","dataType","placeholder","Choose DataType","aria-label","Default select example",1,"form-select",3,"change"],[1,"checkboxdiv"],["type","checkbox","formControlName","mandatory",3,"id"],[3,"for"],["type","text","formControlName","headerName","placeholder","Header Name","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","dateFormat","placeholder","Date Format","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","excelMappingColumn","placeholder","Mapping Column","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","delimeter","placeholder","Delimeter","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","defaultValue","placeholder","Default Value","value","",1,"form-control",3,"id","readonly"],["type","text","formControlName","repeatedTillNextValue","placeholder","Repeated Till Next Value","value","",1,"form-control",3,"id","readonly"],["class","deleteIcon2",4,"ngIf"],[1,"deleteIcon2"],[3,"click"],["src","assets/images/delete-icon.svg","alt","..."],[1,"addIcon","primarybg",3,"click"],["src","assets/images/plus-icon.svg","alt","..."],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnAuth",3,"click"],["color","primary",1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],["cclass","btn smBtn minWdSmBtn btnPrimary","color","primary",3,"click"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/first-auth-icon.svg","alt","..."]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Template Mapping"),p.qZA(),p.qZA(),p.TgZ(4,"div",3),p.TgZ(5,"div",4),p.TgZ(6,"div",5),p.TgZ(7,"a",6),p._uU(8,"Update Mapping"),p.qZA(),p.qZA(),p.TgZ(9,"div",5),p.TgZ(10,"a",7),p._uU(11,"Exit"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(12,"form",8),p.TgZ(13,"div",9),p.TgZ(14,"div",10),p.TgZ(15,"label",11),p._uU(16,"External System Code"),p.TgZ(17,"span",12),p._uU(18,"*"),p.qZA(),p.qZA(),p.TgZ(19,"ng-select",13),p.NdJ("change",function(){return t.getProcess(t.excelMappingForm.get("extSysCode").value)}),p.TgZ(20,"ng-option",14),p._uU(21,"Please select External System"),p.qZA(),p.YNc(22,L,2,2,"ng-option",15),p.qZA(),p.qZA(),p.TgZ(23,"div",10),p.TgZ(24,"label",16),p._uU(25,"Process Code"),p.TgZ(26,"span",12),p._uU(27,"*"),p.qZA(),p.qZA(),p.YNc(28,P,4,2,"select",17),p.YNc(29,V,1,1,"input",18),p.qZA(),p.TgZ(30,"div",10),p.TgZ(31,"label",19),p._uU(32,"Data Starting Row"),p.TgZ(33,"span",12),p._uU(34,"*"),p.qZA(),p.qZA(),p._UZ(35,"input",20),p.qZA(),p.TgZ(36,"div",10),p.TgZ(37,"label",21),p._uU(38,"Currency"),p.TgZ(39,"span",12),p._uU(40,"*"),p.qZA(),p.qZA(),p.TgZ(41,"input",22),p.NdJ("keypress",function(e){return t.letterOnly(e)}),p.qZA(),p.qZA(),p.TgZ(42,"div",10),p.TgZ(43,"label",23),p._uU(44,"Sheet Number"),p.TgZ(45,"span",12),p._uU(46,"*"),p.qZA(),p.qZA(),p._UZ(47,"input",24),p.qZA(),p.TgZ(48,"div",10),p.TgZ(49,"div",25),p._UZ(50,"input",26),p.TgZ(51,"label",27),p._uU(52,"Is Header Present"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(53,"div",3),p.TgZ(54,"form",28),p.TgZ(55,"div",29),p.TgZ(56,"h2",30),p._uU(57,"Select Minimum two mandatory row"),p.qZA(),p.qZA(),p.TgZ(58,"div",31),p.TgZ(59,"table",32),p.TgZ(60,"thead"),p.TgZ(61,"tr"),p.TgZ(62,"th"),p._uU(63,"Name"),p.qZA(),p.TgZ(64,"th"),p._uU(65,"data type"),p.qZA(),p.TgZ(66,"th"),p._uU(67,"mandatory"),p.qZA(),p.TgZ(68,"th"),p._uU(69,"header name"),p.qZA(),p.TgZ(70,"th"),p._uU(71,"date format"),p.qZA(),p.TgZ(72,"th"),p._uU(73,"mapping column"),p.qZA(),p.TgZ(74,"th"),p._uU(75,"delimeter"),p.qZA(),p.TgZ(76,"th"),p._uU(77,"default value"),p.qZA(),p.TgZ(78,"th"),p._uU(79,"repeated till next value"),p.qZA(),p.TgZ(80,"th"),p._uU(81,"delete"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(82,"tbody",33),p.YNc(83,j,28,19,"tr",34),p.TgZ(84,"tr"),p.TgZ(85,"td"),p.YNc(86,W,3,0,"a",35),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(87,"div",36),p.YNc(88,$,3,1,"div",37),p.YNc(89,X,3,0,"div",37),p.YNc(90,K,3,0,"div",37),p.YNc(91,ee,3,0,"div",37),p.YNc(92,te,3,0,"div",37),p.YNc(93,oe,3,0,"div",37),p.YNc(94,ie,3,2,"div",37),p.TgZ(95,"div",5),p.TgZ(96,"a",38),p._uU(97,"Exit"),p.qZA(),p.qZA(),p.qZA(),p.YNc(98,se,100,14,"div",39),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(7),p.Q6J("routerLink",p.DdM(24,ae)),p.xp6(3),p.Q6J("routerLink",p.DdM(25,re)),p.xp6(2),p.Q6J("formGroup",t.excelMappingForm),p.xp6(7),p.Q6J("clearable",!1),p.uIk("disabled",t.editFlag?"":null),p.xp6(3),p.Q6J("ngForOf",t.extSysData),p.xp6(6),p.Q6J("ngIf","select"===t.processNameField),p.xp6(1),p.Q6J("ngIf","text"===t.processNameField),p.xp6(6),p.Q6J("readonly",t.editFlag),p.xp6(6),p.Q6J("readonly",t.editFlag),p.xp6(6),p.Q6J("readonly",t.editFlag),p.xp6(3),p.uIk("disabled",!!t.editFlag||null),p.xp6(4),p.Q6J("formGroup",t.addForm),p.xp6(29),p.Q6J("ngForOf",t.addForm.get("excelMappingDetails").controls),p.xp6(3),p.Q6J("ngIf",!t.editFlag),p.xp6(2),p.Q6J("ngIf",t.showUpdate),p.xp6(1),p.Q6J("ngIf",t.dataFromresponse&&!t.showUpdate),p.xp6(1),p.Q6J("ngIf",t.dataFromresponse&&("U"==t.dataFromresponse.authStatus||"UNAUTHORIZED"==t.dataFromresponse.authStatus)&&!t.showUpdate),p.xp6(1),p.Q6J("ngIf",t.dataFromresponse&&("N"==t.dataFromresponse.firstTimeAuth||"NO"==t.dataFromresponse.firstTimeAuth)&&("O"==t.dataFromresponse.recordStatus||"OPEN"==t.dataFromresponse.recordStatus)&&!t.showUpdate),p.xp6(1),p.Q6J("ngIf",t.dataFromresponse&&("O"==t.dataFromresponse.recordStatus||"OPEN"==t.dataFromresponse.recordStatus)&&("Y"==t.dataFromresponse.firstTimeAuth||"YES"==t.dataFromresponse.firstTimeAuth)&&!t.showUpdate),p.xp6(1),p.Q6J("ngIf",t.dataFromresponse&&("C"==t.dataFromresponse.recordStatus||"CLOSED"==t.dataFromresponse.recordStatus)&&("Y"==t.dataFromresponse.firstTimeAuth||"YES"==t.dataFromresponse.firstTimeAuth)&&!t.showUpdate),p.xp6(1),p.Q6J("ngIf",!t.dataFromresponse),p.xp6(2),p.Q6J("routerLink",p.DdM(26,ne)),p.xp6(2),p.Q6J("ngIf",t.dataFromresponse))},directives:[s.yS,s.Od,n._Y,n.JL,n.sg,Q.w9,n.JJ,n.u,n.Q7,Q.jq,i.sg,i.O5,n.wV,n.Fj,n.wO,n.nD,n.Wl,n.CE,n.EJ,n.YN,n.Kr,n.x0],pipes:[i.uU],styles:[".form-class[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#797979;background-color:#fff;background-clip:padding-box;border-bottom:1px solid #ebebeb;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;-webkit-appearance:none;-moz-appearance:none;appearance:none;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}table.tableStyle1[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:10px;text-transform:uppercase;border-bottom:1px solid #F5F5F5}.form-control1[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:10px;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:.25rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control1[_ngcontent-%COMP%]:disabled, .form-control1[readonly][_ngcontent-%COMP%]{background-color:#fff;opacity:1}.checkboxdiv[_ngcontent-%COMP%]{padding-left:25px;padding-bottom:15px;cursor:pointer}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;pointer-events:all!important}.madatoryLabel[_ngcontent-%COMP%]{display:none}"]}),e})();var de=o(17988);const ce=function(){return["/excel-mapping/excel-mapping-new"]};function ue(e,t){if(1&e&&(p.TgZ(0,"div",6),p.TgZ(1,"a",12),p._uU(2),p.qZA(),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("routerLink",p.DdM(2,ce)),p.xp6(1),p.Oqu(e.roleCodes.new.labelDescription)}}function pe(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",19),p.NdJ("click",function(){p.CHM(e);const t=p.oxw().$implicit;return p.oxw().close(t)}),p._UZ(1,"img",20),p.qZA()}}function he(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",21),p.NdJ("click",function(){p.CHM(e);const t=p.oxw().$implicit;return p.oxw().open(t)}),p._UZ(1,"img",22),p.qZA()}}function ge(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"button",23),p.NdJ("click",function(){p.CHM(e);const t=p.oxw().$implicit;return p.oxw().delete(t)}),p._UZ(1,"img",24),p.qZA()}}function me(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"a",13),p.NdJ("click",function(){const t=p.CHM(e).$implicit;return p.oxw().setDataFromSummaryToUpdateExcelMapping(t)}),p._uU(3),p.qZA(),p.qZA(),p.TgZ(4,"td"),p._uU(5),p.qZA(),p.TgZ(6,"td"),p._uU(7),p.qZA(),p.TgZ(8,"td"),p._uU(9),p.qZA(),p.TgZ(10,"td"),p._uU(11),p.qZA(),p.TgZ(12,"td"),p._uU(13),p.qZA(),p.TgZ(14,"td"),p._uU(15),p.qZA(),p.TgZ(16,"td"),p._uU(17),p.ALo(18,"date"),p.qZA(),p.TgZ(19,"td"),p.TgZ(20,"button",14),p.NdJ("click",function(){const t=p.CHM(e).$implicit;return p.oxw().auth(t)}),p._UZ(21,"img",15),p.qZA(),p.YNc(22,pe,2,0,"button",16),p.YNc(23,he,2,0,"button",17),p.YNc(24,ge,2,0,"button",18),p.qZA(),p.qZA()}if(2&e){const e=t.$implicit;p.xp6(3),p.Oqu(e.processName),p.xp6(2),p.Oqu(e.extSysCode),p.xp6(2),p.Oqu(e.extSys),p.xp6(2),p.Oqu(e.currency),p.xp6(2),p.Oqu(e.sheetNumber),p.xp6(2),p.Oqu(e.authStatus),p.xp6(2),p.Oqu(e.recordStatus),p.xp6(2),p.Oqu(p.xi3(18,12,e.inputDtStamp,"medium")),p.xp6(3),p.Q6J("disabled",!("U"==e.authStatus||"UNAUTHORIZED"==e.authStatus||"Unauthorized"==e.authStatus)),p.xp6(2),p.Q6J("ngIf","O"==e.recordStatus||"Open"==e.recordStatus||"OPEN"==e.recordStatus),p.xp6(1),p.Q6J("ngIf","C"==e.recordStatus||"CLOSED"==e.recordStatus||"Close"==e.recordStatus),p.xp6(1),p.Q6J("ngIf","N"==e.firstTimeAuth||"NO"==e.firstTimeAuth)}}function Ze(e,t){1&e&&(p.ynx(0),p.TgZ(1,"div",25),p.TgZ(2,"span",26),p._uU(3,"Please wait... "),p._UZ(4,"span",27),p.qZA(),p.qZA(),p.BQk())}const fe=function(){return["/dashboard"]},ve=[{path:"",component:(()=>{class e{constructor(e,t,o,i){this.apiService=e,this.roleService=t,this.toastService=o,this.router=i,this.dtOptions={},this.dtTrigger=new l.xQ,this.isLoading=!1,this.roleCodes=new d.yv,this.statusArr=["Authorized","Unauthorized","Open","Close"]}ngOnInit(){this.dtOptions={pagingType:"full_numbers",pageLength:5,columnDefs:[{type:"date",targets:[7]}],order:[[7,"desc"]],processing:!0,lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]]},this.currentUser=localStorage.getItem("userFromLogin"),this.getexcelMappingSummary(),this.roleService.fetchScreenPermissions("Template Mapping"),this.roleService.screenLabelList.subscribe(e=>this.roleCodes=e),console.log(this.roleCodes)}auditLog(){("U"==this.excelMappingSummary.authStatus||"Unauthorized"==this.excelMappingSummary.authStatus)&&(this.excelMappingSummary.authStatus="UNAUTHORIZED"),("A"==this.excelMappingSummary.authStatus||"Authorized"==this.excelMappingSummary.authStatus)&&(this.excelMappingSummary.authStatus="AUTHORIZED"),"O"==this.excelMappingSummary.recordStatus&&(this.excelMappingSummary.recordStatus="OPEN"),"C"==this.excelMappingSummary.recordStatus&&(this.excelMappingSummary.recordStatus="CLOSED"),"N"==this.excelMappingSummary.verifiedOnce&&(console.log("NO"),this.excelMappingSummary.verifiedOnce="NO"),"Y"==this.excelMappingSummary.verifiedOnce&&(this.excelMappingSummary.verifiedOnce="YES")}getexcelMappingSummary(){this.isLoading=!0,this.apiService.getMappingSummary().subscribe(e=>{console.log(e),this.mappingResponse=e;for(let t of e.result)t.authStatus=this.statusArr.find(e=>e.startsWith(t.authStatus)),t.recordStatus=this.statusArr.find(e=>e.startsWith(t.recordStatus));this.excelData=e.result,console.log(this.excelData),this.isLoading=!1,this.dtTrigger.next()})}close(e){console.log(e),u().fire({text:"You are trying to Close the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.apiService.excelMappingAuditLog(e,"close").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.newDataResponse=e,this.newDataResponse?(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.newDataResponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.newDataResponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.newDataResponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is  Closed",icon:"success"}).then(()=>window.location.reload()),this.auditLog()):u().fire({title:"Failed to Close the Recored!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}open(e){u().fire({text:"You are trying to re-open record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{console.log("this is reopen ",t),!0===t.isConfirmed&&this.apiService.excelMappingAuditLog(e,"reopen").subscribe(e=>{var t,o,i,s,a,r,n;console.log(e),this.newDataResponse=e,this.newDataResponse?(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedBy=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputBy,this.modifiedTime=null===(s=this.newDataResponse)||void 0===s?void 0:s.inputDtStamp,this.authorizedBy=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedBy,this.authorizedTime=null===(r=this.newDataResponse)||void 0===r?void 0:r.authorizedTime,this.version=null===(n=this.newDataResponse)||void 0===n?void 0:n.version,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),u().fire({title:"Record is Reopened",icon:"success"}).then(()=>window.location.reload()),this.auditLog()):u().fire({title:"Failed to Reopen the Record!",icon:"error"})},e=>{r.UA&&u().fire({text:"Server Error!",icon:"error"})})})}delete(e){console.log(e)}auth(e){console.log(e),this.currentUser=localStorage.getItem("userFromLogin"),this.modifiedBy===this.currentUser?u().fire({title:"Maker Cannot Authorized the Record!",icon:"error"}):u().fire({text:"You are trying to Authorize the record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(t=>{!0===t.isConfirmed&&this.apiService.excelMappingAuditLog(e,"authorize").subscribe(e=>{var t,o,i,s,a,r,n,l;this.newDataResponse=e,this.newDataResponse&&(this.authStatus=null===(t=this.newDataResponse)||void 0===t?void 0:t.authStatus,this.recordStatus=null===(o=this.newDataResponse)||void 0===o?void 0:o.recordStatus,this.modifiedTime=null===(i=this.newDataResponse)||void 0===i?void 0:i.inputDtStamp,this.authorizedBy=null===(s=this.newDataResponse)||void 0===s?void 0:s.authorizedBy,this.authorizedTime=null===(a=this.newDataResponse)||void 0===a?void 0:a.authorizedDtStamp,this.version=null===(r=this.newDataResponse)||void 0===r?void 0:r.version,this.firstTimeAuth=null===(n=this.newDataResponse)||void 0===n?void 0:n.firstTimeAuth,this.modifiedBy=null===(l=this.newDataResponse)||void 0===l?void 0:l.inputBy,"U"===this.authStatus&&(this.authStatus="UNAUTHORIZED"),"A"===this.authStatus&&(this.authStatus="AUTHORIZED"),"C"===this.recordStatus&&(this.recordStatus="CLOSED"),"O"===this.recordStatus&&(this.recordStatus="OPEN"),"Y"===this.firstTimeAuth&&(this.firstTimeAuth="YES"),"N"===this.firstTimeAuth&&(this.firstTimeAuth="NO"),u().fire({title:"Record is Authorized",icon:"success"}).then(()=>window.location.reload()))})})}setDataFromSummaryToUpdateExcelMapping(e){localStorage.setItem("summryResponse",JSON.stringify(e)),this.apiService.setexcelSummaryData({extSysCode:e.extSysCode,extSys:e.extSys,processName:e.processName,authStatus:e.authStatus,currency:e.currency,sheetNumber:e.sheetNumber}),this.router.navigate(["/excel-mapping/excel-mapping-edit"])}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(h.sM),p.Y36(m.N),p.Y36(g.k),p.Y36(s.F0))},e.\u0275cmp=p.Xpm({type:e,selectors:[["npr-excel-mapping"]],decls:35,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],["class","col-auto",4,"ngIf"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],[1,"table-responsive"],["id","dbTable1","datatable","",1,"dataTable","table","tableStyle","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLink"],[1,"primaryColor",2,"cursor","pointer",3,"click"],["title","Authorize",1,"btn",2,"color","red",3,"disabled","click"],["src","assets/images/authorize.svg","alt","Authorize",1,"summaryIcon"],["class","btn","style","color: red","title","Close",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Reopen",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Delete",3,"click",4,"ngIf"],["title","Close",1,"btn",2,"color","red",3,"click"],["src","assets/images/CROSS1.svg","alt","...",1,"summaryIcon"],["title","Reopen",1,"btn",2,"color","red",3,"click"],["src","assets/images/open.svg","alt","...",1,"summaryIcon"],["title","Delete",1,"btn",2,"color","red",3,"click"],["src","assets/images/delete.svg","alt","...",1,"summaryIcon"],[1,"loading-page-center"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Template Mapping Summary"),p.qZA(),p.qZA(),p.TgZ(4,"div",3),p.TgZ(5,"div",4),p.YNc(6,ue,3,3,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"a",7),p._uU(9,"Exit"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",8),p.TgZ(11,"table",9),p.TgZ(12,"thead"),p.TgZ(13,"tr"),p.TgZ(14,"th"),p._uU(15,"Process Code"),p.qZA(),p.TgZ(16,"th"),p._uU(17,"External System Code"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"External system name"),p.qZA(),p.TgZ(20,"th"),p._uU(21,"Currency"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"Sheet Number"),p.qZA(),p.TgZ(24,"th"),p._uU(25,"Auth status"),p.qZA(),p.TgZ(26,"th"),p._uU(27,"Record status"),p.qZA(),p.TgZ(28,"th"),p._uU(29,"Date"),p.qZA(),p.TgZ(30,"th"),p._uU(31,"Action"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(32,"tbody"),p.YNc(33,me,25,15,"tr",10),p.qZA(),p.qZA(),p.qZA(),p.YNc(34,Ze,5,0,"ng-container",11),p.qZA(),p.qZA()),2&e&&(p.xp6(6),p.Q6J("ngIf",t.roleCodes.new),p.xp6(2),p.Q6J("routerLink",p.DdM(6,fe)),p.xp6(3),p.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),p.xp6(22),p.Q6J("ngForOf",t.excelData),p.xp6(1),p.Q6J("ngIf",t.isLoading))},directives:[i.O5,s.yS,de.G,i.sg],pipes:[i.uU],styles:[".overflow[_ngcontent-%COMP%]{overflow:auto}table.tableStyle[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#a6aab5;font-size:9px;text-transform:uppercase;letter-spacing:1px;padding:16px 13px;border-bottom:1px solid #F5F5F5}"]}),e})()},{path:"excel-mapping-new",component:le,canDeactivate:[a.I]},{path:"excel-mapping-edit",component:Y,canDeactivate:[a.I]}];let xe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[s.Bz.forChild(ve)],s.Bz]}),e})(),Ae=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[i.ez,xe,de.T,n.u5,n.UX,Q.A0]]}),e})()}}]);