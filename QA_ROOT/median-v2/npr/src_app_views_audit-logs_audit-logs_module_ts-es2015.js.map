{"version":3,"file":"src_app_views_audit-logs_audit-logs_module_ts-es2015.js","mappings":"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","sources":["./src/app/views/audit-logs/audit-logs-routing.module.ts","./src/app/views/audit-logs/audit-logs.component.ts","./src/app/views/audit-logs/audit-logs.component.html","./src/app/views/audit-logs/audit-logs.module.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { AuditLogsComponent } from './audit-logs.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: AuditLogsComponent\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AuditLogsRoutingModule { }\r\n","import { ChangeDetectorRef, Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { ApiService } from 'src/app/shared/services/api.service';\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\nimport 'rxjs/add/operator/map';\r\nimport { DatePipe } from '@angular/common';\r\nimport { AccountClosureServiceService } from 'src/app/shared/services/account-closure-service.service';\r\nimport { RoleService } from 'src/app/shared/services/role.service';\r\nimport { permissionsLabels } from 'src/app/shared/models/fmosNewRolePermissions';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { AppConstants } from 'src/app/shared/config/app.constant';\r\nimport * as XLSX from \"xlsx\";\r\n\r\n@Component({\r\n  selector: 'npr-audit-logs',\r\n  templateUrl: './audit-logs.component.html',\r\n  styleUrls: ['./audit-logs.component.scss']\r\n})\r\nexport class AuditLogsComponent implements OnInit {\r\n  isLoading:boolean = false;\r\n  isSelected: boolean = true;\r\n  dtOptions: DataTables.Settings = {};\r\n  auditlogdata: any;\r\n  pipe = new DatePipe('en-US');\r\n  roleCodes = new permissionsLabels();\r\n  API_URL = AppConstants.baseURL;\r\n  @ViewChild(\"format\") format: ElementRef;\r\n  totalPages: any;\r\n  totalRecords: any;\r\n  arrayData: any;\r\n\r\n\r\n  constructor(private api: ApiService,private http: HttpClient, private excelService: AccountClosureServiceService, private cdr:ChangeDetectorRef,private roleService:RoleService) { }\r\n\r\n  ngOnInit(): void {\r\n    \r\n    this.dtOptions = {\r\n      pagingType: 'full_numbers',\r\n      pageLength : 5,\r\n      serverSide: true,\r\n      processing: true,\r\n      columnDefs: [ { type: 'date', 'targets': [5] } ],\r\n      order: [[5, 'desc']],\r\n      // lengthMenu: [[5, 10, 20, 30], [5, 10, 20, 30]],\r\n      lengthMenu: [\r\n        [5, 10, 20, 30,-1],\r\n        [5, 10, 20, 30,\"ALL\"],\r\n      ],\r\n       \r\n      ajax: (dataTablesParameters: any, callback) => {\r\n        ;\r\n        dataTablesParameters.minNumber = dataTablesParameters.start + 1;\r\n        dataTablesParameters.maxNumber =\r\n          dataTablesParameters.start + dataTablesParameters.length;\r\n        console.log(\r\n          dataTablesParameters.minNumber,\r\n          dataTablesParameters.maxNumber\r\n        );\r\n        const pageNo = Math.floor(dataTablesParameters.minNumber / dataTablesParameters.length);\r\n        const pageSize = dataTablesParameters.length;\r\n        \r\n        this.http.get<any>(`${this.API_URL}`+`/auditLogs/getAllAuditLogs?pageNo=${pageNo}&pageSize=${pageSize}`)\r\n          .subscribe(resp => {\r\n            ;\r\n            console.log(resp);\r\n            this.totalPages = resp.totalNoOfPages;\r\n            this.totalRecords = resp.totalRecords;\r\n            this.auditlogdata = resp.result;\r\n            this.isLoading = false;\r\n            this.cdr.markForCheck();\r\n\r\n            callback({\r\n              recordsTotal: resp.totalRecords,\r\n              recordsFiltered: resp.totalRecords,\r\n              data: [],\r\n            });\r\n          });\r\n      },\r\n    };\r\n\r\n    // this.getAuditLogList();\r\n    this.roleService.fetchScreenPermissions('Audit Logs');\r\n  \r\n    this.roleService.screenLabelList.subscribe(message => this.roleCodes = message);\r\n    console.log(this.roleCodes);\r\n  }\r\n\r\n\r\n  modo(event) {\r\n    console.log(event);\r\n    if (this.format.nativeElement.value == 'PDF') {\r\n     this.downloadLog(this.totalRecords,this.totalPages);\r\n    }\r\n    if (this.format.nativeElement.value === 'Excel') {\r\n      this.exportAsXLSX();\r\n    }\r\n\r\n  }\r\n  exportAsXLSX(): void {\r\n    console.log(this.auditlogdata);\r\n    this.http.get<any>(`${this.API_URL}`+`/auditLogs/getAllAuditLogs?pageNo=${0}&pageSize=${this.totalRecords}`)\r\n    .subscribe(resp => {\r\n      this.arrayData=resp.result;\r\n      this.arrayData.forEach(element => {\r\n        element.timeForExport = this.pipe.transform(element.timeForExport, 'dd-MMM-yy');\r\n        element.updatedAt = this.pipe.transform(element.updatedAt, 'dd-MMM-yy');\r\n        element.creatorDtStamp = this.pipe.transform(element.creatorDtStamp, 'dd-MMM-yy');\r\n        element.verifierDtStamp=this.pipe.transform(element.verifierDtStamp,'dd-MMM-yy')\r\n      });\r\n      this.excelService.exportAsExcelFile(this.arrayData, 'Audit_Report');\r\n    });\r\n   \r\n  }\r\n\r\n  downloadLog(totalRecords,totalNoOfPages){\r\n    // getSecurityPolicies?pageNo=${0}&pageSize=${1000}&sortBy=${sortBy}`\r\n    this.http.get<any>(`${this.API_URL}`+`/auditLogs/getAllAuditLogs?pageNo=${0}&pageSize=${totalRecords}`)\r\n          .subscribe(resp => {\r\n            this.convert(resp.result)\r\n          });\r\n  }\r\n  convert(data) {\r\n\r\n    var doc = new jsPDF();\r\n    var col = [[\"Screen\", \"creatorId\", \"ActionPerformBy\", \"Record\", \"Action\", \"Time\"]];\r\n    var rows = [];\r\n\r\n  \r\n    var itemNew = data;\r\n\r\n    itemNew.forEach(element => {\r\n      var date = new Date(element.creatorDtStamp).toLocaleDateString(\"en-us\");\r\n      console.log(date)\r\n      var temp = [element.log, element.creatorId, element.actionPerformBy, element.record, element.action, date];\r\n      rows.push(temp);\r\n    });\r\n\r\n    //doc.autoTable(col, rows);\r\n    doc.autoTable({\r\n      head: col,\r\n      body: rows\r\n    });\r\n    doc.save('AuditLog.pdf');\r\n  }\r\n}\r\n","<div class=\"pageContentMain\">\r\n    <div class=\"pageTitleCol\">\r\n      <h2 class=\"pageTitle\">Audit Logs</h2>\r\n    </div>\r\n   \r\n      <div class=\"col-2\" *ngIf=\"!isLoading\">\r\n        <label for=\"roleName\" class=\"formLbl\">Export As</label>\r\n        <select class=\"form-select\"  aria-label=\"Default select example\" #format >\r\n          <!-- <option>--Choose file type--</option> -->\r\n          <option selected value=\"Excel\">Excel</option>\r\n          <option value=\"PDF\">PDF</option>\r\n          \r\n        </select>\r\n        <button class=\"downloadForAuditLog\" (click)=\"modo($event)\" >Download</button>\r\n         \r\n      \r\n      </div><br>\r\n      <div class=\"dbCardStyle table-responsive\">\r\n        <table id=\"auditLogsTable\" datatable [dtOptions]=\"dtOptions\" class=\"table tableStyle tableStyleSelect  nowrap vAlignMdl\" \r\n            style=\"width:100%\">\r\n          <thead>\r\n            <tr>\r\n              <th>Screen</th>\r\n              <th>Creator</th>\r\n              <th>Action Perform By</th>\r\n              <th>Record</th>\r\n              <th>Action</th>\r\n              <th>Date</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody *ngIf=\"auditlogdata?.length != 0\">\r\n            <tr *ngFor=\"let audits of auditlogdata\">\r\n              <td>{{audits.log}}</td>\r\n              <td>{{audits.creatorId}}</td>\r\n              <td>{{audits.actionPerformBy}}</td>\r\n              <td>{{audits.record}}</td>\r\n              <td>{{audits.action}}</td>\r\n              <td>{{audits.creatorDtStamp | date:'medium'}}</td>\r\n            </tr>\r\n          </tbody>\r\n          <tbody *ngIf=\"auditlogdata?.length == 0\">\r\n            <tr>\r\n              <td colspan=\"3\" class=\"no-data-available\">No data!</td>\r\n            </tr>\r\n          </tbody>        \r\n        </table>\r\n        <ng-container *ngIf=\"isLoading\">\r\n          <div class=\"loading-page-center\">\r\n            <span class=\"indicator-progress\">Please wait...\r\n              <span class=\"spinner-border spinner-border-sm align-middle ms-2\"></span></span>\r\n          </div>\r\n        </ng-container>\r\n      </div>\r\n\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { AuditLogsRoutingModule } from './audit-logs-routing.module';\r\nimport { AuditLogsComponent } from './audit-logs.component';\r\nimport { DataTablesModule } from 'angular-datatables';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AuditLogsComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    AuditLogsRoutingModule,\r\n    DataTablesModule\r\n  ]\r\n})\r\nexport class AuditLogsModule { }\r\n"],"names":[],"sourceRoot":"webpack:///"}