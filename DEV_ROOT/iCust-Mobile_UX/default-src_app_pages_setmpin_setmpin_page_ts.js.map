{"version":3,"file":"default-src_app_pages_setmpin_setmpin_page_ts.js","mappings":"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","sources":["./src/app/pages/setmpin/setmpin.page.ts"],"sourcesContent":["import { Location } from '@angular/common';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { ToastController } from '@ionic/angular';\r\nimport { ApiService } from 'src/app/services/api.service';\r\nimport { DataService } from 'src/app/services/data.service';\r\nimport { UniqueDeviceID } from '@ionic-native/unique-device-id/ngx';\r\nimport { FormControl, FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Router, NavigationExtras } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-setmpin',\r\n  templateUrl: './setmpin.page.html',\r\n  styleUrls: ['./setmpin.page.scss'],\r\n})\r\nexport class SetmpinPage implements OnInit {\r\n  isLoading: boolean = false;\r\n  customerPhonenum: string;\r\n  newMpin = new FormControl();\r\n  mpinForm: FormGroup;\r\n  mpin = new FormControl();\r\n  mpinobj = new mpinObjects();\r\n  deviceUUID: string;\r\n  navSubscription: any;\r\n  screenNames: any;\r\n\r\n  config = {\r\n    allowNumbersOnly: true,\r\n    length: 4,\r\n    isPasswordInput: false,\r\n    disableAutoFocus: false,\r\n    placeholder: '',\r\n    inputStyles: {\r\n      'width': '50px',\r\n      'height': '50px'\r\n    }\r\n  };\r\n\r\n  constructor(private router: Router,\r\n    private location: Location,\r\n    private api: ApiService,\r\n    private fb: FormBuilder,\r\n    public toastCtrl: ToastController,\r\n    private uniqueDeviceID: UniqueDeviceID,\r\n    private dataService: DataService) { }\r\n\r\n  ngOnInit() {\r\n    this.customerPhonenum = localStorage.getItem('customerPhonenum');\r\n    this.mpinForm = this.fb.group({\r\n      phoneNumber: ['', Validators.required],\r\n      deviceId: ['', Validators.required],\r\n      mpin: ['', Validators.required],\r\n      confirmMpin: [],\r\n    });\r\n\r\n    this.navSubscription = this.api.getNavParam.subscribe(\r\n      (data: any) => (this.screenNames = data)\r\n    );\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.getUniqueDeviceID();\r\n  }\r\n\r\n  back() {\r\n    this.location.back();\r\n  }\r\n\r\n  forgotmpin() {\r\n    this.router.navigateByUrl('/forgotmpin');\r\n  }\r\n\r\n  async openToast(message) {\r\n    const toast = await this.toastCtrl.create({\r\n      message: `${message}`,\r\n      duration: 2500,\r\n      position: 'bottom',\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  getUniqueDeviceID() {\r\n    this.uniqueDeviceID.get()\r\n      .then((uuid: any) => {\r\n        console.log(uuid);\r\n        this.deviceUUID = uuid;\r\n      })\r\n      .catch((error: any) => {\r\n        console.log(error);\r\n        this.deviceUUID = \"\";\r\n      });\r\n  }\r\n\r\n\r\n  async setMpin() {\r\n\r\n    if (!this.newMpin.value || this.newMpin.value < 4 || !this.mpin.value || this.mpin.value.length < 4) {\r\n      this.openToast('Enter valid mPin');\r\n      return;\r\n    }\r\n\r\n    if (this.newMpin.value !== this.mpin.value) {\r\n      this.openToast('New and current mPin did not match');\r\n      return;\r\n    }\r\n\r\n    this.mpinobj.phoneNumber = this.customerPhonenum;\r\n    this.mpinobj.mpin = this.mpin.value;\r\n    this.mpinobj.deviceId = this.deviceUUID;\r\n\r\n    if (this.newMpin.value !== this.mpin.value) {\r\n      this.openToast('mPin did not match');\r\n      return;\r\n    }\r\n\r\n    this.api\r\n      .setMpin(this.mpinobj)\r\n      .subscribe((res: any) => {\r\n        if (res.status == 200) {\r\n          localStorage.setItem('deviceId', this.deviceUUID);\r\n          localStorage.setItem(\r\n            'customer_details',\r\n            JSON.stringify(res.data)\r\n          );\r\n          this.dataService.isLoggedIn.next(true);\r\n          const navigationExtras: NavigationExtras = {\r\n            queryParams: {\r\n              'screenDetails': 'Set Login mPIN!',\r\n              'screenDescription': 'Your mPIN has been registered successfully',\r\n              'screenName': this.screenNames.queryParams.screenName == \"forgotmpin\" ? 'forgotmpin' :'setmpin'\r\n            },\r\n          };\r\n          this.api.sendNavParam(navigationExtras);\r\n          this.router.navigateByUrl('/success-message');\r\n        } else {\r\n          this.openToast(res.message);\r\n        }\r\n      }, (error: any) => {\r\n        this.isLoading = false;\r\n      });\r\n  }\r\n\r\n}\r\nexport class mpinObjects {\r\n  phoneNumber: any;\r\n  mpin: any;\r\n  deviceId: any;\r\n  currentMpin?: any\r\n}"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}