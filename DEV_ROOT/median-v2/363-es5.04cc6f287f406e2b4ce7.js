!function(){"use strict";function e(e,o){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,o){if(!e)return;if("string"==typeof e)return t(e,o);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,o)}(e))||o&&e&&"number"==typeof e.length){i&&(e=i);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,n=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){a=!0,l=e},f:function(){try{n||null==i.return||i.return()}finally{if(a)throw l}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkmedian=self.webpackChunkmedian||[]).push([[363],{17988:function(e,t,o){o.d(t,{G:function(){return r},T:function(){return l}});var i=o(37716),r=function(){function e(e,t,o){this.el=e,this.vcr=t,this.renderer=o,this.dtOptions={}}return e.prototype.ngOnInit=function(){var e=this;this.dtTrigger?this.dtTrigger.subscribe(function(t){e.displayTable(t)}):this.displayTable(null)},e.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},e.prototype.displayTable=function(e){var t=this;e&&(this.dtOptions=e),this.dtInstance=new Promise(function(e,o){Promise.resolve(t.dtOptions).then(function(i){0===Object.keys(i).length&&0===$("tbody tr",t.el.nativeElement).length?o("Both the table and dtOptions cannot be empty"):setTimeout(function(){var o={rowCallback:function(e,o,r){if(i.columns){var s=i.columns;t.applyNgPipeTransform(e,s),t.applyNgRefTemplate(e,s,o)}i.rowCallback&&i.rowCallback(e,o,r)}};o=Object.assign({},i,o),t.dt=$(t.el.nativeElement).DataTable(o),e(t.dt)})})})},e.prototype.applyNgPipeTransform=function(e,t){t.filter(function(e){return e.ngPipeInstance&&!e.ngTemplateRef}).forEach(function(o){var i=o.ngPipeInstance,r=t.findIndex(function(e){return e.data===o.data}),s=e.childNodes.item(r),l=$(s).text(),n=i.transform(l);$(s).text(n)})},e.prototype.applyNgRefTemplate=function(e,t,o){var i=this;t.filter(function(e){return e.ngTemplateRef&&!e.ngPipeInstance}).forEach(function(r){var s=r.ngTemplateRef,l=s.ref,n=s.context,a=t.findIndex(function(e){return e.data===r.data}),c=e.childNodes.item(a);$(c).html("");var d=Object.assign({},n,null==n?void 0:n.userData,{adtData:o}),u=i.vcr.createEmbeddedView(l,d);i.renderer.appendChild(c,u.rootNodes[0])})},e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(i.s_b),i.Y36(i.Qsj))},e.\u0275dir=i.lG2({type:e,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),e}(),s=o(38583),l=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[s.ez]]}),e}()},9363:function(t,o,s){s.r(o),s.d(o,{RolesModule:function(){return X}});var l=s(38583),n=s(39895),a=s(50215),c=s(3679),d=s(81770),u=s(79765),h=s(35383),m=i(function e(){r(this,e)}),f=i(function e(){r(this,e)}),g=s(88259),b=s.n(g),p=s(37716),v=s(77382),Z=s(94761),y=s(80463);function T(e,t){1&e&&(p.TgZ(0,"div"),p._uU(1," Please Enter RoleName "),p.qZA())}function R(e,t){1&e&&(p.TgZ(0,"div"),p._uU(1," RoleName cannot contain space "),p.qZA())}function S(e,t){if(1&e&&(p.TgZ(0,"div",25),p.YNc(1,T,2,0,"div",26),p.YNc(2,R,2,0,"div",26),p.qZA()),2&e){var o=p.oxw();p.xp6(1),p.Q6J("ngIf",o.myform.get("roleName").errors.required),p.xp6(1),p.Q6J("ngIf",o.myform.get("roleName").errors.cannotContainSpace)}}function A(e,t){1&e&&(p.TgZ(0,"div"),p._uU(1," Please Enter RoleDesc "),p.qZA())}function O(e,t){if(1&e&&(p.TgZ(0,"div",25),p.YNc(1,A,2,0,"div",26),p.qZA()),2&e){var o=p.oxw();p.xp6(1),p.Q6J("ngIf",o.myform.get("roleDesc").errors.required)}}function N(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",28),p.NdJ("click",function(){var e=p.CHM(o).$implicit;return p.oxw().getPermission(e.tabId,e.tabName)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=t.$implicit,r=p.oxw();p.xp6(1),p.Q6J("ngClass",i.tabName==r.btnNameSelected?"active":"notActive")("disabled",r.editFlag),p.xp6(1),p.Oqu(i.tabName)}}function E(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"span",29),p._uU(3),p.qZA(),p.qZA(),p.TgZ(4,"td"),p.TgZ(5,"div",17),p.TgZ(6,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"SELECTALL",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(7,"td"),p.TgZ(8,"div",17),p.TgZ(9,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"VIEW",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"td"),p.TgZ(11,"div",17),p.TgZ(12,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"NEW",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(13,"td"),p.TgZ(14,"div",17),p.TgZ(15,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"EDIT",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(16,"td"),p.TgZ(17,"div",17),p.TgZ(18,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"AUTH",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(19,"td"),p.TgZ(20,"div",17),p.TgZ(21,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"DELETE",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(22,"td"),p.TgZ(23,"div",17),p.TgZ(24,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"CLOSE",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(25,"td"),p.TgZ(26,"div",17),p.TgZ(27,"input",18),p.NdJ("click",function(e){var t=p.CHM(o).$implicit;return p.oxw().clickRoleAction(t,"REOPEN",e.target.checked)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&e){var i=t.$implicit,r=p.oxw();p.xp6(3),p.Oqu(i.Screens),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked",r.selectAllChecked),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.VIEW),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.NEW),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.EDIT),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.AUTH),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.DELETE),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.CLOSE),p.xp6(3),p.Q6J("disabled",r.editFlag)("checked","0"!=i.REOPEN)}}var q=function(){return["/roles/list"]};function I(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",30),p.TgZ(1,"div",27),p.TgZ(2,"button",31),p.NdJ("click",function(){return p.CHM(o),p.oxw().onSubmit()}),p._uU(3,"Save"),p.qZA(),p.qZA(),p.TgZ(4,"div",27),p.TgZ(5,"button",32),p._uU(6,"Exit"),p.qZA(),p.qZA(),p.qZA()}if(2&e){var i=p.oxw();p.xp6(2),p.uIk("disabled",!i.myform.valid||i.submitBtn),p.xp6(3),p.Q6J("routerLink",p.DdM(2,q))}}function C(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",34),p.NdJ("click",function(){return p.CHM(o),p.oxw(2).editValues()}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(2),p.hij("",i.roleCodes.edit.labelDescription," ")}}function k(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",35),p.NdJ("click",function(){return p.CHM(o),p.oxw(2).modifyRoles()}),p._uU(2,"Save"),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(1),p.Q6J("disabled",!i.myform.dirty&&i.isDisable)}}function x(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",36),p.NdJ("click",function(){p.CHM(o);var e=p.oxw(2);return e.verifyRole(e.modifyRoleObject.roleName)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(1),p.Q6J("hidden",i.enableEdit)("disabled",i.authBtn),p.xp6(1),p.Oqu(i.roleCodes.auth.labelDescription)}}function j(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",37),p.NdJ("click",function(){p.CHM(o);var e=p.oxw(2);return e.reopenRecord(e.modifyRoleObject.roleName)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(1),p.Q6J("hidden",!i.openHide||i.enableEdit),p.xp6(1),p.Oqu(i.roleCodes.reopen.labelDescription)}}function D(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",37),p.NdJ("click",function(){p.CHM(o);var e=p.oxw(2);return e.closeRecord(e.modifyRoleObject.roleName)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(1),p.Q6J("hidden",!i.closeHide||i.enableEdit),p.xp6(1),p.Oqu(i.roleCodes.close.labelDescription)}}function L(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",27),p.TgZ(1,"button",37),p.NdJ("click",function(){p.CHM(o);var e=p.oxw(2);return e.deleteRole(e.modifyRoleObject.roleName)}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.xp6(1),p.Q6J("hidden",i.enableEdit),p.xp6(1),p.Oqu(i.roleCodes.delete.labelDescription)}}function w(e,t){if(1&e&&(p.TgZ(0,"div",14),p.TgZ(1,"div",30),p.YNc(2,C,3,1,"div",33),p.YNc(3,k,3,1,"div",33),p.YNc(4,x,3,3,"div",33),p.YNc(5,j,3,2,"div",33),p.YNc(6,D,3,2,"div",33),p.YNc(7,L,3,2,"div",33),p.TgZ(8,"div",27),p.TgZ(9,"button",32),p._uU(10,"Exit"),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){var o=p.oxw();p.xp6(2),p.Q6J("ngIf",o.editFlag&&o.roleCodes.edit&&("Open"==o.modifyRoleObject.recordStatus||"OPEN"==o.modifyRoleObject.recordStatus)),p.xp6(1),p.Q6J("ngIf",!o.editFlag),p.xp6(1),p.Q6J("ngIf",("UNAUTHORIZED"==o.modifyRoleObject.authStatus||"Unauthorized"==o.modifyRoleObject.authStatus||"U"==o.modifyRoleObject.authStatus)&&o.roleCodes.auth),p.xp6(1),p.Q6J("ngIf",("CLOSED"==o.modifyRoleObject.recordStatus||"Close"==o.modifyRoleObject.recordStatus||"C"==o.modifyRoleObject.recordStatus)&&("YES"==o.modifyRoleObject.firstTimeAuth||"Y"==o.modifyRoleObject.firstTimeAuth)&&o.roleCodes.reopen),p.xp6(1),p.Q6J("ngIf",("OPEN"==o.modifyRoleObject.recordStatus||"Open"==o.modifyRoleObject.recordStatus||"O"==o.modifyRoleObject.recordStatus)&&("YES"==o.modifyRoleObject.firstTimeAuth||"Y"==o.modifyRoleObject.firstTimeAuth)&&o.roleCodes.close),p.xp6(1),p.Q6J("ngIf",("NO"==o.modifyRoleObject.firstTimeAuth||"N"==o.modifyRoleObject.firstTimeAuth)&&o.roleCodes.delete),p.xp6(2),p.Q6J("routerLink",p.DdM(7,q))}}function U(e,t){if(1&e&&(p.TgZ(0,"div",5),p.TgZ(1,"div",38),p.TgZ(2,"div",39),p.TgZ(3,"div",40),p.TgZ(4,"div",41),p.TgZ(5,"div",27),p.TgZ(6,"div",42),p._UZ(7,"i",43),p.qZA(),p.qZA(),p.TgZ(8,"div",44),p.TgZ(9,"div",45),p.TgZ(10,"h2"),p._uU(11,"Maker"),p.qZA(),p.TgZ(12,"p"),p._uU(13),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"div",39),p.TgZ(15,"div",40),p.TgZ(16,"div",41),p.TgZ(17,"div",27),p.TgZ(18,"div",46),p._UZ(19,"img",47),p.qZA(),p.qZA(),p.TgZ(20,"div",44),p.TgZ(21,"div",45),p.TgZ(22,"h2"),p._uU(23,"Maker Time Stamp"),p.qZA(),p.TgZ(24,"p"),p._uU(25),p.ALo(26,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"div",39),p.TgZ(28,"div",40),p.TgZ(29,"div",41),p.TgZ(30,"div",27),p.TgZ(31,"div",48),p._UZ(32,"i",49),p.qZA(),p.qZA(),p.TgZ(33,"div",44),p.TgZ(34,"div",45),p.TgZ(35,"h2"),p._uU(36,"Record Status"),p.qZA(),p.TgZ(37,"p"),p._uU(38),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(39,"div",39),p.TgZ(40,"div",40),p.TgZ(41,"div",41),p.TgZ(42,"div",27),p.TgZ(43,"div",50),p._UZ(44,"i",51),p.qZA(),p.qZA(),p.TgZ(45,"div",44),p.TgZ(46,"div",45),p.TgZ(47,"h2"),p._uU(48,"Checker"),p.qZA(),p.TgZ(49,"p"),p._uU(50),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(51,"div",39),p.TgZ(52,"div",40),p.TgZ(53,"div",41),p.TgZ(54,"div",27),p.TgZ(55,"div",52),p._UZ(56,"img",53),p.qZA(),p.qZA(),p.TgZ(57,"div",44),p.TgZ(58,"div",45),p.TgZ(59,"h2"),p._uU(60,"Checker Time Stamp"),p.qZA(),p.TgZ(61,"p"),p._uU(62),p.ALo(63,"date"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(64,"div",39),p.TgZ(65,"div",40),p.TgZ(66,"div",41),p.TgZ(67,"div",27),p.TgZ(68,"div",54),p._UZ(69,"i",55),p.qZA(),p.qZA(),p.TgZ(70,"div",44),p.TgZ(71,"div",45),p.TgZ(72,"h2"),p._uU(73,"First Time Authorization"),p.qZA(),p.TgZ(74,"p"),p._uU(75),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(76,"div",39),p.TgZ(77,"div",40),p.TgZ(78,"div",41),p.TgZ(79,"div",27),p.TgZ(80,"div",56),p._UZ(81,"img",57),p.qZA(),p.qZA(),p.TgZ(82,"div",44),p.TgZ(83,"div",45),p.TgZ(84,"h2"),p._uU(85,"Authorization Status"),p.qZA(),p.TgZ(86,"p"),p._uU(87),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(88,"div",39),p.TgZ(89,"div",40),p.TgZ(90,"div",41),p.TgZ(91,"div",27),p.TgZ(92,"div",56),p._UZ(93,"img",58),p.qZA(),p.qZA(),p.TgZ(94,"div",44),p.TgZ(95,"div",45),p.TgZ(96,"h2"),p._uU(97,"Modification Number"),p.qZA(),p.TgZ(98,"p"),p._uU(99),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){var o=p.oxw();p.xp6(13),p.Oqu(o.modifyRoleObject.makerId),p.xp6(12),p.Oqu(p.xi3(26,8,o.modifyRoleObject.makerDtStamp,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(o.modifyRoleObject.recordStatus),p.xp6(12),p.Oqu(o.modifyRoleObject.checkerId),p.xp6(12),p.Oqu(p.xi3(63,11,o.modifyRoleObject.checkerDtStamp,"MM/dd/yyyy, h:mm a")),p.xp6(13),p.Oqu(o.modifyRoleObject.firstTimeAuth),p.xp6(12),p.Oqu(o.modifyRoleObject.authStatus),p.xp6(12),p.Oqu(o.modifyRoleObject.version)}}var B,F=((B=function(){function e(t,o,i,s,l,n,a,c,d){r(this,e),this.roleService=t,this.api=o,this.route=i,this.formBuilder=s,this.router=l,this.cdr=n,this.iziToast=a,this.modalService=c,this.canDeactivateGuard=d,this.roleCodes=new h.yv,this.modifyRoleObject=new f,this.previouschecklist=[],this.checkedlist=[],this.screenName=[],this.modifyScreen=!1,this.editFlag=!1,this.enableEdit=!1,this.newRolesData=new m,this.checkAll=!1,this.openBtn=!0,this.closeBtn=!0,this.authBtn=!1,this.openHide=!0,this.closeHide=!0,this.isDisable=!0,this.formTouched=!0,this.closeResult="",this.selectAllChecked=!1,this.showDialog=!1,this.subject=new u.xQ}return i(e,[{key:"ngOnInit",value:function(){var e=this;this.roleNavObj=localStorage.getItem("roleNavObj"),this.roleNavigationObject=JSON.parse(this.roleNavObj),this.roleService.getIndexValue().subscribe(function(t){console.log(t),e.paramScreen=t,""===t.index&&e.createRole()}),this.username=localStorage.getItem("userFromLogin").replace(/['"]+/g,""),this.navSubscription=this.roleService.getNavParam.subscribe(function(t){return e.editRoleScreen=t}),console.log(this.editRoleScreen),this.editFlag=!1,this.modifyRoleObject.id=this.editRoleScreen.queryParams.id,this.modifyRoleObject.roleName=this.editRoleScreen.queryParams.roleName,this.modifyRoleObject.roleDesc=this.editRoleScreen.queryParams.roleDesc,this.modifyRoleObject.makerId=this.editRoleScreen.queryParams.makerId,this.modifyRoleObject.makerDtStamp=this.editRoleScreen.queryParams.makerDtStamp,this.modifyRoleObject.checkerId=this.editRoleScreen.queryParams.checkerId,this.modifyRoleObject.checkerDtStamp=this.editRoleScreen.queryParams.checkerDtStamp,this.modifyRoleObject.recordStatus=this.editRoleScreen.queryParams.recordStatus,this.modifyRoleObject.version=this.editRoleScreen.queryParams.version,console.log(this.modifyRoleObject),this.modifyRoleObject.recordStatus="Open"==this.modifyRoleObject.recordStatus?"OPEN":"C"==this.modifyRoleObject.recordStatus?"CLOSED":this.editRoleScreen.queryParams.recordStatus,this.modifyRoleObject.authStatus=this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.authStatus="A"==this.modifyRoleObject.authStatus?"AUTHORIZED":"U"==this.modifyRoleObject.authStatus?"UNAUTHORIZED":this.editRoleScreen.queryParams.authStatus,this.modifyRoleObject.firstTimeAuth=this.editRoleScreen.queryParams.firstTimeAuth,this.modifyRoleObject.firstTimeAuth="Y"==this.modifyRoleObject.firstTimeAuth?"YES":"N"==this.modifyRoleObject.firstTimeAuth?"NO":this.editRoleScreen.queryParams.firstTimeAuth,console.log(this.roleNavigationObject),null!=JSON.parse(this.roleNavObj)&&(console.log("Inside If"),this.buildRoleForm(this.roleNavigationObject),this.modifyRoleObject=this.roleNavigationObject),(null==this.modifyRoleObject.roleName&&"new"==this.paramScreen.index||null==this.roleNavigationObject)&&(console.log("Undesfined"),this.buildRoleForm(this.modifyRoleObject)),this.fetchdynamicroles(),this.roleService.fetchScreenPermissions("Roles"),this.roleService.screenLabelList.subscribe(function(t){return e.roleCodes=t}),(this.modifyRoleObject.roleName||this.roleNavigationObject.roleName)&&(this.modifyScreen=!0,this.editFlag=!0),this.auditLog()}},{key:"buildRoleForm",value:function(e){console.log(e),this.myform=this.formBuilder.group({roleName:[e.roleName?e.roleName:"",[c.kI.required,P.cannotContainSpace]],roleDesc:[e.roleDesc?e.roleDesc:"",c.kI.required]})}},{key:"preparingPermissiondto",value:function(e,t){for(var o=[],i=0;i<e.length;i++){for(var r={roleName:"",screenId:e[i].screensId.screenId},s=[],l=0;l<t;l++)s.push(0);var n=s.join("");o.push({permissionId:r,permissions:n})}return o}},{key:"editValues",value:function(){this.enableEdit=!0,this.editFlag=!1,this.openBtn=!1,this.closeBtn=!1,this.submitBtn=!0}},{key:"getPermission",value:function(e,t){this.btnNameSelected=t,null!=e||null!=e?(this.rolestype(e),console.log("inside If")):(this.rolestype(1),console.log("Else")),this.roleService.fetchScreenPermissions("Roles")}},{key:"verifyRole",value:function(e){var t=this;console.log(e,this.username),this.modifyRoleObject.makerId!==this.username?b().fire({text:"You are trying to Authorize record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.verifyRole(e,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,t.modifyRoleObject&&(t.auditLog(),b().fire({text:"Role is Authorized",icon:"success"}))})}):b().fire({text:"Maker Cannot Authorize Record!",icon:"error"})}},{key:"closeRecord",value:function(e){var t=this;b().fire({text:"You are trying to Closed record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.closelockRecord(e,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,console.log("role is closed",t.updatedRoleObject.recordStatus),t.openBtn=!1,t.closeBtn=!1,t.updatedRoleObject&&(t.auditLog(),b().fire({text:"Role is Closed",icon:"success"}))})}),!1===this.updatedRoleObject&&b().fire({icon:"error",text:"Failed to Closed Record "})}},{key:"reopenRecord",value:function(e){var t=this;b().fire({text:"You are trying to Reopen record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.reopenRecord(e,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,console.log("user is reopened"),t.openBtn=!1,t.closeBtn=!1,t.updatedRoleObject&&(t.auditLog(),b().fire({text:"Role is Reopened",icon:"success"}))})}),!1===this.deleteStatusFlag&&b().fire({icon:"error",text:"Failed to Reopened Record "})}},{key:"deleteRole",value:function(e){var t=this;b().fire({text:"You are trying to Delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.deleteRole(e,t.username).subscribe(function(e){t.deleteStatusFlag=e,t.deleteStatusFlag&&(b().fire({text:"Role is Deleted",icon:"success"}),t.router.navigate(["/roles/list"]))})}),!1===this.deleteStatusFlag&&b().fire({icon:"error",text:"Failed to Delete Record "})}},{key:"button",value:function(){this.isDisable=!1}},{key:"modifyRoles",value:function(){for(var e=this,t=[],o=function(o){for(var i=e.rolessorteddata[o].screenlist,r=function(o){if(i[o].permission.toString()!=i[o].newpermission.toString()){var r=e.newRolesData.permissionDto.findIndex(function(e){return e.permissionId.screenId==i[o].screenid});if(r>=0){var s={permissionId:e.newRolesData.permissionDto[r].permissionId};s.permissions=i[o].newpermission,t.push(s)}}},s=0;s<i.length;s++)r(s)},i=0;i<this.rolessorteddata.length;i++)o(i);var r={roleDto:this.newRolesData.roleDto};r.permissionDto=t,console.log(r),r.roleDto.roleDesc=this.myform.get("roleDesc").value,r.roleDto.makerId=this.username,this.roleService.newmodifyRoleService(r).subscribe(function(t){e.validationResponse=t,e.cdr.markForCheck();var o=localStorage.getItem("userFromLogin");e.roleService.fetchNewRolePermissions(o),console.log(e.validationResponse),e.modifyRoleObject=e.validationResponse,console.log(e.modifyRoleObject),e.validationResponse?(b().fire("Role is Updated "),e.formTouched=!e.myform.touched,e.submitBtn=!0,e.editFlag=!0,e.enableEdit=!1,console.log("IF IF IF IF IF"),e.auditLog(),console.log(e.modifyRoleObject),console.log(e.roleCodes)):(b().fire({icon:"error",text:"Server Error "}),console.log("ELSE ELSE ELSE ELSE"))})}},{key:"fetchdynamicroles",value:function(){var e=this;console.log(this.roleNavigationObject),null!=this.roleNavigationObject&&(this.modifyRoleObject.roleName=this.roleNavigationObject.roleName),null!=this.modifyRoleObject.roleName?this.roleService.fetchdynamicrolesdata(this.modifyRoleObject.roleName).subscribe(function(t){console.log("fetch",t),e.newRolesData.roleDto=t.roleDto,e.newRolesData.permissionDto=t.permissionDto,e.newRolesData.tabDto=t.tabDto,e.newRolesData.labelDto=t.labelDto,e.newRolesData.screenDto=t.screenDto;var o=[],i=t.screenDto,r=t.labelDto,s=t.permissionDto;if(console.log(e.newRolesData,"New roles Data"),s&&s.length<t.screenDto.length){var l="";if(t.labelDto){for(var n=[],a=0;a<t.labelDto.length;a++)n.push(0);l=n.join("")}for(var c=function(o){var i=t.screenDto[o];-1==s.findIndex(function(e){return e.permissionId.screenId==i.screensId.screenId})&&s.push({permissionId:{roleName:e.modifyRoleObject.roleName,screenId:i.screensId.screenId},permissions:l})},d=0;d<t.screenDto.length;d++)c(d)}e.screenName=e.newRolesData.tabDto;for(var u=[],h=0;h<e.screenName.length;h++)u[e.screenName[h].tabId-1]=e.screenName[h];e.screenName=[];for(var m=0;m<u.length;m++)null!=u[m]&&(e.screenName[e.screenName.length]=u[m]);console.log(e.btnNameSelected),(null==e.btnNameSelected||null==e.btnNameSelected)&&(e.btnNameSelected=e.screenName[0].tabName);for(var f=0;f<t.tabDto.length;f++){var g=[],b=[],p=t.tabDto[f];b=e.getscreenlist(i,p,s,g,b);for(var v=p.visibility.toString(),Z=[],y=[],T=0;T<v.length;T++)1==v.charAt(T)&&(Z.push(r[T].labelName),y.push(r[T]));o.push({tabId:p.tabId,tabname:p.tabName,screens:g,screenlist:b,labels:Z,labelslist:y})}e.rolessorteddata=o,e.rolestype(1),console.log("arrayc",o)}):this.roleService.fetchnewscreenlabels().subscribe(function(t){var o=e.preparingPermissiondto(t.screenDto,t.labelDto.length);e.newRolesData.roleDto=t.roleDto,e.newRolesData.permissionDto=o,e.newRolesData.tabDto=t.tabDto,e.newRolesData.labelDto=t.labelDto,e.newRolesData.screenDto=t.screenDto;var i=[],r=t.screenDto,s=t.labelDto;e.screenName=e.newRolesData.tabDto;for(var l=[],n=0;n<e.screenName.length;n++)l[e.screenName[n].tabId-1]=e.screenName[n];e.screenName=[];for(var a=0;a<l.length;a++)null!=l[a]&&(e.screenName[e.screenName.length]=l[a]);(null==e.btnNameSelected||null==e.btnNameSelected)&&(e.btnNameSelected=e.screenName[0].tabName);for(var c=0;c<t.tabDto.length;c++){var d=[],u=[],h=t.tabDto[c];u=e.getscreenlist(r,h,o,d,u);for(var m=h.visibility.toString(),f=[],g=[],b=0;b<m.length;b++)1==m.charAt(b)&&(f.push(s[b].labelName),g.push(s[b]));i.push({tabId:h.tabId,tabname:h.tabName,screens:d,screenlist:u,labels:f,labelslist:g})}e.rolessorteddata=i,e.rolestype(1)})}},{key:"getscreenlist",value:function(e,t,o,i,r){for(var s=function(s){var l=e[s];if(t.tabId==l.screensId.tabId){var n=o.findIndex(function(e){return e.permissionId.screenId==l.screensId.screenId});i.push(l.screenName),n>-1&&r.push({screenname:l.screenName,screenid:l.screensId.screenId,permission:o[n].permissions,newpermission:o[n].permissions})}},l=0;l<e.length;l++)s(l);return r}},{key:"rolestype",value:function(e){var t;console.log(e),t=this.rolessorteddata.findIndex(function(t){return t.tabId==e}),this.selectedtab=this.rolessorteddata[t].tabname,this.indexdata=this.rolessorteddata[t];var o=this.indexdata.labels,i=o.indexOf("Screens");this.previouschecklist.splice(t,0,this.checkedlist);var r=[];-1==i&&(o.splice(0,0,"Screens"),o.splice(1,0,"checkbox"));for(var s=[],l=[],n=[],a=this.indexdata.screenlist,c=0;c<a.length;c++){var d={},u={},h=[{value:""},{value:""}],m=[{value:""},{value:""}];[].push(a[c].screenname),d[this.indexdata.labels[0]]=a[c].screenname,d[this.indexdata.labels[1]]="checkbox",u[this.indexdata.labels[0]]=!0,u[this.indexdata.labels[1]]=!0;var f=a[c].newpermission.toString(),g=f.length;g==(f.match(/1/g)||[]).length&&r.push(c);for(var b=0;b<g;b++)d[this.indexdata.labels[2+b]]=f.charAt(b),1==f.charAt(b)?(u[this.indexdata.labels[2+b]]=!0,h.push({value:!0}),m.push({value:!0})):(u[this.indexdata.labels[2+b]]=!1,h.push({value:!1}),m.push({value:!1}));s.push(d),l.push(h),n.push(m)}this.roleScreenList=s,console.log(this.roleScreenList);for(var p=0;p<this.roleScreenList.length;p++)console.log(this.roleScreenList[p],"AUTH INside for"),"0"==this.roleScreenList[p].NEW||"0"==this.roleScreenList[p].EDIT||"0"==this.roleScreenList[p].DELETE||"0"==this.roleScreenList[p].CLOSE||"0"==this.roleScreenList[p].REOPEN||"0"==this.roleScreenList[p].AUTH||"0"==this.roleScreenList[p].UNLOCK||"0"==this.roleScreenList[p].PRINT||"0"==this.roleScreenList[p].VIEW?(console.log("Tabs are Selected"),this.selectAllChecked=!1):this.selectAllChecked=!0}},{key:"onSubmit",value:function(){this.submitted=!0,this.save()}},{key:"save",value:function(){var e=this;console.log(this.username),this.modifyRoleObject.makerId=this.username;for(var t=[],o=function(o){for(var i=e.rolessorteddata[o].screenlist,r=function(o){var r=e.newRolesData.permissionDto.findIndex(function(e){return e.permissionId.screenId==i[o].screenid});if(console.log(r),r>=0){console.log(e.modifyRoleObject),console.log(e.myform.get("roleName").value),e.newRolesData.permissionDto[r].permissionId.roleName=e.myform.get("roleName").value;var s={permissionId:e.newRolesData.permissionDto[r].permissionId};s.permissions=i[o].newpermission,t.push(s),console.log(t)}},s=0;s<i.length;s++)r(s)},i=0;i<this.rolessorteddata.length;i++)o(i);console.log(this.modifyRoleObject),this.modifyRoleObject.roleName=this.myform.get("roleName").value,this.modifyRoleObject.roleDesc=this.myform.get("roleDesc").value,console.log(this.modifyRoleObject);var r={roleDto:this.modifyRoleObject};r.permissionDto=t,console.log(r),this.roleService.createnewrole(r).subscribe(function(t){console.log(t),t?(e.modifyRoleObject=t,t&&(t.roleDto&&(e.modifyRoleObject=t.roleDto,e.modifyRoleObject.recordStatus="Open"==e.modifyRoleObject.recordStatus?"OPEN":"C"==e.modifyRoleObject.recordStatus?"CLOSE":e.editRoleScreen.queryParams.recordStatus,e.modifyRoleObject.authStatus=e.editRoleScreen.queryParams.authStatus,e.modifyRoleObject.authStatus="A"==e.modifyRoleObject.authStatus?"AUTHORIZED":e.editRoleScreen.queryParams.authStatus,e.modifyRoleObject.authStatus="UNAUTHORIZED",e.modifyRoleObject.firstTimeAuth=e.editRoleScreen.queryParams.firstTimeAuth,"Y"==e.modifyRoleObject.firstTimeAuth?e.modifyRoleObject.firstTimeAuth="YES":"N"==e.modifyRoleObject.firstTimeAuth&&(e.modifyRoleObject.firstTimeAuth="NO"),e.modifyRoleObject.firstTimeAuth="NO"),e.editFlag=!0,e.submitBtn=!0,e.modifyScreen=!0,e.auditLog(),b().fire("Role is Created"),e.fetchdynamicroles(),e.formTouched=!e.myform.touched)):t?b().fire({icon:"error",text:'"Failed ", \'Role already exist or Can\u2019t save role without any permission.'}):b().fire({icon:"error",text:"Role Name already exists."})},function(e){})}},{key:"isEnabled",value:function(){for(var e=!0,t=0;t<this.roleScreenList.length;t++)("0"==this.roleScreenList[t].NEW||"0"==this.roleScreenList[t].EDIT||"0"==this.roleScreenList[t].DELETE||"0"==this.roleScreenList[t].CLOSE||"0"==this.roleScreenList[t].REOPEN||"0"==this.roleScreenList[t].AUTH||"0"==this.roleScreenList[t].UNLOCK||"0"==this.roleScreenList[t].PRINT||"0"==this.roleScreenList[t].VIEW)&&(e=!1);return e}},{key:"clickAllAction",value:function(e,t){console.log(e,t),console.log(this.roleScreenList,"Role screen list");for(var o=0;o<this.roleScreenList.length;o++)console.log(this.roleScreenList[o],"AUTH INside for"),this.roleScreenList[o].NEW=t?"1":"0",this.roleScreenList[o].EDIT=t?"1":"0",this.roleScreenList[o].DELETE=t?"1":"0",this.roleScreenList[o].CLOSE=t?"1":"0",this.roleScreenList[o].REOPEN=t?"1":"0",this.roleScreenList[o].AUTH=t?"1":"0",this.roleScreenList[o].UNLOCK=t?"1":"0",this.roleScreenList[o].PRINT=t?"1":"0",this.roleScreenList[o].VIEW=t?"1":"0",console.log(e,t),1==t&&(this.selectAllChecked=!0),0==t&&(this.selectAllChecked=!1);for(var i=0;i<this.roleScreenList.length;i++)for(var r=0;r<this.rolessorteddata.length;r++)if(this.rolessorteddata[r].tabname==this.btnNameSelected){for(var s=0;s<this.rolessorteddata[r].screenlist.length;s++)if(this.rolessorteddata[r].screenlist[s].screenname==this.roleScreenList[i].Screens){for(var l=this.rolessorteddata[r].screenlist[s].newpermission,n=l.split(""),a=0;a<this.rolessorteddata[r].labelslist.length;a++)"NEW"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].NEW),"EDIT"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].EDIT),"DELETE"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].DELETE),"CLOSE"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].CLOSE),"REOPEN"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].REOPEN),"UNLOCK"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].UNLOCK),"PRINT"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].PRINT),"AUTH"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].AUTH),"VIEW"==this.rolessorteddata[r].labelslist[a].labelName&&(n[this.rolessorteddata[r].labelslist[a].labelId-1]=this.roleScreenList[i].VIEW),l=n.join("");this.rolessorteddata[r].screenlist[s].newpermission=l}console.log(this.rolessorteddata)}console.log(this.roleScreenList)}},{key:"clickRoleAction1",value:function(){this.button()}},{key:"clickRoleAction",value:function(e,t,o){this.isDisable=!1,console.log(this.roleScreenList),console.log(e,"Roles"),console.log(t,"action"),console.log(o,"event"),this.button(),console.log(e.Screens),console.log(e.NEW),e.AUTH&&console.log(this.selectAllChecked),console.log(this.modifyRoleObject),console.log(this.modifyRoleObject.roleName),this.modifyRoleObject.roleName?(("NEW"==t||"SELECTALL"==t)&&(e.NEW=o?"1":"0",e.VIEW="1",console.log(e.NEW,"Inside New If")),("EDIT"==t||"SELECTALL"==t)&&(e.EDIT=o?"1":"0",e.VIEW="1"),("DELETE"==t||"SELECTALL"==t)&&(e.DELETE=o?"1":"0",e.VIEW="1"),("CLOSE"==t||"SELECTALL"==t)&&(e.CLOSE=o?"1":"0",e.VIEW="1"),("REOPEN"==t||"SELECTALL"==t)&&(e.REOPEN=o?"1":"0",e.VIEW="1"),("UNLOCK"==t||"SELECTALL"==t)&&(e.UNLOCK=o?"1":"0",e.VIEW="1"),("PRINT"==t||"SELECTALL"==t)&&(e.PRINT=o?"1":"0",e.VIEW="1"),("AUTH"==t||"SELECTALL"==t)&&(e.AUTH=o?"1":"0",e.VIEW="1"),("VIEW"==t||"SELECTALL"==t)&&(e.VIEW=o?"1":"0")):(("NEW"==t||"SELECTALL"==t)&&(e.NEW=o?"1":"0",e.VIEW=o?"1":"0"),("EDIT"==t||"SELECTALL"==t)&&(e.EDIT=o?"1":"0",e.VIEW=o?"1":"0"),("DELETE"==t||"SELECTALL"==t)&&(e.DELETE=o?"1":"0",e.VIEW=o?"1":"0"),("CLOSE"==t||"SELECTALL"==t)&&(e.CLOSE=o?"1":"0",e.VIEW=o?"1":"0"),("REOPEN"==t||"SELECTALL"==t)&&(e.REOPEN=o?"1":"0",e.VIEW=o?"1":"0"),("UNLOCK"==t||"SELECTALL"==t)&&(e.UNLOCK=o?"1":"0",e.VIEW=o?"1":"0"),("PRINT"==t||"SELECTALL"==t)&&(e.PRINT=o?"1":"0",e.VIEW=o?"1":"0"),("AUTH"==t||"SELECTALL"==t)&&(e.AUTH=o?"1":"0",e.VIEW=o?"1":"0"),("VIEW"==t||"SELECTALL"==t)&&(e.VIEW=o?"1":"0"));for(var i=0;i<this.rolessorteddata.length;i++)if(this.rolessorteddata[i].tabname==this.btnNameSelected){for(var r=0;r<this.rolessorteddata[i].screenlist.length;r++)if(this.rolessorteddata[i].screenlist[r].screenname==e.Screens){for(var s=this.rolessorteddata[i].screenlist[r].newpermission,l=s.split(""),n=0;n<this.rolessorteddata[i].labelslist.length;n++)"NEW"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.NEW),"EDIT"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.EDIT),"DELETE"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.DELETE),"CLOSE"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.CLOSE),"REOPEN"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.REOPEN),"UNLOCK"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.UNLOCK),"PRINT"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.PRINT),"AUTH"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.AUTH),"VIEW"==this.rolessorteddata[i].labelslist[n].labelName&&(l[this.rolessorteddata[i].labelslist[n].labelId-1]=e.VIEW),s=l.join("");this.rolessorteddata[i].screenlist[r].newpermission=s}console.log(e,"Roles"),console.log(this.rolessorteddata)}}},{key:"reset",value:function(){this.validationResponse=null,this.modifyRoleObject=new f,this.roleScreenList=null,this.rolestype(1)}},{key:"auditLog",value:function(){("U"==this.modifyRoleObject.authStatus||"Unauthorized"==this.modifyRoleObject.authStatus||"UNAUTHORIZED"==this.modifyRoleObject.authStatus)&&(this.modifyRoleObject.authStatus="UNAUTHORIZED"),("A"==this.modifyRoleObject.authStatus||"Authorized"==this.modifyRoleObject.authStatus||"AUTHORIZED"==this.modifyRoleObject.authStatus)&&(this.modifyRoleObject.authStatus="AUTHORIZED"),("O"==this.modifyRoleObject.recordStatus||"Open"==this.modifyRoleObject.recordStatus)&&(this.modifyRoleObject.recordStatus="OPEN"),("C"==this.modifyRoleObject.recordStatus||"Close"==this.modifyRoleObject.recordStatus)&&(this.modifyRoleObject.recordStatus="CLOSED"),"N"==this.modifyRoleObject.firstTimeAuth&&(console.log("NO"),this.modifyRoleObject.firstTimeAuth="NO"),"Y"==this.modifyRoleObject.firstTimeAuth&&(this.modifyRoleObject.firstTimeAuth="YES")}},{key:"canExit",value:function(){var e=this,t=!1;return this.myform.touched&&1==this.formTouched?b().fire({text:"There are unsaved changes in the screen. Would you like to navigate to other screen?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){return!0===o.isConfirmed?(t=!0,e.cdr.markForCheck(),t):(t=!1,e.cdr.markForCheck(),t)}):(t=!0,new Promise(function(o,i){!0===t&&(t=!0,e.cdr.markForCheck(),o(!0))}))}},{key:"createRole",value:function(){this.roleService.sendNavParam({queryParams:{}})}},{key:"openDialog",value:function(e){var t=this;console.log(e,"DetailsDTO"),this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",windowClass:"my-class"}).result.then(function(e){t.closeResult="Closed with: ".concat(e)},function(e){t.closeResult="Dismissed ".concat(t.getDismissReason(e))})}},{key:"getDismissReason",value:function(e){return console.log(e),e===d.If.ESC?"by pressing ESC":e===d.If.BACKDROP_CLICK?"by clicking on a backdrop":"with: ".concat(e)}},{key:"accept",value:function(e){console.log(e),this.acceptval=e,"YES"==this.acceptval&&(localStorage.setItem("PageDeactivate",this.acceptval),this.pageDeactive=localStorage.getItem("PageDeactivate"),console.log(this.pageDeactive,"Page Deactivate"))}},{key:"reject",value:function(){this.modalService.dismissAll()}}]),e}()).\u0275fac=function(e){return new(e||B)(p.Y36(v.N),p.Y36(Z.sM),p.Y36(n.gz),p.Y36(c.qu),p.Y36(n.F0),p.Y36(p.sBO),p.Y36(y.I),p.Y36(d.FF),p.Y36(a.I))},B.\u0275cmp=p.Xpm({type:B,selectors:[["npr-role-details"]],inputs:{modifyRoleObject:"modifyRoleObject"},decls:57,vars:12,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],["action","","novalidate","",1,"formStyle",3,"formGroup"],["roleForm","ngForm"],[1,"dbCardStyle"],[1,"row","gy-4"],[1,"col-lg-4"],["for","roleName",1,"formLbl"],[1,"colorRed"],["id","roleName","type","text","formControlName","roleName","name","roleName","placeholder","Role Name","value","",1,"form-control",3,"readonly"],["class","errorColor",4,"ngIf"],["for","roleDescription",1,"formLbl"],["id","roleDescription","type","text","formControlName","roleDesc","required","","name","roleDesc","placeholder","Tupe your Text","value","",1,"form-control",3,"readonly"],[1,"col-lg-12"],[1,"row","g-2","justify-content-center"],["class","col-auto",4,"ngFor","ngForOf"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"disabled","checked","click"],[1,"table-responsive"],["id","dbTable1",1,"table","tableStyle"],[4,"ngFor","ngForOf"],["class","row g-3 pb-3 justify-content-end pt-3",4,"ngIf"],["class","col-lg-12",4,"ngIf"],["class","dbCardStyle",4,"ngIf"],[1,"errorColor"],[4,"ngIf"],[1,"col-auto"],[1,"btn","btnOutlinePrimary",3,"ngClass","disabled","click"],[1,"link-color"],[1,"row","g-3","pb-3","justify-content-end","pt-3"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"click"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],["class","col-auto",4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnUpdate",3,"click"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnAuth",3,"hidden","disabled","click"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"hidden","click"],[1,"row"],[1,"col-sm-6","col-md-4","col-lg-3"],[1,"csCardStyle"],[1,"row","g-2","align-items-center"],[1,"csCardStyleIcon","csCardStyleIconBg1"],[1,"fa","fa-edit","faClass"],[1,"col"],[1,"csCardStyleText"],[1,"csCardStyleIcon","csCardStyleIconBg2"],["src","assets/images/time-stamp-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg3"],["aria-hidden","true",1,"fa","fa-files-o","faRecordStatus"],[1,"csCardStyleIcon","csCardStyleIconBg4"],[1,"fa","fa-check-square-o","faClassChecker"],[1,"csCardStyleIcon","csCardStyleIconBg5"],["src","assets/images/checker-time-icon.svg","alt","..."],[1,"csCardStyleIcon","csCardStyleIconBg6"],[1,"fa","fa-shield","faClassFirstTimeAuth"],[1,"csCardStyleIcon","csCardStyleIconBg7"],["src","assets/images/authorize.svg","alt","...",1,"modImage"],["src","assets/images/modification.svg","alt","...",1,"modImage"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Role Management"),p.qZA(),p.qZA(),p.TgZ(4,"form",3,4),p.TgZ(6,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"div",7),p.TgZ(9,"label",8),p._uU(10,"Role Name "),p.TgZ(11,"span",9),p._uU(12,"*"),p.qZA(),p.qZA(),p._UZ(13,"input",10),p.YNc(14,S,3,2,"div",11),p.qZA(),p.TgZ(15,"div",7),p.TgZ(16,"label",12),p._uU(17,"Role Description "),p.TgZ(18,"span",9),p._uU(19,"*"),p.qZA(),p.qZA(),p._UZ(20,"input",13),p.YNc(21,O,2,1,"div",11),p.qZA(),p.TgZ(22,"div",14),p.TgZ(23,"div",15),p.YNc(24,N,3,3,"div",16),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(25,"div",5),p.TgZ(26,"div",17),p.TgZ(27,"label"),p._uU(28,"Select ALL"),p.qZA(),p.TgZ(29,"input",18),p.NdJ("click",function(){return t.clickRoleAction1()})("click",function(e){return t.clickAllAction("SELECTALLOPT",e.target.checked)}),p.qZA(),p.qZA(),p.TgZ(30,"div",19),p.TgZ(31,"table",20),p.TgZ(32,"thead"),p.TgZ(33,"tr"),p.TgZ(34,"th"),p._uU(35,"Screen"),p.qZA(),p.TgZ(36,"th"),p._uU(37,"Select All"),p.qZA(),p.TgZ(38,"th"),p._uU(39,"View"),p.qZA(),p.TgZ(40,"th"),p._uU(41,"NEW"),p.qZA(),p.TgZ(42,"th"),p._uU(43,"EDIT"),p.qZA(),p.TgZ(44,"th"),p._uU(45,"Auth"),p.qZA(),p.TgZ(46,"th"),p._uU(47,"Delete"),p.qZA(),p.TgZ(48,"th"),p._uU(49,"Close"),p.qZA(),p.TgZ(50,"th"),p._uU(51,"Reopen"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(52,"tbody"),p.YNc(53,E,28,17,"tr",21),p.qZA(),p.qZA(),p.qZA(),p.YNc(54,I,7,3,"div",22),p.YNc(55,w,11,8,"div",23),p.qZA(),p.qZA(),p.qZA(),p.YNc(56,U,100,14,"div",24)),2&e&&(p.xp6(4),p.Q6J("formGroup",t.myform),p.xp6(9),p.Q6J("readonly",t.editFlag),p.xp6(1),p.Q6J("ngIf",t.myform.get("roleName").invalid&&(t.myform.get("roleName").dirty||t.myform.get("roleName").touched)),p.xp6(6),p.Q6J("readonly",t.editFlag),p.xp6(1),p.Q6J("ngIf",t.myform.get("roleDesc").invalid&&(t.myform.get("roleDesc").dirty||t.myform.get("roleDesc").touched)),p.xp6(3),p.Q6J("ngForOf",t.screenName),p.xp6(5),p.Q6J("disabled",t.editFlag)("checked",t.isEnabled()),p.xp6(24),p.Q6J("ngForOf",t.roleScreenList),p.xp6(1),p.Q6J("ngIf",!t.modifyScreen),p.xp6(1),p.Q6J("ngIf",t.modifyScreen),p.xp6(1),p.Q6J("ngIf",null!=t.modifyRoleObject.roleName))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,l.O5,c.Q7,l.sg,l.mk,n.rH],pipes:[l.uU],styles:['.errorColor[_ngcontent-%COMP%]{color:#e6224a}.form-group.required[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]:after{content:"*";color:red}']}),B),P=function(){function e(){r(this,e)}return i(e,null,[{key:"cannotContainSpace",value:function(e){return e.value.indexOf(" ")>=0?{cannotContainSpace:!0}:null}}]),e}(),_=s(17988),J=function(){return["active"]};function Y(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",6),p.TgZ(1,"button",12),p.NdJ("click",function(){return p.CHM(o),p.oxw().createRole()}),p._uU(2),p.qZA(),p.qZA()}if(2&e){var i=p.oxw();p.xp6(1),p.Q6J("routerLinkActive",p.DdM(2,J)),p.xp6(1),p.hij(" ",i.roleCodes.new.labelDescription," ")}}function W(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"button",19),p.NdJ("click",function(){p.CHM(o);var e=p.oxw().$implicit;return p.oxw().deleteRole(e)}),p._UZ(1,"img",20),p.qZA()}}function H(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"button",21),p.NdJ("click",function(){p.CHM(o);var e=p.oxw().$implicit;return p.oxw().closeRecord(e)}),p._UZ(1,"img",22),p.qZA()}}function Q(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"button",23),p.NdJ("click",function(){p.CHM(o);var e=p.oxw().$implicit;return p.oxw().reopenRecord(e)}),p._UZ(1,"img",24),p.qZA()}}function M(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"tr"),p.TgZ(1,"td"),p.TgZ(2,"a",13),p.NdJ("click",function(){var e=p.CHM(o).$implicit;return p.oxw().getRole(e)}),p._uU(3),p.qZA(),p.qZA(),p.TgZ(4,"td"),p._uU(5),p.qZA(),p.TgZ(6,"td"),p._uU(7),p.qZA(),p.TgZ(8,"td"),p._uU(9),p.qZA(),p.TgZ(10,"td"),p._uU(11),p.ALo(12,"date"),p.qZA(),p.TgZ(13,"td"),p.TgZ(14,"button",14),p.NdJ("click",function(){var e=p.CHM(o).$implicit;return p.oxw().verifyRole(e)}),p._UZ(15,"img",15),p.qZA(),p.YNc(16,W,2,0,"button",16),p.YNc(17,H,2,0,"button",17),p.YNc(18,Q,2,0,"button",18),p.qZA(),p.qZA()}if(2&e){var i=t.$implicit,r=p.oxw();p.xp6(3),p.Oqu(i.roleName),p.xp6(2),p.Oqu(i.roleDesc),p.xp6(2),p.Oqu(i.authStatus),p.xp6(2),p.Oqu(i.recordStatus),p.xp6(2),p.Oqu(p.xi3(12,9,i.makerDtStamp,"medium")),p.xp6(3),p.Q6J("disabled",!("U"==i.authStatus||"Unauthorized"==i.authStatus)),p.xp6(2),p.Q6J("ngIf","NO"==i.firstTimeAuth||"N"==i.firstTimeAuth),p.xp6(1),p.Q6J("ngIf",("OPEN"==i.recordStatus||"Open"==i.recordStatus)&&("YES"==i.firstTimeAuth||"Y"==i.firstTimeAuth)&&r.roleCodes.close),p.xp6(1),p.Q6J("ngIf",("CLOSED"==i.recordStatus||"Close"==i.recordStatus)&&("YES"==i.firstTimeAuth||"Y"==i.firstTimeAuth)&&r.roleCodes.reopen)}}function V(e,t){1&e&&(p.ynx(0),p.TgZ(1,"div",25),p.TgZ(2,"span",26),p._uU(3,"Please wait... "),p._UZ(4,"span",27),p.qZA(),p.qZA(),p.BQk())}var z=function(){return["/dashboard"]},$=[{path:"list",component:function(){var t=function(){function t(e,o,i,s){r(this,t),this.cdr=e,this.api=o,this.router=i,this.roleService=s,this.isLoading=!1,this.roleCodes=new h.yv,this.dtOptions={},this.dtTrigger=new u.xQ,this.statusArr=["Authorized","Unauthorized","Open","Close"],this.modifyRoleObject=new f,this.openBtn=!0,this.closeBtn=!0}return i(t,[{key:"ngOnInit",value:function(){var e=this;this.getRoles(),this.dtOptions={pagingType:"full_numbers",pageLength:5,processing:!0,columnDefs:[{type:"date",targets:[4]}],order:[[4,"desc"]],lengthMenu:[[5,10,20,30,-1],[5,10,20,30,"ALL"]]},this.roleService.fetchScreenPermissions("Roles"),this.roleService.screenLabelList.subscribe(function(t){return e.roleCodes=t}),console.log(this.roleCodes),this.username=localStorage.getItem("userFromLogin").replace(/['"]+/g,"")}},{key:"ngOnDestroy",value:function(){this.dtTrigger.unsubscribe()}},{key:"getRoles",value:function(){var t=this;this.isLoading=!0,this.api.getAllRoles().subscribe(function(o){var i,r=e(o.result);try{var s=function(){var e=i.value;e.authStatus=t.statusArr.find(function(t){return t.startsWith(e.authStatus)}),e.recordStatus=t.statusArr.find(function(t){return t.startsWith(e.recordStatus)})};for(r.s();!(i=r.n()).done;)s()}catch(l){r.e(l)}finally{r.f()}t.allRoles=o.result,t.isLoading=!1,t.cdr.markForCheck(),console.log(t.allRoles),t.dtTrigger.next()})}},{key:"getRole",value:function(e){this.modifyRoleObject=e,console.log("inside modify"),console.log(this.modifyRoleObject),this.roleService.setIndexValue({index:"edit"});var t={queryParams:{id:this.modifyRoleObject.id,roleName:this.modifyRoleObject.roleName,roleDesc:this.modifyRoleObject.roleDesc,new1:this.modifyRoleObject.new1,copy1:this.modifyRoleObject.copy1,delete1:this.modifyRoleObject.delete1,close1:this.modifyRoleObject.close1,unlock1:this.modifyRoleObject.unlock1,reopen1:this.modifyRoleObject.reopen1,print1:this.modifyRoleObject.print1,auth1:this.modifyRoleObject.auth1,view1:this.modifyRoleObject.view1,makerId:this.modifyRoleObject.makerId,makerDtStamp:this.modifyRoleObject.makerDtStamp,checkerId:this.modifyRoleObject.checkerId,checkerDtStamp:this.modifyRoleObject.checkerDtStamp,recordStatus:this.modifyRoleObject.recordStatus,authStatus:this.modifyRoleObject.authStatus,firstTimeAuth:this.modifyRoleObject.firstTimeAuth,version:this.modifyRoleObject.version}};localStorage.setItem("roleNavObj",JSON.stringify(this.modifyRoleObject)),this.roleService.sendNavParam(t),this.router.navigate(["/roles/create"])}},{key:"createRole",value:function(){localStorage.removeItem("roleNavObj"),this.router.navigate(["/roles/create"]),this.roleService.sendNavParam({queryParams:{}}),this.roleService.setIndexValue({index:"new"})}},{key:"verifyRole",value:function(e){var t=this;console.log(e.makerId,this.username),e.makerId!==this.username?b().fire({text:"You are trying to Authorize record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.verifyRole(e.roleName,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,t.modifyRoleObject&&b().fire({text:"Role is Authorized",icon:"success"}).then(function(){return window.location.reload()})})}):b().fire({text:"Maker Cannot Authorize Record!",icon:"error"})}},{key:"deleteRole",value:function(e){var t=this;b().fire({text:"You are trying to Delete record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.deleteRole(e.roleName,t.username).subscribe(function(e){t.deleteStatusFlag=e,t.deleteStatusFlag&&b().fire({text:"Role is Deleted",icon:"success"}).then(function(){return window.location.reload()})})}),!1===this.deleteStatusFlag&&b().fire({icon:"error",text:"Failed to Delete Record "})}},{key:"reopenRecord",value:function(e){var t=this;b().fire({text:"You are trying to Reopen record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.reopenRecord(e.roleName,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,console.log("user is reopened"),t.openBtn=!1,t.closeBtn=!1,t.updatedRoleObject&&b().fire({text:"Role is Reopened",icon:"success"}).then(function(){return window.location.reload()})})}),!1===this.deleteStatusFlag&&b().fire({icon:"error",text:"Failed to Reopened Record "})}},{key:"closeRecord",value:function(e){var t=this;b().fire({text:"You are trying to Closed record.  Do you want to proceed?",showCancelButton:!0,confirmButtonColor:"#E6224A",cancelButtonColor:"#011945",cancelButtonText:"NO",confirmButtonText:"YES",icon:"info"}).then(function(o){!0===o.isConfirmed&&t.roleService.closelockRecord(e.roleName,t.username).subscribe(function(e){t.updatedRoleObject=e,t.cdr.markForCheck(),t.modifyRoleObject=t.updatedRoleObject,console.log("role is closed",t.updatedRoleObject.recordStatus),t.openBtn=!1,t.closeBtn=!1,t.updatedRoleObject&&b().fire({text:"Role is Closed",icon:"success"}).then(function(){return window.location.reload()})})}),!1===this.updatedRoleObject&&b().fire({icon:"error",text:"Failed to Closed Record "})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(p.sBO),p.Y36(Z.sM),p.Y36(n.F0),p.Y36(v.N))},t.\u0275cmp=p.Xpm({type:t,selectors:[["npr-role-list"]],decls:29,vars:7,consts:[[1,"pageContentMain"],[1,"pageTitleCol"],[1,"pageTitle"],[1,"dbCardStyle"],[1,"row","g-3","pb-3","justify-content-end"],["class","col-auto",4,"ngIf"],[1,"col-auto"],[1,"btn","smBtn","minWdSmBtn","btnSecondary",3,"routerLink"],[1,"table-responsive"],["datatable","",1,"dataTable","table","tableStyle","tableStyleSelect","nowrap","vAlignMdl",2,"width","100%",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","smBtn","minWdSmBtn","btnPrimary",3,"routerLinkActive","click"],[1,"link-color",2,"cursor","pointer",3,"click"],["title","Authorize",1,"btn",2,"color","red",3,"disabled","click"],["src","assets/images/authorize.svg","alt","Authorize"],["class","btn","style","color: red","title","Delete",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Close",3,"click",4,"ngIf"],["class","btn","style","color: red","title","Reopen",3,"click",4,"ngIf"],["title","Delete",1,"btn",2,"color","red",3,"click"],["src","assets/images/delete.svg","alt","..."],["title","Close",1,"btn",2,"color","red",3,"click"],["src","assets/images/CROSS1.svg","alt","..."],["title","Reopen",1,"btn",2,"color","red",3,"click"],["src","assets/images/open.svg","alt","..."],[1,"loading-page-center"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"h2",2),p._uU(3,"Role Management"),p.qZA(),p.qZA(),p.TgZ(4,"div",3),p.TgZ(5,"div",4),p.YNc(6,Y,3,3,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"button",7),p._uU(9," Exit "),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",8),p.TgZ(11,"table",9),p.TgZ(12,"thead"),p.TgZ(13,"tr"),p.TgZ(14,"th"),p._uU(15,"Role Name"),p.qZA(),p.TgZ(16,"th"),p._uU(17,"Role Description"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"Auth Status"),p.qZA(),p.TgZ(20,"th"),p._uU(21,"Record Status"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"Date"),p.qZA(),p.TgZ(24,"th"),p._uU(25,"Action"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(26,"tbody"),p.YNc(27,M,19,12,"tr",10),p.qZA(),p.qZA(),p.qZA(),p.YNc(28,V,5,0,"ng-container",11),p.qZA(),p.qZA()),2&e&&(p.xp6(6),p.Q6J("ngIf",t.roleCodes.new),p.xp6(2),p.Q6J("routerLink",p.DdM(6,z)),p.xp6(3),p.Q6J("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),p.xp6(16),p.Q6J("ngForOf",t.allRoles),p.xp6(1),p.Q6J("ngIf",t.isLoading))},directives:[l.O5,n.rH,_.G,l.sg,n.Od],pipes:[l.uU],styles:[""]}),t}()},{path:"create",component:F,canDeactivate:[a.I]},{path:"details/:id",component:F,canDeactivate:[a.I]}],K=function(){var e=i(function e(){r(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[n.Bz.forChild($)],n.Bz]}),e}(),G=s(15626),X=function(){var e=i(function e(){r(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[l.ez,c.UX,c.u5,G.K,K,_.T]]}),e}()}}])}();